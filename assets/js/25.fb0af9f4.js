(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{353:function(s,t,a){s.exports=a.p+"assets/img/cargo-run-guessgame.bd3bd17c.png"},378:function(s,t,a){"use strict";a.r(t);var n=a(17),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"编写猜一猜游戏"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#编写猜一猜游戏"}},[s._v("#")]),s._v(" 编写猜一猜游戏")]),s._v(" "),t("p",[s._v("让我们一起动手来编写一个 Rust 小程序吧！在这个小程序中，我们将学到"),t("code",[s._v("let")]),s._v("关键字,"),t("code",[s._v("match")]),s._v("关键字，方法，关联的函数，以及使用的依赖（crates），甚至更多知识点。这个小程序会自动生成 1~100 之间的正整数，然后由用户输入数字，程序将根据用户输入的数字来进行匹配，如果用户输入错误，则提示用户数字过大或者过小，直到用户猜对为止，然后就退出小程序。")]),s._v(" "),t("h2",{attrs:{id:"创建一个新项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建一个新项目"}},[s._v("#")]),s._v(" 创建一个新项目")]),s._v(" "),t("p",[s._v("接下来继续使用 cargo 工具在你的项目根目录创建一个新项目，命令如下:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo new guessing_game\n$ cd guessing_game\n")])])]),t("p",[s._v("第一行命令"),t("code",[s._v("cargo new")]),s._v("表示创建一个新的项目，项目名为"),t("code",[s._v("guessing_game")]),s._v(",第二行命令则是跳转到该目录下。")]),s._v(" "),t("p",[s._v("接下来，看一下"),t("code",[s._v("cargo.toml")]),s._v("文件:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nname "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"guessing_game"')]),s._v("\nversion "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.1.0"')]),s._v("\nauthors "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Your Name <you@example.com>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nedition "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018"')]),s._v("\n\n# "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("See")]),s._v(" more keys and their definitions at https"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("doc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rust"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lang"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("cargo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("reference"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("manifest"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dependencies"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("如果"),t("code",[s._v("cargo")]),s._v("默认生成的信息有些不符合你的要求，可根据需要来进行修改并保存。接下来让我们继续看着"),t("code",[s._v("main.rs")]),s._v("文件，"),t("code",[s._v("cargo")]),s._v("默认会创建一个函数，然后函数体里面就是打印"),t("code",[s._v("hello,world!")]),s._v("。代码如下:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello,world!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("让我们尝试用"),t("code",[s._v("cargo run")]),s._v("命令来进行调试，同样的步骤如前面所述，如下:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo run\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("50s\n     "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Running")]),s._v(" `target"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("debug"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("guessing_game`\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Hello")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("world!")]),s._v("\n")])])]),t("p",[s._v("接下来才是我们的重头戏，让我们重写"),t("code",[s._v("main.rs")]),s._v("文件里的代码。")]),s._v(" "),t("h2",{attrs:{id:"处理用户输入的数字"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#处理用户输入的数字"}},[s._v("#")]),s._v(" 处理用户输入的数字")]),s._v(" "),t("p",[s._v("首先我们需要要求用户输入信息，并且处理输入的信息，然后检查用户输入的信息是否是我们所期待的正确答案。最开始，我们需要让用户输入猜测的数字，代码如下:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"猜数字游戏现在开始!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"请输入正整数!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("new")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_line")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expected")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"程序出现问题!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"你猜测的数字是:{}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("这些代码包含了太多的知识点了，让我们一行一行的来分析吧！首先，为了提示用户输入并且能够打印出结果作为输出，我们需要使用"),t("code",[s._v("io")]),s._v("(input/output,输入输出)库,"),t("code",[s._v("io")]),s._v("库来自"),t("code",[s._v("Rust")]),s._v("的一个标准库，这个标准库就被叫做"),t("code",[s._v("std(standard library)")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("默认情况下，"),t("code",[s._v("Rust")]),s._v("会将一些类型添加进程序的作用域中，即"),t("a",{attrs:{href:"https://doc.rust-lang.org/std/prelude/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("the prelude"),t("OutboundLink")],1),s._v("（这个就是指 rust 默认会自动引入的一些依赖列表，也可被叫做默认依赖包）。如果需要使用的类型不在这个默认依赖包中，那么我们就需要使用"),t("code",[s._v("use")]),s._v("语句来显式的引入到作用域中。使用"),t("code",[s._v("std::io")]),s._v("库会有很多有用的功能，这其中也包括我们接下来要使用到的能够允许用户输入的能力。")]),s._v(" "),t("p",[s._v("正如前面所介绍到的，每个"),t("code",[s._v("Rust")]),s._v("程序的入口就是"),t("code",[s._v("main")]),s._v("函数。")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[t("code",[s._v("fn")]),s._v("语法表示声明一个函数，括号"),t("code",[s._v("()")]),s._v("内可以添加参数，但在这里是没有参数的，而"),t("code",[s._v("{}")]),s._v("则代表函数的主体，我们将要编写的所有功能代码都在这个函数主体中。")]),s._v(" "),t("p",[t("code",[s._v("println")]),s._v("则可以算作是一个集合，就是将用户输入的信息打印在终端上。")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"猜数字游戏现在开始!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"请输入正整数!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("这两行代码无非就是提示用户这个小程序是做什么的。")]),s._v(" "),t("h3",{attrs:{id:"用变量来存储值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用变量来存储值"}},[s._v("#")]),s._v(" 用变量来存储值")]),s._v(" "),t("p",[s._v("接下来，我们将创建一个变量用来存储用户输入的信息，代码如下:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("new")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("这个小程序变得十分有趣了！这一行代码做了很多事情，注意"),t("code",[s._v("let")]),s._v("语句是用来创建一个变量的，我们来看另一个示例代码如下:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" foo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" bar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("这一行代码创建了一个"),t("code",[s._v("foo")]),s._v("变量，并且将变量的值赋值为"),t("code",[s._v("bar")]),s._v("."),t("code",[s._v("Rust")]),s._v("语言的变量默认是不可变("),t("code",[s._v("immutable")]),s._v(")的,后续会讨论"),t("a",{attrs:{href:"https://doc.rust-lang.org/book/ch03-01-variables-and-mutability.html#variables-and-mutability",target:"_blank",rel:"noopener noreferrer"}},[s._v("变量的可变性"),t("OutboundLink")],1),s._v("。下面的例子展示了如果在变量之前使用"),t("code",[s._v("mut")]),s._v("关键字即可让变量可变("),t("code",[s._v("mutable")]),s._v(")。")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" foo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//不可变")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" bar "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//可变")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("注意：//语法就是注释语句，注释一直持续到行尾。Rust 忽略了注释中的所有内容，第 3 章将对此进行详细讨论。")])]),s._v(" "),t("p",[s._v("现在我们也就知道了"),t("code",[s._v("let mut guess")]),s._v("无非就是定义一个可变的变量，变量名就叫做"),t("code",[s._v("guess")]),s._v("。而"),t("code",[s._v("=")]),s._v("右边的值就是该变量所赋的值，也就是"),t("code",[s._v("String::new")]),s._v("。这是一个函数，会返回一个"),t("code",[s._v("String")]),s._v("实例。"),t("a",{attrs:{href:"https://doc.rust-lang.org/std/string/struct.String.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("String"),t("OutboundLink")],1),s._v("是标准库中的一种数据类型，被叫做字符串，也是"),t("code",[s._v("UTF-8")]),s._v("编码的文本类型。")]),s._v(" "),t("p",[t("code",[s._v("::new")]),s._v("中的"),t("code",[s._v("::")]),s._v("符号表示该类型关联一种函数，也就是"),t("code",[s._v("String")]),s._v("的关联函数。关联函数(在这里是"),t("code",[s._v("String")]),s._v("类型)是在类型上实现的，而不是在"),t("code",[s._v("String")]),s._v("的特定实例上实现的，在一些语言当中，也把它称作是静态方法。")]),s._v(" "),t("p",[t("code",[s._v("new")]),s._v("函数会创建一个新的空的字符串实例，你会发现在许多类型当中都会有"),t("code",[s._v("new")]),s._v("函数，因为它只是一个通用函数的名称而已，并且它会创建某种新的值。")]),s._v(" "),t("p",[s._v("总而言之，"),t("code",[s._v("let mut guess = String::new();")]),s._v("这一行代码就是创建一个可变的变量，并且这个变量的值是一个空的字符串实例。")]),s._v(" "),t("h3",{attrs:{id:"接收用户输入值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#接收用户输入值"}},[s._v("#")]),s._v(" 接收用户输入值")]),s._v(" "),t("p",[s._v("回想一下在程序的第一行代码中，我们通过使用"),t("code",[s._v("use std::io;")]),s._v("语句来从标准库中获取到的有关用户输入输出的关联函数，现在我们从"),t("code",[s._v("io")]),s._v("模块中调用"),t("code",[s._v("stdin")]),s._v("函数。如下:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_line")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("如果我们在程序的开头的代码中并没有写"),t("code",[s._v("use std::io;")]),s._v("，我们在这里调用这个函数的时候需要重写成"),t("code",[s._v("std::io::stdin")]),s._v("。"),t("code",[s._v("stdin")]),s._v("是一个返回类型为"),t("a",{attrs:{href:"https://doc.rust-lang.org/std/io/struct.Stdin.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("std::io::stdin"),t("OutboundLink")],1),s._v("的实例，也就是一种类型，代表着为你的终端处理标准的输出。")]),s._v(" "),t("p",[s._v("下一部分代码,"),t("code",[s._v(".read_line(&mut guess)")]),s._v(",调用"),t("a",{attrs:{href:"https://doc.rust-lang.org/std/io/struct.Stdin.html#method.read_line",target:"_blank",rel:"noopener noreferrer"}},[s._v("read_line"),t("OutboundLink")],1),s._v("方法在标准输入中获取并处理用户的输入。我们也为"),t("code",[s._v("read_line")]),s._v("方法传递了一个参数:"),t("code",[s._v("&mut guess")]),s._v("。")]),s._v(" "),t("p",[t("code",[s._v("read_line")]),s._v("的工作就是将用户输入的任何内容带入标准输入库中，并放置到字符串中，所以它将该字符串作为参数。字符串参数必须是可变，因此可以通过添加用户的输入来更改字符串的内容。")]),s._v(" "),t("p",[t("code",[s._v("&")]),s._v("标识符代表参数是引用，它为我们提供了一种方式，也就是我们的代码的很多地方都可以访问到一条数据，也因此不需要做复制数据到内存中的操作。引用是一种复杂的特性，使用引用也比较安全和便捷，这也是"),t("code",[s._v("Rust")]),s._v("的主要优势之一。我们并不需要为了完成这个程序而了解引用的太多细节，现在我们需要知道的就像变量，引用默认是不可变的\n因此我们需要写"),t("code",[s._v("&mut guess")]),s._v("而不是"),t("code",[s._v("&guess")]),s._v("来让变量可变。（第 4 章会解释引用的更多信息。）")]),s._v(" "),t("h3",{attrs:{id:"使用返回的结果来处理潜在的故障"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用返回的结果来处理潜在的故障"}},[s._v("#")]),s._v(" 使用返回的结果来处理潜在的故障")]),s._v(" "),t("p",[s._v("我们接着讨论一下第三行代码，也是属于这一部分的代码，它是一个方法:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"调用read_line失败!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("当我们使用类似"),t("code",[s._v(".foo()")]),s._v("的格式来调用方法时，最明智的做法就是引入换行符或者是其它空格来将很长的一行代码进行分隔，因此我们需要重写如上的代码如下:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("   "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_line")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"调用read_line失败!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("然而这样很长的一行是很难阅读的，所以最好要分割它。现在我们来讨论一下这一行都做了什么。")]),s._v(" "),t("p",[s._v("正如更早之前所提到的，"),t("code",[s._v("read_line")]),s._v("将用户键入的内容放入我们要传递的字符串中，但它还会返回一个值，在这种情况下为"),t("a",{attrs:{href:"https://doc.rust-lang.org/std/io/type.Result.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("io::Result"),t("OutboundLink")],1),s._v("。"),t("code",[s._v("Rust")]),s._v("在它的标准库(一种通用的"),t("a",{attrs:{href:"https://doc.rust-lang.org/std/result/enum.Result.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Result"),t("OutboundLink")],1),s._v("也作为一个特殊的版本的子模块，就像"),t("code",[s._v("io::Result")]),s._v(")中有一种数值类型叫做"),t("code",[s._v("Result")]),s._v("。")]),s._v(" "),t("p",[t("code",[s._v("Result")]),s._v("是可以进行"),t("a",{attrs:{href:"https://doc.rust-lang.org/book/ch06-00-enums.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("枚举"),t("OutboundLink")],1),s._v("操作的，通常也被作为枚举来提及。一个枚举值也是一个类型可以有许多被修复和设置的值，并且这些值通常也被叫做枚举的变体。第六章会详细介绍枚举。")]),s._v(" "),t("blockquote",[t("p",[s._v("变体，也可以把它理解为回调函数吧。")])]),s._v(" "),t("p",[s._v("对于"),t("code",[s._v("Result")]),s._v("，通常变体就是"),t("code",[s._v("Ok")]),s._v("或者"),t("code",[s._v("Err")]),s._v("。"),t("code",[s._v("OK")]),s._v("变体表示这种操作是成功的，并且在"),t("code",[s._v("OK")]),s._v("里面会生成一个成功值。"),t("code",[s._v("Err")]),s._v("变体意味着这种操作失败了，并且"),t("code",[s._v("Err")]),s._v("也会包含一些关于这种操作如何或者是为什么失败的信息。")]),s._v(" "),t("p",[t("code",[s._v("Result")]),s._v("类型旨在对错误处理信息进行编码。"),t("code",[s._v("Result")]),s._v("类型的值就像任意类型的值，会有方法来定义它们。"),t("code",[s._v("io::Result")]),s._v("有一个你可以调用的"),t("code",[s._v("expect")]),s._v("方法。如果"),t("code",[s._v("io::Result")]),s._v("这个实例的值是"),t("code",[s._v("Err")]),s._v(","),t("code",[s._v("expect")]),s._v("将会导致程序崩溃并且会显示你需要传递一个参数给"),t("code",[s._v("expect")]),s._v("的信息。如果"),t("code",[s._v("read_line")]),s._v("方法返回一个"),t("code",[s._v("Err")]),s._v("值，则可能是来自底层操作系统的一种错误结果。如果"),t("code",[s._v("io::Result")]),s._v("这个实例的值是"),t("code",[s._v("OK")]),s._v("，"),t("code",[s._v("expect")]),s._v("将会将"),t("code",[s._v("OK")]),s._v("保存的返回值返回给你，让你能够使用它。在这种情况下，这个值就是用户通过标准的输入框键入的数字字符。")]),s._v(" "),t("p",[s._v("如果你不调用"),t("code",[s._v("expect")]),s._v("方法，程序将会编译，并且你会得到一个警告:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo build\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\nwarning"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" unused `"),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),s._v("result"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Result")]),s._v("` that must be used\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("->")]),s._v(" src"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_line")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" note"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" `"),t("span",{pre:!0,attrs:{class:"token attribute attr-name"}},[s._v("#[warn(unused_must_use)]")]),s._v("` on by default\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" note"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" this `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Result")]),s._v("` may be an `"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Err")]),s._v("` variant"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" which should be handled\n\nwarning"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" warning emitted\n\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("59s\n")])])]),t("p",[s._v("rust 的警告说明你没有用"),t("code",[s._v("read_line")]),s._v("方法返回的"),t("code",[s._v("Result")]),s._v("值,也就是说程序并没有处理这个可能的错误。消除警告的办法就是编写实际的错误处理，但是由于你只是想在程序出现问题时崩溃，所以你可以使用"),t("code",[s._v("expect")]),s._v("方法。你将在第 9 章中学会如何处理错误。")]),s._v(" "),t("h3",{attrs:{id:"使用-println-占位符方法来在终端打印值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-println-占位符方法来在终端打印值"}},[s._v("#")]),s._v(" 使用 println! 占位符方法来在终端打印值")]),s._v(" "),t("p",[s._v("除了结束大括号之外，到目前为止在添加的代码中需要讨论的只有一行，那就是如下所示:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You guessed:{}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("这一行将会打印一个字符串，也就是我们保存了用户所输入的数字。一对大括号"),t("code",[s._v("{}")]),s._v(",是一种占位符，我们可以认为它就是一种固定值。你可以使用大括号打印多个值：第一组大括号包含在格式字符串之后列出的第一个值，第二组包含第二个值，依此类推。在一次调用 println! 中打印多个值！看起来像这样：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" y "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x = {} and y = {}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("y"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("代码将会打印"),t("code",[s._v("x = 5 and y = 10")]),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"测试第一部分"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试第一部分"}},[s._v("#")]),s._v(" 测试第一部分")]),s._v(" "),t("p",[s._v("让我们测试一下猜数字游戏的第一部分代码。通过使用"),t("code",[s._v("cargo run")]),s._v("来运行:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo run\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("44s\n     "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Running")]),s._v(" `target"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("debug"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("guessing_game`\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Guess")]),s._v(" the "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("number!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n")])])]),t("p",[s._v("如下图所示:")]),s._v(" "),t("p",[t("img",{attrs:{src:a(353),alt:""}})]),s._v(" "),t("p",[s._v("在此刻，游戏的第一部分已经生效:我们已经得到了从键盘输入的结果并且打印出了它。")]),s._v(" "),t("h2",{attrs:{id:"生成一个隐秘的数字"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成一个隐秘的数字"}},[s._v("#")]),s._v(" 生成一个隐秘的数字")]),s._v(" "),t("p",[s._v("下一步，我们将需要生成一个秘密的数字让用户去尝试猜一下。秘密的数字应该每次都是不同的，这样也就可以让用户可以玩很多次这个游戏。让我们使用 1 到 100 之间的随机数，这样游戏也没有那么难。rust 的标准库中也没有包含随机数函数。然而，rust 团队提供了一个"),t("a",{attrs:{href:"https://crates.io/crates/rand",target:"_blank",rel:"noopener noreferrer"}},[s._v("rand"),t("OutboundLink")],1),s._v("依赖项。")]),s._v(" "),t("h3",{attrs:{id:"使用一个依赖包是为了获取更多的功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用一个依赖包是为了获取更多的功能"}},[s._v("#")]),s._v(" 使用一个依赖包是为了获取更多的功能")]),s._v(" "),t("p",[s._v("记住一个依赖包是一个 rust 源代码文件的集合。这个项目我们已经构建了一个二进制程序包，也是一个可执行文件。这个依赖包就是一个常规的包，包含在其他程序中使用的代码视图。")]),s._v(" "),t("p",[s._v("cargo 使用外部依赖包在这里就是真正的亮点。在编写使用依赖包的代码之前，我们需要修改 Cargo.toml 文件以包含依赖包作为依赖项。现在打开该文件，并将以下行代码添加到底部，位于 Cargo 为你创建的 "),t("a",{attrs:{href:"%E4%BE%9D%E8%B5%96%E9%A1%B9"}},[s._v("dependencies")]),s._v("部分标题下方。请务必使用此版本号完全按照我们此处的方式指定依赖包，否则本教程中的代码示例可能无法正常工作：")]),s._v(" "),t("p",[s._v("文件名: Cargo.toml")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dependencies"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nrand "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.8.5"')]),s._v("\n")])])]),t("p",[s._v("在 Cargo.toml 文件中，[dependencies]后面的所有内容都是该部分的一部分，一直持续到另一个部分开始。在 [dependencies] 中，相当于是你告诉 Cargo 你的项目依赖哪些外部依赖包，以及你需要这些依赖包的哪些版本。在本例中，我们使用语义版本说明符 0.8.5 指定依赖包的版本。Cargo 知道控制"),t("a",{attrs:{href:"http://semver.org/",target:"_blank",rel:"noopener noreferrer"}},[s._v("语义版本"),t("OutboundLink")],1),s._v("（有时称为 SemVer），这是编写版本号的标准。说明符 0.8.5 实际上是 ^0.8.5 的简写，这意思就是任何版本至少是 0.8.5 以上，并且低于 0.9.0。")]),s._v(" "),t("p",[s._v("Cargo 认为这些版本具有与 0.8.5 版本兼容的公共 API，并且此规范确保你将获得仍将使用本章中的代码进行编译的最新补丁版本。不保证任何 0.9.0 或更高版本具有与以下示例使用的 API 相同的 API。")]),s._v(" "),t("p",[s._v("现在，在不更改任何代码的情况下，让我们构建项目，如示例代码 2-2 所示。")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo build\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Updating")]),s._v(" crates"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io index\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Downloaded")]),s._v(" rand v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Downloaded")]),s._v(" libc v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Downloaded")]),s._v(" getrandom v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Downloaded")]),s._v(" cfg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" v1"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Downloaded")]),s._v(" ppv"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lite86 v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Downloaded")]),s._v(" rand_chacha v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Downloaded")]),s._v(" rand_core v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" libc v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" getrandom v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" cfg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" v1"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" ppv"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lite86 v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" rand_core v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" rand_chacha v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" rand v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("53s\n\n")])])]),t("p",[s._v("示例 2-2: 将依赖包添加为依赖项后运行 Cargo build 的输出")]),s._v(" "),t("p",[s._v("你可能会看到不同的版本号（但由于 SemVer，它们都与代码兼容！）和不同的行（取决于操作系统），并且行的顺序可能不同。")]),s._v(" "),t("p",[s._v("当我们包含外部依赖项时，Cargo 会从注册表中获取依赖项所需的所有内容的最新版本，注册表是来自"),t("a",{attrs:{href:"https://crates.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Crates.io"),t("OutboundLink")],1),s._v("的数据副本。Crates.io 是 Rust 生态系统中的人们发布他们的开源 Rust 项目供其他人使用的地方。")]),s._v(" "),t("p",[s._v("更新注册表后，Cargo 会检查 [dependencies] 部分并下载列出的尚未下载的任何包。在本例中，尽管我们仅将 rand 列为依赖项，但 Cargo 还获取了 rand 工作所依赖的其他包。下载包后，Rust 会编译它们，然后使用可用的依赖项编译项目。")]),s._v(" "),t("p",[s._v("如果你立即再次运行 cargo build 而不做任何更改，除了 Finished 行之外，你将不会得到任何输出。Cargo 知道它已经下载并编译了依赖项，并且你没有在 Cargo.toml 文件中对它们进行任何更改。Cargo 还知道你没有更改任何代码，因此它也不会重新编译它。由于无事可做，它只是退出。")]),s._v(" "),t("p",[s._v("如果你打开 src/main.rs 文件，进行微小的更改，然后保存并再次构建，你只会看到两行输出：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo build\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.53")]),s._v(" secs\n")])])]),t("p",[s._v("这些行表明 Cargo 只会根据你对 src/main.rs 文件的微小更改来更新构建。你的依赖项没有改变，因此 Cargo 知道它可以重用已为这些依赖项下载和编译的内容。")]),s._v(" "),t("h4",{attrs:{id:"使用-cargo-lock-文件确保可重现构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-cargo-lock-文件确保可重现构建"}},[s._v("#")]),s._v(" 使用 Cargo.lock 文件确保可重现构建")]),s._v(" "),t("p",[s._v("Cargo 有一种机制，可确保你或任何其他人每次构建代码时都可以重建相同的工件：Cargo 将仅使用你指定的依赖项版本，除非你另有说明。例如，假设下周 rand crate 的 0.8.6 版本发布，该版本包含一个重要的 bug 修复，但也包含一个会破坏你的代码的回归。为了处理这个问题，Rust 会在你第一次运行 cargo build 时创建 Cargo.lock 文件，因此我们现在在 guessing_game 目录中有这个文件。")]),s._v(" "),t("p",[s._v("当你第一次构建项目时，Cargo 会找出符合条件的所有依赖项版本，然后将它们写入 Cargo.lock 文件。当你将来构建项目时，Cargo 将看到 Cargo.lock 文件存在，并将使用那里指定的版本，而不是再次进行找出版本的所有工作。这让你可以自动获得可重现的构建。换句话说，由于 Cargo.lock 文件的存在，你的项目将保持在 0.8.5 版本，直到你明确升级。由于 Cargo.lock 文件对于可重现构建很重要，因此它通常会与项目中的其余代码一起检入源代码控制中。")]),s._v(" "),t("h4",{attrs:{id:"更新依赖项以获取新版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新依赖项以获取新版本"}},[s._v("#")]),s._v(" 更新依赖项以获取新版本")]),s._v(" "),t("p",[s._v("当你确实想要更新包时，Cargo 会提供命令 update，它将忽略 Cargo.lock 文件并找出符合 Cargo.toml 中规范的所有最新版本。然后，Cargo 会将这些版本写入 Cargo.lock 文件。在这种情况下，Cargo 将仅查找大于 0.8.5 且小于 0.9.0 的版本。如果 rand 包发布了两个新版本 0.8.6 和 0.9.0，则运行 cargo update 时会看到以下内容：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo update\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Updating")]),s._v(" crates"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io index\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Updating")]),s._v(" rand v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("->")]),s._v(" v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n")])])]),t("p",[s._v("Cargo 忽略了 0.9.0 版本。此时，你还会注意到 Cargo.lock 文件中的更改，指出你现在使用的 rand 包版本是 0.8.6。要使用 rand 版本 0.9.0 或 0.9.x 系列中的任何版本，你必须将 Cargo.toml 文件更新为如下所示：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("dependencies"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nrand "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.9.0"')]),s._v("\n")])])]),t("p",[s._v("下次运行 cargo build 时，Cargo 将更新可用包的注册表，并根据你指定的新版本重新评估你的随机需求。")]),s._v(" "),t("p",[s._v("关于 "),t("a",{attrs:{href:"https://doc.rust-lang.org/cargo/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Cargo"),t("OutboundLink")],1),s._v(" 及其"),t("a",{attrs:{href:"https://doc.rust-lang.org/cargo/reference/publishing.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("生态系统"),t("OutboundLink")],1),s._v("还有很多要说的，我们将在第 14 章中讨论，但现在，这就是你需要知道的全部内容。Cargo 使复用库变得非常容易，因此开发者能够编写由多个包组装而成的较小项目。")]),s._v(" "),t("h3",{attrs:{id:"生成随机数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#生成随机数"}},[s._v("#")]),s._v(" 生成随机数")]),s._v(" "),t("p",[s._v("让我们开始使用 rand 生成一个要猜测的数字。下一步是更新 src/main.rs，代码如下所示。")]),s._v(" "),t("p",[s._v("文件名：src/main.rs")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Guess the number!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" secret_number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("thread_rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gen_range")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The secret number is: {secret_number}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please input your guess."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("new")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_line")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed to read line"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You guessed: {guess}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("首先，我们添加"),t("code",[s._v("use rand::Rng;")]),s._v("行。Rng 依赖定义了随机数生成器实现的方法，并且此依赖必须在当前上下文中引入，我们才能使用这些方法。第 10 章将详细介绍依赖。")]),s._v(" "),t("p",[s._v("接下来，我们在中间添加两行。在第一行中，我们调用"),t("code",[s._v("rand::thread_rng")]),s._v("函数，该函数为我们提供要使用的特定随机数生成器：一个当前在本地执行的线程并由操作系统实现的生成器。然后我们在随机数生成器上调用 "),t("code",[s._v("gen_range")]),s._v(" 方法。此方法由我们使用 "),t("code",[s._v("use rand::Rng;")]),s._v(" 语句引入的 Rng 包中定义。gen_range 方法调用 range 表达式作为参数然后生成范围内的随机数。我们在此处使用的 range 表达式类型采用 "),t("code",[s._v("start..=​​end")]),s._v(" 形式，并且包括下限和上限，因此我们需要指定 "),t("code",[s._v("1..=100")]),s._v(" 来请求 1 到 100 之间的数字。")]),s._v(" "),t("blockquote",[t("p",[s._v("注意：你不仅会知道要使用哪些包还要知道从依赖项中调用哪些方法和函数，因此每个依赖项都有包含使用说明的文档。Cargo 的另一个巧妙功能是运行 "),t("code",[s._v("cargo doc --open")]),s._v(" 命令将在本地构建所有依赖项提供的文档并在浏览器中打开它。例如，如果你对 rand 依赖项中的其他功能感兴趣，请运行 "),t("code",[s._v("cargo doc --open")]),s._v(" 并单击左侧边栏中的 rand。")])]),s._v(" "),t("p",[s._v("第二行新代码打印秘密数字。这在我们开发程序时很有用，以便能够对其进行测试，但我们将从最终版本中删除它。如果程序一启动就打印答案，那就没什么意思了！")]),s._v(" "),t("p",[s._v("尝试运行该程序几次：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo run\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("53s\n     "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Running")]),s._v(" `target"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("debug"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("guessing_game`\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Guess")]),s._v(" the "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("number!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("The")]),s._v(" secret number is"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n\n$ cargo run\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("02s\n     "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Running")]),s._v(" `target"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("debug"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("guessing_game`\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Guess")]),s._v(" the "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("number!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("The")]),s._v(" secret number is"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n")])])]),t("p",[s._v("你应该得到不同的随机数，并且它们都应该是 1 到 100 之间的数字。这很不错！")]),s._v(" "),t("h2",{attrs:{id:"将猜测数字与秘密数字进行比较"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将猜测数字与秘密数字进行比较"}},[s._v("#")]),s._v(" 将猜测数字与秘密数字进行比较")]),s._v(" "),t("p",[s._v("现在我们有了用户输入和随机数，我们可以比较它们了。该步骤如以下 2-4 示例代码所示。请注意，此代码目前还不能编译，我们将对此进行解释。")]),s._v(" "),t("p",[s._v("文件名: src/main.rs (示例 2-4)")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),s._v("cmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// --省略的代码--")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("Guess the number!");')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// let secret_number = rand::thread_rng().gen_range(1..=100);")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("The secret number is: {secret_number}");')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("Please input your guess.");')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// let mut guess = String::new();")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// io::stdin()")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     .read_line(&mut guess)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//     .expect("Failed to read line");')]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You guessed: {guess}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("secret_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Less")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too small!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Greater")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too big!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Equal")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You win!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("首先，我们添加另一个 use 语句，将标准库中的一个名为"),t("code",[s._v("std::cmp::Ordering")]),s._v("的类型引入当前上下文中。Ordering 类型是另一个枚举，具有 Less、Greater 和 Equal 变量。这是比较两个值时可能出现的三种结果。")]),s._v(" "),t("p",[s._v("然后我们在底部添加三行使用 Ordering 类型的新代码。"),t("code",[s._v("cmp")]),s._v("方法比较两个值，并且可以在任何可以比较的变量上调用。它引用你想要比较的任何变量：这里它将 "),t("code",[s._v("guess")]),s._v(" 与 "),t("code",[s._v("secret_number")]),s._v(" 进行比较。然后它返回我们使用 "),t("code",[s._v("use")]),s._v(" 语句带入当前上下文的 Ordering 枚举的变量。我们使用 "),t("a",{attrs:{href:"https://doc.rust-lang.org/book/ch06-02-match.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("match"),t("OutboundLink")],1),s._v(" 表达式来决定下一步要做什么，这取决于使用 guess 和 secret_number 中的值调用 cmp 时返回的 Ordering 的变量值。")]),s._v(" "),t("p",[s._v("match 表达式由多个分支组成。分支由要匹配的模式和在 match 给定的值符合该分支模式时应运行的代码组成。Rust 获取 match 给定的值并依次查看每个分支的模式。模式和 match 表达式是 Rust 的强大功能：它们让你可以表达代码可能遇到的各种情况，并确保你能够处理所有这些情况。这些功能将分别在第 6 章和第 18 章中详细介绍。")]),s._v(" "),t("p",[s._v("让我们通过此处使用的 match 表达式来演示一个示例。假设用户猜测了 50，而这次随机生成的秘密数字是 38。")]),s._v(" "),t("p",[s._v("当代码将 50 与 38 进行比较时，"),t("code",[s._v("cmp")]),s._v(" 方法将返回 "),t("code",[s._v("Ordering::Greater")]),s._v("，因为 50 大于 38。match 表达式获取 "),t("code",[s._v("Ordering::Greater")]),s._v(" 值并开始检查每个分支的模式。它查看第一个分支的模式 "),t("code",[s._v("Ordering::Less")]),s._v("，并发现值 "),t("code",[s._v("Ordering::Greater")]),s._v(" 与 "),t("code",[s._v("Ordering::Less")]),s._v(" 不匹配，因此它忽略该分支中的代码并移至下一个分支。下一个分支的模式是 "),t("code",[s._v("Ordering::Greater")]),s._v("，它与 "),t("code",[s._v("Ordering::Greater")]),s._v(" 匹配！该分支中的相关代码将执行并在终端控制台上打印 "),t("code",[s._v("Too big!")]),s._v("。match 表达式在第一次成功匹配后结束，因此在这种情况下它不会查看最后一个分支。")]),s._v(" "),t("p",[s._v("但是，示例 2-4 中的代码还不能编译。我们来尝试一下：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo build\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" libc v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("86")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" getrandom v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" cfg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" v1"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" ppv"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lite86 v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" rand_core v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" rand_chacha v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" rand v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\nerror"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("E0308")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mismatched types\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("->")]),s._v(" src"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("secret_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" expected `"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" found `"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("integer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("`\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("                 arguments to this method are incorrect\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" note"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" expected reference `"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v("`\n              found reference `"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("integer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("`\nnote"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" method defined here\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("->")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rustc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("129f3b9964af4d4a709d1383930ade12dfe7c081"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("library"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("core"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("src"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("cmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("840")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("For")]),s._v(" more information about this error"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" `rustc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("explain "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("E0308")]),s._v("`"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nerror"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" could not compile `guessing_game` "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bin "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"guessing_game"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" due to "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" previous error\n")])])]),t("p",[s._v("错误的核心是类型不匹配。Rust 有一个强大的静态类型系统。但是，它也有类型推断。当我们写 "),t("code",[s._v("let mut guess = String::new()")]),s._v(" 时，Rust 能够推断 guess 应该是 String，而不需要我们写出类型。另一方面，secret_number 是数字类型。Rust 的一些数字类型的值可以在 1 到 100 之间：i32，32 位数字；u32，无符号 32 位数字；i64，64 位数字；以及其他。除非另有说明，否则 Rust 默认为 i32，这是 secret_number 的类型，除非你在其他地方添加类型信息，导致 Rust 推断出不同的数字类型。错误的原因是 Rust 无法比较字符串和数字类型。")]),s._v(" "),t("p",[s._v("最终，我们希望将程序读取的字符串转换为数字类型，以便我们可以将其与秘密数字进行数字比较。我们通过在主函数体中添加这一行来实现：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),s._v("cmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("Guess the number!");')]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// let secret_number = rand::thread_rng().gen_range(1..=100);")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("The secret number is: {secret_number}");')]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("Please input your guess.");')]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// --省略--")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("new")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_line")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed to read line"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("u32")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("trim")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please type a number!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You guessed: {guess}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("secret_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Less")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too small!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Greater")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too big!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Equal")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You win!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("那一行代码就是:")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("u32")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("trim")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please type a number!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("我们创建了一个名为 guess 的变量。但是等一下，程序中不是已经有一个名为 guess 的变量了吗？它确实有，但 Rust 允许我们用新值覆盖 guess 的先前值。覆盖让我们可以重用 guess 变量名，而不必创建两个唯一的变量，例如 guess_str 和 guess。我们将在"),t("a",{attrs:{href:"https://doc.rust-lang.org/book/ch03-01-variables-and-mutability.html#shadowing",target:"_blank",rel:"noopener noreferrer"}},[s._v("第 3 章"),t("OutboundLink")],1),s._v("中更详细地介绍这一点，但现在，要知道这个特性通常在你想要将值从一种类型转换为另一种类型时使用。")]),s._v(" "),t("p",[s._v("我们将这个新变量绑定到表达式 guess.trim().parse()。表达式中的 guess 指的是包含字符串输入的原始 guess 变量。String 实例上的 trim 方法将消除开头和结尾的任何空格，我们必须这样做才能将字符串与只能包含数值数据的 u32 进行比较。用户必须按回车键才能满足 read_line 并输入他们的猜测，这会在字符串中添加一个换行符。例如，如果用户输入 5 并按回车键，guess 看起来就像这样：5\\n。\\n 代表“换行符”。（在 Windows 上，按回车键会导致回车符和换行符 \\r\\n。）trim 方法会消除 \\n 或 \\r\\n，只剩下 5。")]),s._v(" "),t("p",[s._v("字符串上的"),t("a",{attrs:{href:"https://doc.rust-lang.org/std/primitive.str.html#method.parse",target:"_blank",rel:"noopener noreferrer"}},[s._v("parse"),t("OutboundLink")],1),s._v("方法将字符串转换为另一种类型。在这里，我们使用它从字符串转换为数字。我们需要使用 "),t("code",[s._v("let guess: u32")]),s._v(" 告诉 Rust 我们想要的确切数字类型。 guess 后面的冒号(:)告诉 Rust 我们将注释变量的类型。Rust 有几个内置的数字类型；这里看到的 u32 是一个无符号的 32 位整数。对于较小的正数来说，这是一个很好的默认选择。你将在"),t("a",{attrs:{href:"https://doc.rust-lang.org/book/ch03-02-data-types.html#integer-types",target:"_blank",rel:"noopener noreferrer"}},[s._v("第 3 章"),t("OutboundLink")],1),s._v("中了解其他数字类型。")]),s._v(" "),t("p",[s._v("此外，此示例程序中的 u32 注释和与 secret_number 的比较意味着 Rust 将推断 secret_number 也应该是 u32。所以现在比较的是同一类型的两个值！")]),s._v(" "),t("p",[s._v("parse 方法只适用于逻辑上可以转换为数字的字符，因此很容易导致错误。例如，如果字符串包含 "),t("code",[s._v("A👍%")]),s._v("，则无法将其转换为数字。由于可能会失败，parse 方法返回 Result 类型，就像 read_line 方法一样（前面在“"),t("a",{attrs:{href:"#%E5%B0%86%E7%8C%9C%E6%B5%8B%E6%95%B0%E5%AD%97%E4%B8%8E%E7%A7%98%E5%AF%86%E6%95%B0%E5%AD%97%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83"}},[s._v("使用 Result 处理潜在失败")]),s._v("”中讨论过）。我们将再次使用 expect 方法以相同的方式处理此 Result。如果 parse 返回 Err Result 变体（因为它无法从字符串创建数字），则 expect 调用将使游戏崩溃并打印我们给它的消息。如果 parse 可以成功地将字符串转换为数字，它将返回 Result 的 Ok 变体，并且 expect 将从 Ok 值返回我们想要的数字。")]),s._v(" "),t("p",[s._v("现在让我们运行程序：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo run\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("43s\n     "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Running")]),s._v(" `target"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("debug"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("guessing_game`\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Guess")]),s._v(" the "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("number!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("The")]),s._v(" secret number is"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("58")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("76")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("76")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Too")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("big!")]),s._v("\n")])])]),t("p",[s._v("太棒了！即使在猜测之前添加了空格，程序仍然会判断出用户猜测的是 76。运行程序几次，以验证不同输入类型的不同行为：正确猜测数字、猜测过大的数字以及猜测过小的数字。")]),s._v(" "),t("p",[s._v("现在游戏的大部分功能都已运行，但用户只能猜测一次。让我们通过添加循环来改变这种情况！")]),s._v(" "),t("h2",{attrs:{id:"使用循环允许多次猜测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用循环允许多次猜测"}},[s._v("#")]),s._v(" 使用循环允许多次猜测")]),s._v(" "),t("p",[s._v("loop 关键字创建一个无限循环。我们将添加一个循环，让用户有更多机会猜数字：")]),s._v(" "),t("p",[s._v("文件名: src/main.rs")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),s._v("cmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("Guess the number!");')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// let secret_number = rand::thread_rng().gen_range(1..=100);")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The secret number is: {secret_number}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please input your guess."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// let mut guess = String::new();")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// io::stdin()")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     .read_line(&mut guess)")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//     .expect("Failed to read line");')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// let guess: u32 = guess.trim().parse().expect("Please type a number!");')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("You guessed: {guess}");')]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("secret_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Less")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too small!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Greater")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too big!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Equal")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You win!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("如你所见，我们将从猜测输入提示开始的所有内容都移到了循环中。请确保将循环中的每行再缩进四个空格，然后再次运行该程序。程序现在将永远要求再次猜测，这实际上引入了一个新问题。用户似乎无法退出！")]),s._v(" "),t("p",[s._v("用户始终可以使用键盘快捷键 "),t("code",[s._v("ctrl + c")]),s._v(" 来中断程序。但是还有另一种方法可以中断程序，正如“"),t("a",{attrs:{href:"#%E5%B0%86%E7%8C%9C%E6%B5%8B%E6%95%B0%E5%AD%97%E4%B8%8E%E7%A7%98%E5%AF%86%E6%95%B0%E5%AD%97%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83"}},[s._v("将猜测数字与秘密数字进行比较")]),s._v("”中的解析讨论中所述：如果用户输入非数字答案，程序将崩溃。我们可以利用这一点来允许用户退出，如下所示：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo run\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("50s\n     "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Running")]),s._v(" `target"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("debug"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("guessing_game`\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Guess")]),s._v(" the "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("number!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("The")]),s._v(" secret number is"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Too")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("small!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Too")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("big!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("win!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nquit\nthread "),t("span",{pre:!0,attrs:{class:"token lifetime-annotation symbol"}},[s._v("'main")]),s._v("' panicked at "),t("span",{pre:!0,attrs:{class:"token lifetime-annotation symbol"}},[s._v("'Please")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("type")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token type-definition class-name"}},[s._v("a")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("number!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ParseIntError")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" kind"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InvalidDigit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" src"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),s._v("\nnote"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" run with `"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUST_BACKTRACE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("` environment variable to display a backtrace\n")])])]),t("p",[s._v("输入 "),t("code",[s._v("quit")]),s._v(" 将退出游戏，但你会注意到，输入任何其他非数字输入也会退出游戏。至少可以说，这不是最理想的；我们希望当猜出正确的数字时游戏也停止。")]),s._v(" "),t("h3",{attrs:{id:"猜对后退出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#猜对后退出"}},[s._v("#")]),s._v(" 猜对后退出")]),s._v(" "),t("p",[s._v("让我们通过添加 break 语句来编写游戏程序，让其在用户获胜时退出：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),s._v("cmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("Guess the number!");')]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// let secret_number = rand::thread_rng().gen_range(1..=100);")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("The secret number is: {secret_number}");')]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("Please input your guess.");')]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// let mut guess = String::new();")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// io::stdin()")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     .read_line(&mut guess)")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//     .expect("Failed to read line");')]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// let guess: u32 = guess.trim().parse().expect("Please type a number!");')]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// println!("You guessed: {guess}");')]),s._v("\n\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("secret_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Less")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too small!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Greater")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too big!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Equal")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You win!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 新增的代码")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("在 "),t("code",[s._v("You win!")]),s._v(" 后面添加 break 行，使得程序在用户正确猜出秘密数字时退出循环。退出循环也意味着退出程序，因为循环是 main 的最后部分。")]),s._v(" "),t("h3",{attrs:{id:"处理无效输入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#处理无效输入"}},[s._v("#")]),s._v(" 处理无效输入")]),s._v(" "),t("p",[s._v("为了进一步优化游戏的行为，而不是在用户输入非数字时让程序崩溃，我们让游戏忽略非数字，以便用户可以继续猜测。我们可以通过修改将 guess 从字符串转换为 u32 的行来实现这一点，如示例 2-5 所示。")]),s._v(" "),t("p",[s._v("文件名: main.rs")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),s._v("cmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Guess the number!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" secret_number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("thread_rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gen_range")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The secret number is: {secret_number}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please input your guess."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("new")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_line")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed to read line"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("u32")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("trim")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ok")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 新增代码")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Err")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You guessed: {guess}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("secret_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Less")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too small!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Greater")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too big!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Equal")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You win!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("示例 2-5: 忽略非数字猜测并要求再次猜测，而不是让程序崩溃")]),s._v(" "),t("p",[s._v("我们从 expect 调用切换到 match 表达式，以便从发生错误时崩溃转变为处理错误。请记住，parse 返回 Result 类型，Result 是一个枚举，它具有 Ok 和 Err 变量。我们在这里使用 match 表达式，就像我们对 cmp 方法的 Ordering 结果所做的那样。")]),s._v(" "),t("p",[s._v("如果 parse 能够成功将字符串转换为数字，它将返回一个包含结果数字的 Ok 值。该 Ok 值将与第一个分支的模式匹配，而 match 表达式将只返回 parse 生成的 num 值并放入 Ok 值中。该数字最终将出现在我们创建的新 guess 变量中我们想要的位置。")]),s._v(" "),t("p",[s._v("如果 parse 无法将字符串转换为数字，它将返回一个包含更多错误信息的 Err 值。Err 值与第一个匹配分支中的 Ok(num) 模式不匹配，但与第二个分支中的 Err(_) 模式匹配。下划线 _ 是一个忽略任意错误的值；在这个例子中，我们表示我们想要匹配所有 Err 值，无论它们包含什么信息。因此，程序将执行第二个分支的代码 continue，它告诉程序进入循环的下一次迭代并要求再次猜测。因此，实际上，程序忽略了 parse 可能遇到的所有错误！")]),s._v(" "),t("p",[s._v("现在程序中的所有内容都应该按预期工作了。让我们尝试一下：")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[s._v("$ cargo run\n   "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Compiling")]),s._v(" guessing_game v0"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//projects/guessing_game)")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Finished")]),s._v(" dev "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("unoptimized "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" debuginfo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("target")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("45s\n     "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Running")]),s._v(" `target"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("debug"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("guessing_game`\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Guess")]),s._v(" the "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("number!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("The")]),s._v(" secret number is"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("61")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Too")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("small!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("99")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Too")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("big!")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nfoo\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Please")]),s._v(" input your guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("61")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" guessed"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("61")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("You")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("win!")]),s._v("\n")])])]),t("p",[s._v("太棒了！最后再做一点小调整，我们就能完成猜谜游戏了。回想一下，程序仍在打印秘密数字。这对于测试来说很有效，但它毁了游戏。让我们删除输出秘密数字的 println!。示例 2-6 显示了最终代码。")]),s._v(" "),t("p",[s._v("文件名: src/main.ts")]),s._v(" "),t("div",{staticClass:"language-rust extra-class"},[t("pre",{pre:!0,attrs:{class:"language-rust"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),s._v("cmp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("std"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Guess the number!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" secret_number "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("rand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("thread_rng")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gen_range")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please input your guess."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("new")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")])]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stdin")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_line")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("mut")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("expect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed to read line"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("u32")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("trim")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ok")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Err")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You guessed: {guess}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("match")]),s._v(" guess"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("secret_number"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Less")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too small!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Greater")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Too big!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ordering")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Equal")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("println!")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You win!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("示例 2-6: 完成猜谜游戏代码")]),s._v(" "),t("p",[s._v("至此，你已成功构建了猜谜游戏。恭喜！")]),s._v(" "),t("h2",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),t("p",[s._v("这个项目以一种实践的方式向你介绍了许多新的 Rust 概念：let、match、函数、外部依赖的使用等等。在接下来的几章中，你将更详细地了解这些概念。第 3 章介绍了大多数编程语言都具有的概念，例如变量、数据类型和函数，并展示了如何在 Rust 中使用它们。第 4 章探讨了所有权，这是 Rust 有别于其他语言的一个特性。第 5 章讨论了结构和方法语法，第 6 章解释了枚举的工作原理。")])])}),[],!1,null,null,null);t.default=e.exports}}]);