<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å¦‚ä½•ç¼–å†™æµ‹è¯• | rustè¯­è¨€ä¸­æ–‡æ–‡æ¡£</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/rust-doc/logo.svg">
    <script type="text/javascript" src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
    <meta name="description" content="ä¸€é—¨èµ‹äºˆæ¯ä¸ªäººæ„å»ºå¯é ä¸”é«˜æ•ˆè½¯ä»¶èƒ½åŠ›çš„è¯­è¨€ã€‚">
    
    <link rel="preload" href="/rust-doc/assets/css/0.styles.b04b0b2c.css" as="style"><link rel="preload" href="/rust-doc/assets/js/app.858f10df.js" as="script"><link rel="preload" href="/rust-doc/assets/js/2.d1f3a877.js" as="script"><link rel="preload" href="/rust-doc/assets/js/1.169debde.js" as="script"><link rel="preload" href="/rust-doc/assets/js/107.b904cd96.js" as="script"><link rel="prefetch" href="/rust-doc/assets/js/10.0172388b.js"><link rel="prefetch" href="/rust-doc/assets/js/100.b9dda212.js"><link rel="prefetch" href="/rust-doc/assets/js/101.217ea0f0.js"><link rel="prefetch" href="/rust-doc/assets/js/102.d21f247e.js"><link rel="prefetch" href="/rust-doc/assets/js/103.7d9b56e0.js"><link rel="prefetch" href="/rust-doc/assets/js/104.20e45a3c.js"><link rel="prefetch" href="/rust-doc/assets/js/105.3b2e9e7a.js"><link rel="prefetch" href="/rust-doc/assets/js/106.f62b9226.js"><link rel="prefetch" href="/rust-doc/assets/js/108.491f1210.js"><link rel="prefetch" href="/rust-doc/assets/js/11.8ce27df2.js"><link rel="prefetch" href="/rust-doc/assets/js/12.8f06284b.js"><link rel="prefetch" href="/rust-doc/assets/js/13.a9d52700.js"><link rel="prefetch" href="/rust-doc/assets/js/14.78d60e9f.js"><link rel="prefetch" href="/rust-doc/assets/js/15.c3be2b8d.js"><link rel="prefetch" href="/rust-doc/assets/js/16.9d65f123.js"><link rel="prefetch" href="/rust-doc/assets/js/17.1344f53c.js"><link rel="prefetch" href="/rust-doc/assets/js/18.967f6c8c.js"><link rel="prefetch" href="/rust-doc/assets/js/19.be24f0c8.js"><link rel="prefetch" href="/rust-doc/assets/js/20.6d69020f.js"><link rel="prefetch" href="/rust-doc/assets/js/21.800d8e53.js"><link rel="prefetch" href="/rust-doc/assets/js/22.71d363d8.js"><link rel="prefetch" href="/rust-doc/assets/js/23.f22b7556.js"><link rel="prefetch" href="/rust-doc/assets/js/24.1f1f3426.js"><link rel="prefetch" href="/rust-doc/assets/js/25.0457c80e.js"><link rel="prefetch" href="/rust-doc/assets/js/26.9c0e8457.js"><link rel="prefetch" href="/rust-doc/assets/js/27.b2bbe252.js"><link rel="prefetch" href="/rust-doc/assets/js/28.0d257210.js"><link rel="prefetch" href="/rust-doc/assets/js/29.94fa333d.js"><link rel="prefetch" href="/rust-doc/assets/js/3.2f372239.js"><link rel="prefetch" href="/rust-doc/assets/js/30.499f961c.js"><link rel="prefetch" href="/rust-doc/assets/js/31.95ffe89b.js"><link rel="prefetch" href="/rust-doc/assets/js/32.1bc4680d.js"><link rel="prefetch" href="/rust-doc/assets/js/33.351ca28a.js"><link rel="prefetch" href="/rust-doc/assets/js/34.42a4fd70.js"><link rel="prefetch" href="/rust-doc/assets/js/35.a1e7c9bc.js"><link rel="prefetch" href="/rust-doc/assets/js/36.a93b7523.js"><link rel="prefetch" href="/rust-doc/assets/js/37.b8c01512.js"><link rel="prefetch" href="/rust-doc/assets/js/38.7814be15.js"><link rel="prefetch" href="/rust-doc/assets/js/39.f959a3e6.js"><link rel="prefetch" href="/rust-doc/assets/js/4.028f2830.js"><link rel="prefetch" href="/rust-doc/assets/js/40.8525a0b3.js"><link rel="prefetch" href="/rust-doc/assets/js/41.f502b7a1.js"><link rel="prefetch" href="/rust-doc/assets/js/42.a8383224.js"><link rel="prefetch" href="/rust-doc/assets/js/43.4cd15d0b.js"><link rel="prefetch" href="/rust-doc/assets/js/44.c516f770.js"><link rel="prefetch" href="/rust-doc/assets/js/45.74515de9.js"><link rel="prefetch" href="/rust-doc/assets/js/46.3f6dbfaf.js"><link rel="prefetch" href="/rust-doc/assets/js/47.f47b52f9.js"><link rel="prefetch" href="/rust-doc/assets/js/48.1ec4be20.js"><link rel="prefetch" href="/rust-doc/assets/js/49.0f4c1b03.js"><link rel="prefetch" href="/rust-doc/assets/js/5.d59f8a59.js"><link rel="prefetch" href="/rust-doc/assets/js/50.484cbe9a.js"><link rel="prefetch" href="/rust-doc/assets/js/51.785f9d59.js"><link rel="prefetch" href="/rust-doc/assets/js/52.8c37fd72.js"><link rel="prefetch" href="/rust-doc/assets/js/53.ad699744.js"><link rel="prefetch" href="/rust-doc/assets/js/54.bd2575ee.js"><link rel="prefetch" href="/rust-doc/assets/js/55.e01beca6.js"><link rel="prefetch" href="/rust-doc/assets/js/56.abcac538.js"><link rel="prefetch" href="/rust-doc/assets/js/57.e1cf5467.js"><link rel="prefetch" href="/rust-doc/assets/js/58.653827a0.js"><link rel="prefetch" href="/rust-doc/assets/js/59.dcd7d1e9.js"><link rel="prefetch" href="/rust-doc/assets/js/6.6b5c95a2.js"><link rel="prefetch" href="/rust-doc/assets/js/60.57810f19.js"><link rel="prefetch" href="/rust-doc/assets/js/61.dc7bd6a0.js"><link rel="prefetch" href="/rust-doc/assets/js/62.2c435b70.js"><link rel="prefetch" href="/rust-doc/assets/js/63.9f9255c6.js"><link rel="prefetch" href="/rust-doc/assets/js/64.3d1df9ac.js"><link rel="prefetch" href="/rust-doc/assets/js/65.34bc396c.js"><link rel="prefetch" href="/rust-doc/assets/js/66.97d46611.js"><link rel="prefetch" href="/rust-doc/assets/js/67.10fa04cd.js"><link rel="prefetch" href="/rust-doc/assets/js/68.06be5e25.js"><link rel="prefetch" href="/rust-doc/assets/js/69.2b1ec7d9.js"><link rel="prefetch" href="/rust-doc/assets/js/7.e3826499.js"><link rel="prefetch" href="/rust-doc/assets/js/70.e64e314a.js"><link rel="prefetch" href="/rust-doc/assets/js/71.7fc9dd6c.js"><link rel="prefetch" href="/rust-doc/assets/js/72.838fc207.js"><link rel="prefetch" href="/rust-doc/assets/js/73.db5e1ce7.js"><link rel="prefetch" href="/rust-doc/assets/js/74.cca5b065.js"><link rel="prefetch" href="/rust-doc/assets/js/75.9c75e6d1.js"><link rel="prefetch" href="/rust-doc/assets/js/76.9b2694ef.js"><link rel="prefetch" href="/rust-doc/assets/js/77.adefa865.js"><link rel="prefetch" href="/rust-doc/assets/js/78.f8972598.js"><link rel="prefetch" href="/rust-doc/assets/js/79.1796c54e.js"><link rel="prefetch" href="/rust-doc/assets/js/80.61ca9cc8.js"><link rel="prefetch" href="/rust-doc/assets/js/81.ec272458.js"><link rel="prefetch" href="/rust-doc/assets/js/82.b7f5cedb.js"><link rel="prefetch" href="/rust-doc/assets/js/83.ead1285f.js"><link rel="prefetch" href="/rust-doc/assets/js/84.2434187a.js"><link rel="prefetch" href="/rust-doc/assets/js/85.d1e1a075.js"><link rel="prefetch" href="/rust-doc/assets/js/86.d3146267.js"><link rel="prefetch" href="/rust-doc/assets/js/87.cf40e513.js"><link rel="prefetch" href="/rust-doc/assets/js/88.c71083e9.js"><link rel="prefetch" href="/rust-doc/assets/js/89.ebd49ebe.js"><link rel="prefetch" href="/rust-doc/assets/js/90.cd0db535.js"><link rel="prefetch" href="/rust-doc/assets/js/91.887b6670.js"><link rel="prefetch" href="/rust-doc/assets/js/92.24945cce.js"><link rel="prefetch" href="/rust-doc/assets/js/93.f4cbd5b3.js"><link rel="prefetch" href="/rust-doc/assets/js/94.236e0e92.js"><link rel="prefetch" href="/rust-doc/assets/js/95.6532ea92.js"><link rel="prefetch" href="/rust-doc/assets/js/96.39cba713.js"><link rel="prefetch" href="/rust-doc/assets/js/97.8bfe6fe2.js"><link rel="prefetch" href="/rust-doc/assets/js/98.0f169062.js"><link rel="prefetch" href="/rust-doc/assets/js/99.dfd546fb.js"><link rel="prefetch" href="/rust-doc/assets/js/vendors~docsearch.65d77edd.js">
    <link rel="stylesheet" href="/rust-doc/assets/css/0.styles.b04b0b2c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/rust-doc/" class="home-link router-link-active"><!----> <span class="site-name">rustè¯­è¨€ä¸­æ–‡æ–‡æ¡£</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/rust-doc/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="https://github.com/eveningwater/rust-doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/eveningwater" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ç äº‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/rust-doc/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="https://github.com/eveningwater/rust-doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/eveningwater" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ç äº‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/rust-doc/doc/introduce/introduce.html" class="sidebar-link">Rustä»‹ç»</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/getting-started/getting-started" class="sidebar-heading clickable"><span>å…¥é—¨</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/rust-doc/doc/guess-game/guess-game.html" class="sidebar-link">çŒœä¸€çŒœæ¸¸æˆ</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/common-concept/common-concept" class="sidebar-heading clickable"><span>å¸¸ç”¨çš„ç¼–ç¨‹æ¦‚å¿µ</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/understand-ownership/understand-ownership" class="sidebar-heading clickable"><span>è®¤è¯†æ‰€æœ‰æƒ</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/structs/structs" class="sidebar-heading clickable"><span>ä½¿ç”¨ç»“æ„ä½“æ¥æ„é€ ç›¸å…³æ•°æ®</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/enums/enums" class="sidebar-heading clickable"><span>æšä¸¾</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/packages-crates-and-modules/packages-crates-and-modules" class="sidebar-heading clickable"><span>ä½¿ç”¨åŒ…ã€ä¾èµ–ç®±å’Œæ¨¡å—ç®¡ç†ä¸æ–­å¢é•¿çš„é¡¹ç›®</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/common-collections/common-collections" class="sidebar-heading clickable"><span>å¸¸ç”¨é›†åˆ</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/error-handling/error-handling" class="sidebar-heading clickable"><span>é”™è¯¯å¤„ç†</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/generics/generics" class="sidebar-heading clickable"><span>æ³›å‹ç±»å‹ã€ç‰¹æ€§å’Œç”Ÿå‘½å‘¨æœŸ</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/testing/testing" class="sidebar-heading clickable open"><span>æµ‹è¯•</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/rust-doc/doc/testing/writing-tests.html" aria-current="page" class="active sidebar-link">ç¼–å†™æµ‹è¯•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rust-doc/doc/testing/writing-tests.html#å¦‚ä½•ç¼–å†™æµ‹è¯•" class="sidebar-link">å¦‚ä½•ç¼–å†™æµ‹è¯•</a></li></ul></li><li><a href="/rust-doc/doc/testing/running-tests.html" class="sidebar-link">è¿è¡Œæµ‹è¯•</a></li><li><a href="/rust-doc/doc/testing/test-organization.html" class="sidebar-link">æµ‹è¯•çš„ç»„ç»‡ç»“æ„</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/an-io-project/an-io-project" class="sidebar-heading clickable"><span>I/O é¡¹ç›®ï¼šæ„å»ºå‘½ä»¤è¡Œç¨‹åº</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/functional-features/functional-features" class="sidebar-heading clickable"><span>å‡½æ•°å¼è¯­è¨€ç‰¹æ€§ï¼šè¿­ä»£å™¨ä¸é—­åŒ…</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/more-about-cargo/more-about-cargo" class="sidebar-heading clickable"><span>å…³äº Cargo å’Œ Crates.io çš„æ›´å¤šä¿¡æ¯</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/smart-pointers/smart-pointers" class="sidebar-heading clickable"><span>æ™ºèƒ½æŒ‡é’ˆ</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/concurrency/concurrency" class="sidebar-heading clickable"><span>æ— ç•å¹¶å‘</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/async-await/async-await" class="sidebar-heading clickable"><span>å¼‚æ­¥ç¼–ç¨‹åŸºç¡€ï¼šAsyncã€Awaitã€Futures å’Œ Streams</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>é™„å½•</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="å¦‚ä½•ç¼–å†™æµ‹è¯•"><a href="#å¦‚ä½•ç¼–å†™æµ‹è¯•" class="header-anchor">#</a> å¦‚ä½•ç¼–å†™æµ‹è¯•</h2> <p>æµ‹è¯•æ˜¯ Rust å‡½æ•°ï¼Œç”¨äºéªŒè¯éæµ‹è¯•ä»£ç æ˜¯å¦æŒ‰é¢„æœŸæ–¹å¼è¿è¡Œã€‚æµ‹è¯•å‡½æ•°çš„ä¸»ä½“é€šå¸¸æ‰§è¡Œä»¥ä¸‹ä¸‰ä¸ªæ“ä½œï¼š</p> <ul><li>è®¾ç½®æ‰€éœ€çš„æ•°æ®æˆ–çŠ¶æ€ã€‚</li> <li>è¿è¡Œè¦æµ‹è¯•çš„ä»£ç ã€‚</li> <li>æ–­è¨€ç»“æœç¬¦åˆé¢„æœŸã€‚</li></ul> <p>è®©æˆ‘ä»¬çœ‹çœ‹ Rust ä¸“é—¨ä¸ºç¼–å†™æ‰§è¡Œè¿™äº›æ“ä½œçš„æµ‹è¯•æä¾›çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ test å±æ€§ã€ä¸€äº›å®å’Œ should_panic å±æ€§ã€‚</p> <h3 id="æµ‹è¯•å‡½æ•°çš„å‰–æ"><a href="#æµ‹è¯•å‡½æ•°çš„å‰–æ" class="header-anchor">#</a> æµ‹è¯•å‡½æ•°çš„å‰–æ</h3> <p>æœ€ç®€å•åœ°è¯´ï¼ŒRust ä¸­çš„æµ‹è¯•æ˜¯ä¸€ä¸ªå¸¦æœ‰ test å±æ€§æ ‡æ³¨çš„å‡½æ•°ã€‚å±æ€§æ˜¯å…³äº Rust ä»£ç ç‰‡æ®µçš„å…ƒæ•°æ®ï¼›ä¸€ä¸ªä¾‹å­æ˜¯æˆ‘ä»¬åœ¨ç¬¬ 5 ç« ä¸­ä¸ç»“æ„ä½“ä¸€èµ·ä½¿ç”¨çš„ derive å±æ€§ã€‚è¦å°†å‡½æ•°è½¬å˜ä¸ºæµ‹è¯•å‡½æ•°ï¼Œè¯·åœ¨ fn ä¹‹å‰çš„è¡Œä¸Šæ·»åŠ  #[test]ã€‚å½“ä½ ä½¿ç”¨ cargo test å‘½ä»¤è¿è¡Œæµ‹è¯•æ—¶ï¼ŒRust ä¼šæ„å»ºä¸€ä¸ªæµ‹è¯•è¿è¡Œå™¨äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®ƒä¼šè¿è¡Œå¸¦æ³¨è§£çš„å‡½æ•°å¹¶æŠ¥å‘Šæ¯ä¸ªæµ‹è¯•å‡½æ•°æ˜¯é€šè¿‡è¿˜æ˜¯å¤±è´¥ã€‚</p> <p>æ¯å½“æˆ‘ä»¬ä½¿ç”¨ Cargo åˆ›å»ºä¸€ä¸ªæ–°çš„åº“é¡¹ç›®æ—¶ï¼Œä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªåŒ…å«æµ‹è¯•å‡½æ•°çš„æµ‹è¯•æ¨¡å—ã€‚è¿™ä¸ªæ¨¡å—ä¸ºä½ æä¾›äº†ç¼–å†™æµ‹è¯•çš„æ¨¡æ¿ï¼Œè¿™æ ·ä½ å°±ä¸å¿…åœ¨æ¯æ¬¡å¼€å§‹æ–°é¡¹ç›®æ—¶æŸ¥æ‰¾ç¡®åˆ‡çš„ç»“æ„å’Œè¯­æ³•ã€‚ä½ å¯ä»¥æ·»åŠ ä»»æ„æ•°é‡çš„é¢å¤–æµ‹è¯•å‡½æ•°å’Œæµ‹è¯•æ¨¡å—ï¼</p> <p>åœ¨æˆ‘ä»¬å®é™…æµ‹è¯•ä»»ä½•ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å°†é€šè¿‡å®éªŒæ¨¡æ¿æµ‹è¯•æ¥æ¢ç´¢æµ‹è¯•çš„å·¥ä½œåŸç†çš„ä¸€äº›æ–¹é¢ã€‚ç„¶åæˆ‘ä»¬å°†ç¼–å†™ä¸€äº›çœŸå®ä¸–ç•Œçš„æµ‹è¯•ï¼Œè°ƒç”¨æˆ‘ä»¬ç¼–å†™çš„ä»£ç å¹¶æ–­è¨€å…¶è¡Œä¸ºæ˜¯æ­£ç¡®çš„ã€‚</p> <p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º adder çš„æ–°åº“é¡¹ç›®ï¼Œå®ƒå°†å¯¹ä¸¤ä¸ªæ•°å­—è¿›è¡Œç›¸åŠ ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo new adder <span class="token operator">-</span><span class="token operator">-</span>lib
     <span class="token class-name">Created</span> library `adder` project
$ cd adder
</code></pre></div><p>adder åº“ä¸­ src/lib.rs æ–‡ä»¶çš„å†…å®¹åº”è¯¥å¦‚ç¤ºä¾‹ 11-1 æ‰€ç¤ºã€‚</p> <p>æ–‡ä»¶åï¼šsrc/lib.rsï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span>left<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">,</span> right<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u64</span> <span class="token punctuation">{</span>
    left <span class="token operator">+</span> right
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">it_works</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç¤ºä¾‹ 11-1ï¼š<code>cargo new</code> è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç </p> <p>è¯¥æ–‡ä»¶ä»¥ä¸€ä¸ªç¤ºä¾‹ add å‡½æ•°å¼€å§‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰ä¸œè¥¿å¯ä»¥æµ‹è¯•ã€‚</p> <p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬åªå…³æ³¨ it_works å‡½æ•°ã€‚æ³¨æ„ #[test] æ³¨è§£ï¼šè¿™ä¸ªå±æ€§è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å‡½æ•°ï¼Œæ‰€ä»¥æµ‹è¯•è¿è¡Œå™¨çŸ¥é“å°†æ­¤å‡½æ•°è§†ä¸ºæµ‹è¯•ã€‚æˆ‘ä»¬ä¹Ÿå¯èƒ½åœ¨ tests æ¨¡å—ä¸­æœ‰éæµ‹è¯•å‡½æ•°æ¥å¸®åŠ©è®¾ç½®å¸¸è§åœºæ™¯æˆ–æ‰§è¡Œå¸¸è§æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬æ€»æ˜¯éœ€è¦æŒ‡æ˜å“ªäº›å‡½æ•°æ˜¯æµ‹è¯•ã€‚</p> <p>ç¤ºä¾‹å‡½æ•°ä½“ä½¿ç”¨ assert_eq! å®æ¥æ–­è¨€ resultï¼ˆåŒ…å«è°ƒç”¨ add å‡½æ•°ä¼ å…¥ 2 å’Œ 2 çš„ç»“æœï¼‰ç­‰äº 4ã€‚è¿™ä¸ªæ–­è¨€ä½œä¸ºå…¸å‹æµ‹è¯•æ ¼å¼çš„ç¤ºä¾‹ã€‚è®©æˆ‘ä»¬è¿è¡Œå®ƒï¼Œçœ‹çœ‹è¿™ä¸ªæµ‹è¯•æ˜¯å¦é€šè¿‡ã€‚</p> <p><code>cargo test</code> å‘½ä»¤è¿è¡Œé¡¹ç›®ä¸­çš„æ‰€æœ‰æµ‹è¯•ï¼Œå¦‚ç¤ºä¾‹ 11-2 æ‰€ç¤ºã€‚</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> adder v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/adder)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>57s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/adder/target/debug/deps/adder-7acb243c25ffd9dc)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>it_works <span class="token punctuation">...</span> ok

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">1</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

   <span class="token class-name">Doc</span><span class="token operator">-</span>tests adder

running <span class="token number">0</span> tests

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s
</code></pre></div><p>ç¤ºä¾‹ 11-2ï¼šè¿è¡Œè‡ªåŠ¨ç”Ÿæˆçš„æµ‹è¯•çš„è¾“å‡º</p> <p>Cargo ç¼–è¯‘å¹¶è¿è¡Œäº†æµ‹è¯•ã€‚æˆ‘ä»¬çœ‹åˆ° running 1 test è¿™ä¸€è¡Œã€‚ä¸‹ä¸€è¡Œæ˜¾ç¤ºç”Ÿæˆçš„æµ‹è¯•å‡½æ•°çš„åç§°ï¼Œç§°ä¸º tests::it_worksï¼Œä»¥åŠè¿è¡Œè¯¥æµ‹è¯•çš„ç»“æœæ˜¯ okã€‚æ€»ä½“æµ‹è¯•ç»“æœæ‘˜è¦ test result: ok. è¡¨ç¤ºæ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡äº†ï¼Œè€Œè¯»ä½œ 1 passed; 0 failed çš„éƒ¨åˆ†ç»Ÿè®¡äº†é€šè¿‡æˆ–å¤±è´¥çš„æµ‹è¯•æ•°é‡ã€‚</p> <p>å¯ä»¥å°†æµ‹è¯•æ ‡è®°ä¸ºå¿½ç•¥ï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šåœ¨ç‰¹å®šå®ä¾‹ä¸­è¿è¡Œï¼›æˆ‘ä»¬å°†åœ¨æœ¬ç« åé¢çš„&quot;é™¤éç‰¹åˆ«è¯·æ±‚ï¼Œå¦åˆ™å¿½ç•¥æŸäº›æµ‹è¯•&quot;éƒ¨åˆ†ä¸­ä»‹ç»è¿™ä¸€ç‚¹ã€‚å› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œæ²¡æœ‰è¿™æ ·åšï¼Œæ‰€ä»¥æ‘˜è¦æ˜¾ç¤º 0 ignoredã€‚</p> <p>0 measured ç»Ÿè®¡æ•°æ®ç”¨äºåŸºå‡†æµ‹è¯•ï¼Œæµ‹é‡æ€§èƒ½ã€‚åŸºå‡†æµ‹è¯•åœ¨æ’°å†™æœ¬æ–‡æ—¶ä»…åœ¨ nightly Rust ä¸­å¯ç”¨ã€‚æœ‰å…³åŸºå‡†æµ‹è¯•çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ç›¸å…³æ–‡æ¡£ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥å‘ cargo test å‘½ä»¤ä¼ é€’å‚æ•°ï¼Œåªè¿è¡Œåç§°åŒ¹é…å­—ç¬¦ä¸²çš„æµ‹è¯•ï¼›è¿™ç§°ä¸ºè¿‡æ»¤ï¼Œæˆ‘ä»¬å°†åœ¨&quot;æŒ‰åç§°è¿è¡Œæµ‹è¯•å­é›†&quot;éƒ¨åˆ†ä¸­ä»‹ç»ã€‚è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰è¿‡æ»¤æ­£åœ¨è¿è¡Œçš„æµ‹è¯•ï¼Œæ‰€ä»¥æ‘˜è¦æœ«å°¾æ˜¾ç¤º 0 filtered outã€‚</p> <p>æµ‹è¯•è¾“å‡ºçš„ä¸‹ä¸€éƒ¨åˆ†ä» Doc-tests adder å¼€å§‹ï¼Œæ˜¯ä»»ä½•æ–‡æ¡£æµ‹è¯•çš„ç»“æœã€‚æˆ‘ä»¬è¿˜æ²¡æœ‰ä»»ä½•æ–‡æ¡£æµ‹è¯•ï¼Œä½† Rust å¯ä»¥ç¼–è¯‘å‡ºç°åœ¨æˆ‘ä»¬ API æ–‡æ¡£ä¸­çš„ä»»ä½•ä»£ç ç¤ºä¾‹ã€‚è¿™ä¸ªåŠŸèƒ½æœ‰åŠ©äºä¿æŒæ–‡æ¡£å’Œä»£ç åŒæ­¥ï¼æˆ‘ä»¬å°†åœ¨ç¬¬ 14 ç« çš„&quot;æ–‡æ¡£æ³¨é‡Šä½œä¸ºæµ‹è¯•&quot;éƒ¨åˆ†è®¨è®ºå¦‚ä½•ç¼–å†™æ–‡æ¡£æµ‹è¯•ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†å¿½ç•¥ Doc-tests è¾“å‡ºã€‚</p> <p>è®©æˆ‘ä»¬å¼€å§‹æ ¹æ®è‡ªå·±çš„éœ€æ±‚å®šåˆ¶æµ‹è¯•ã€‚é¦–å…ˆï¼Œå°† it_works å‡½æ•°çš„åç§°æ›´æ”¹ä¸ºä¸åŒçš„åç§°ï¼Œä¾‹å¦‚ explorationï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> <p>æ–‡ä»¶åï¼šsrc/lib.rsï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span>left<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">,</span> right<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u64</span> <span class="token punctuation">{</span>
    left <span class="token operator">+</span> right
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">exploration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶åå†æ¬¡è¿è¡Œ cargo testã€‚è¾“å‡ºç°åœ¨æ˜¾ç¤º exploration è€Œä¸æ˜¯ it_worksï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> adder v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/adder)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>59s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>adder<span class="token operator">-</span>92948b65e88960b4<span class="token punctuation">)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>exploration <span class="token punctuation">...</span> ok

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">1</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

   <span class="token class-name">Doc</span><span class="token operator">-</span>tests adder

running <span class="token number">0</span> tests

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

</code></pre></div><p>ç°åœ¨æˆ‘ä»¬å°†æ·»åŠ å¦ä¸€ä¸ªæµ‹è¯•ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¤±è´¥çš„æµ‹è¯•ï¼å½“æµ‹è¯•å‡½æ•°ä¸­çš„æŸäº›å†…å®¹å‘ç”Ÿ panic æ—¶ï¼Œæµ‹è¯•å°±ä¼šå¤±è´¥ã€‚æ¯ä¸ªæµ‹è¯•éƒ½åœ¨ä¸€ä¸ªæ–°çº¿ç¨‹ä¸­è¿è¡Œï¼Œå½“ä¸»çº¿ç¨‹çœ‹åˆ°æµ‹è¯•çº¿ç¨‹å·²æ­»äº¡æ—¶ï¼Œæµ‹è¯•è¢«æ ‡è®°ä¸ºå¤±è´¥ã€‚åœ¨ç¬¬ 9 ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†æœ€ç®€å•çš„ panic æ–¹å¼æ˜¯è°ƒç”¨ panic! å®ã€‚å°†æ–°æµ‹è¯•ä½œä¸ºåä¸º another çš„å‡½æ•°è¾“å…¥ï¼Œä½¿ä½ çš„ src/lib.rs æ–‡ä»¶çœ‹èµ·æ¥åƒç¤ºä¾‹ 11-3ã€‚</p> <p>æ–‡ä»¶åï¼šsrc/lib.rsï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span>left<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">,</span> right<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u64</span> <span class="token punctuation">{</span>
    left <span class="token operator">+</span> right
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">exploration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">another</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Make this test fail&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç¤ºä¾‹ 11-3ï¼šæ·»åŠ ç¬¬äºŒä¸ªæµ‹è¯•ï¼Œç”±äºæˆ‘ä»¬è°ƒç”¨äº† panic! å®è€Œå¤±è´¥</p> <p>å†æ¬¡ä½¿ç”¨ cargo test è¿è¡Œæµ‹è¯•ã€‚è¾“å‡ºåº”è¯¥å¦‚ç¤ºä¾‹ 11-4 æ‰€ç¤ºï¼Œè¡¨æ˜æˆ‘ä»¬çš„ exploration æµ‹è¯•é€šè¿‡ï¼Œanother æµ‹è¯•å¤±è´¥ã€‚</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> adder v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/adder)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>72s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>adder<span class="token operator">-</span>92948b65e88960b4<span class="token punctuation">)</span>

running <span class="token number">2</span> tests
test <span class="token namespace">tests<span class="token punctuation">::</span></span>another <span class="token punctuation">...</span> <span class="token constant">FAILED</span>
test <span class="token namespace">tests<span class="token punctuation">::</span></span>exploration <span class="token punctuation">...</span> ok

failures<span class="token punctuation">:</span>

<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token namespace">tests<span class="token punctuation">::</span></span>another stdout <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
thread <span class="token lifetime-annotation symbol">'tests</span><span class="token punctuation">::</span>another' panicked at src<span class="token operator">/</span>lib<span class="token punctuation">.</span>rs<span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span>
<span class="token class-name">Make</span> this test fail
note<span class="token punctuation">:</span> run with `<span class="token constant">RUST_BACKTRACE</span><span class="token operator">=</span><span class="token number">1</span>` environment variable to display a backtrace


failures<span class="token punctuation">:</span>
    <span class="token namespace">tests<span class="token punctuation">::</span></span>another

test result<span class="token punctuation">:</span> <span class="token constant">FAILED</span><span class="token punctuation">.</span> <span class="token number">1</span> passed<span class="token punctuation">;</span> <span class="token number">1</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

error<span class="token punctuation">:</span> test failed<span class="token punctuation">,</span> to rerun pass `<span class="token operator">-</span><span class="token operator">-</span>lib`
</code></pre></div><p>ç¤ºä¾‹ 11-4ï¼šä¸€ä¸ªæµ‹è¯•é€šè¿‡ä¸€ä¸ªæµ‹è¯•å¤±è´¥æ—¶çš„æµ‹è¯•ç»“æœ</p> <p>ä¸æ˜¯ okï¼Œtest tests::another è¡Œæ˜¾ç¤º FAILEDã€‚åœ¨å•ä¸ªç»“æœå’Œæ‘˜è¦ä¹‹é—´å‡ºç°äº†ä¸¤ä¸ªæ–°éƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†æ˜¾ç¤ºæ¯ä¸ªæµ‹è¯•å¤±è´¥çš„è¯¦ç»†åŸå› ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¾—åˆ°çš„è¯¦ç»†ä¿¡æ¯æ˜¯ another å¤±è´¥ï¼Œå› ä¸ºå®ƒåœ¨ src/lib.rs æ–‡ä»¶çš„ç¬¬ 17 è¡Œ panic äº†ï¼Œæ˜¾ç¤º 'Make this test fail'ã€‚ä¸‹ä¸€éƒ¨åˆ†ä»…åˆ—å‡ºæ‰€æœ‰å¤±è´¥æµ‹è¯•çš„åç§°ï¼Œå½“æœ‰å¾ˆå¤šæµ‹è¯•å’Œå¾ˆå¤šè¯¦ç»†çš„å¤±è´¥æµ‹è¯•è¾“å‡ºæ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤±è´¥æµ‹è¯•çš„åç§°åªè¿è¡Œè¯¥æµ‹è¯•ï¼Œä»¥ä¾¿æ›´å®¹æ˜“åœ°è°ƒè¯•å®ƒï¼›æˆ‘ä»¬å°†åœ¨&quot;æ§åˆ¶æµ‹è¯•å¦‚ä½•è¿è¡Œ&quot;éƒ¨åˆ†ä¸­è¯¦ç»†è®¨è®ºè¿è¡Œæµ‹è¯•çš„æ–¹æ³•ã€‚</p> <p>æ‘˜è¦è¡Œæ˜¾ç¤ºåœ¨æœ«å°¾ï¼šæ€»ä½“è€Œè¨€ï¼Œæˆ‘ä»¬çš„æµ‹è¯•ç»“æœæ˜¯ FAILEDã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæµ‹è¯•é€šè¿‡ï¼Œä¸€ä¸ªæµ‹è¯•å¤±è´¥ã€‚</p> <p>ç°åœ¨ä½ å·²ç»çœ‹åˆ°äº†ä¸åŒåœºæ™¯ä¸‹çš„æµ‹è¯•ç»“æœï¼Œè®©æˆ‘ä»¬çœ‹çœ‹é™¤äº† panic! ä¹‹å¤–åœ¨æµ‹è¯•ä¸­æœ‰ç”¨çš„ä¸€äº›å®ã€‚</p> <h3 id="ä½¿ç”¨-assert-å®æ£€æŸ¥ç»“æœ"><a href="#ä½¿ç”¨-assert-å®æ£€æŸ¥ç»“æœ" class="header-anchor">#</a> ä½¿ç”¨ <code>assert!</code> å®æ£€æŸ¥ç»“æœ</h3> <p>assert! å®ç”±æ ‡å‡†åº“æä¾›ï¼Œå½“ä½ æƒ³ç¡®ä¿æµ‹è¯•ä¸­çš„æŸäº›æ¡ä»¶è¯„ä¼°ä¸º true æ—¶å¾ˆæœ‰ç”¨ã€‚æˆ‘ä»¬ç»™ assert! å®ä¸€ä¸ªè®¡ç®—ä¸ºå¸ƒå°”å€¼çš„å‚æ•°ã€‚å¦‚æœå€¼ä¸º trueï¼Œåˆ™ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿï¼Œæµ‹è¯•é€šè¿‡ã€‚å¦‚æœå€¼ä¸º falseï¼Œassert! å®ä¼šè°ƒç”¨ panic! ä½¿æµ‹è¯•å¤±è´¥ã€‚ä½¿ç”¨ assert! å®å¸®åŠ©æˆ‘ä»¬æ£€æŸ¥ä»£ç æ˜¯å¦æŒ‰ç…§æˆ‘ä»¬çš„æ„å›¾è¿è¡Œã€‚</p> <p>åœ¨ç¬¬ 5 ç« çš„ç¤ºä¾‹ 5-15 ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Rectangle ç»“æ„ä½“å’Œ can_hold æ–¹æ³•ï¼Œè¿™é‡Œåœ¨ç¤ºä¾‹ 11-5 ä¸­é‡å¤ã€‚è®©æˆ‘ä»¬å°†è¿™æ®µä»£ç æ”¾å…¥ src/lib.rs æ–‡ä»¶ä¸­ï¼Œç„¶åä½¿ç”¨ assert! å®ä¸ºå®ƒç¼–å†™ä¸€äº›æµ‹è¯•ã€‚</p> <p>æ–‡ä»¶åï¼šsrc/lib.rsï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Rectangle</span> <span class="token punctuation">{</span>
    width<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Rectangle</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>width <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç¤ºä¾‹ 11-5ï¼šç¬¬ 5 ç« ä¸­çš„ Rectangle ç»“æ„ä½“åŠå…¶ can_hold æ–¹æ³•</p> <p>can_hold æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ assert! å®çš„å®Œç¾ç”¨ä¾‹ã€‚åœ¨ç¤ºä¾‹ 11-6 ä¸­ï¼Œæˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªæµ‹è¯•æ¥æµ‹è¯• can_hold æ–¹æ³•ï¼Œæ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªå®½åº¦ä¸º 8ã€é«˜åº¦ä¸º 7 çš„ Rectangle å®ä¾‹ï¼Œå¹¶æ–­è¨€å®ƒå¯ä»¥å®¹çº³å¦ä¸€ä¸ªå®½åº¦ä¸º 5ã€é«˜åº¦ä¸º 1 çš„ Rectangle å®ä¾‹ã€‚</p> <p>æ–‡ä»¶åï¼šsrc/lib.rsï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Rectangle</span> <span class="token punctuation">{</span>
    width<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Rectangle</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>width <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">larger_can_hold_smaller</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> larger <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> smaller <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token macro property">assert!</span><span class="token punctuation">(</span>larger<span class="token punctuation">.</span><span class="token function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>smaller<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç¤ºä¾‹ 11-6ï¼šæµ‹è¯• can_holdï¼Œæ£€æŸ¥ä¸€ä¸ªæ›´å¤§çš„çŸ©å½¢æ˜¯å¦ç¡®å®å¯ä»¥å®¹çº³ä¸€ä¸ªæ›´å°çš„çŸ©å½¢</p> <p>æ³¨æ„ tests æ¨¡å—å†…çš„ use super:ğŸ˜—; è¡Œã€‚tests æ¨¡å—æ˜¯ä¸€ä¸ªå¸¸è§„æ¨¡å—ï¼Œéµå¾ªæˆ‘ä»¬åœ¨ç¬¬ 7 ç« &quot;å¼•ç”¨æ¨¡å—æ ‘ä¸­é¡¹ç›®çš„è·¯å¾„&quot;éƒ¨åˆ†ä¸­ä»‹ç»çš„å¸¸è§„å¯è§æ€§è§„åˆ™ã€‚å› ä¸º tests æ¨¡å—æ˜¯ä¸€ä¸ªå†…éƒ¨æ¨¡å—ï¼Œæˆ‘ä»¬éœ€è¦å°†å¤–éƒ¨æ¨¡å—ä¸­çš„è¢«æµ‹è¯•ä»£ç å¼•å…¥å†…éƒ¨æ¨¡å—çš„ä½œç”¨åŸŸã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨é€šé…ç¬¦ï¼Œæ‰€ä»¥å¤–éƒ¨æ¨¡å—ä¸­å®šä¹‰çš„ä»»ä½•å†…å®¹éƒ½å¯ç”¨äºè¿™ä¸ª tests æ¨¡å—ã€‚</p> <p>æˆ‘ä»¬å°†æµ‹è¯•å‘½åä¸º larger_can_hold_smallerï¼Œå¹¶åˆ›å»ºäº†æˆ‘ä»¬éœ€è¦çš„ä¸¤ä¸ª Rectangle å®ä¾‹ã€‚ç„¶åæˆ‘ä»¬è°ƒç”¨ assert! å®å¹¶ä¼ é€’è°ƒç”¨ larger.can_hold(&amp;smaller) çš„ç»“æœã€‚è¿™ä¸ªè¡¨è¾¾å¼åº”è¯¥è¿”å› trueï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æµ‹è¯•åº”è¯¥é€šè¿‡ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ï¼</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> rectangle v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/rectangle)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>66s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>rectangle<span class="token operator">-</span>6584c4561e48942e<span class="token punctuation">)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>larger_can_hold_smaller <span class="token punctuation">...</span> ok

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">1</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

   <span class="token class-name">Doc</span><span class="token operator">-</span>tests rectangle

running <span class="token number">0</span> tests

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s
</code></pre></div><p>ç¡®å®é€šè¿‡äº†ï¼è®©æˆ‘ä»¬æ·»åŠ å¦ä¸€ä¸ªæµ‹è¯•ï¼Œè¿™æ¬¡æ–­è¨€ä¸€ä¸ªè¾ƒå°çš„çŸ©å½¢ä¸èƒ½å®¹çº³ä¸€ä¸ªè¾ƒå¤§çš„çŸ©å½¢ï¼š</p> <p>æ–‡ä»¶åï¼šsrc/lib.rsï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Rectangle</span> <span class="token punctuation">{</span>
    width<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Rectangle</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>width <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">larger_can_hold_smaller</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// --snip--</span>
        <span class="token keyword">let</span> larger <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> smaller <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token macro property">assert!</span><span class="token punctuation">(</span>larger<span class="token punctuation">.</span><span class="token function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>smaller<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">smaller_cannot_hold_larger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> larger <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> smaller <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token macro property">assert!</span><span class="token punctuation">(</span><span class="token operator">!</span>smaller<span class="token punctuation">.</span><span class="token function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>larger<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹ can_hold å‡½æ•°çš„æ­£ç¡®ç»“æœæ˜¯ falseï¼Œæˆ‘ä»¬éœ€è¦åœ¨å°†ç»“æœä¼ é€’ç»™ assert! å®ä¹‹å‰å¯¹å…¶å–åã€‚å› æ­¤ï¼Œå¦‚æœ can_hold è¿”å› falseï¼Œæˆ‘ä»¬çš„æµ‹è¯•å°†é€šè¿‡ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> rectangle v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/rectangle)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>66s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>rectangle<span class="token operator">-</span>6584c4561e48942e<span class="token punctuation">)</span>

running <span class="token number">2</span> tests
test <span class="token namespace">tests<span class="token punctuation">::</span></span>larger_can_hold_smaller <span class="token punctuation">...</span> ok
test <span class="token namespace">tests<span class="token punctuation">::</span></span>smaller_cannot_hold_larger <span class="token punctuation">...</span> ok

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">2</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

   <span class="token class-name">Doc</span><span class="token operator">-</span>tests rectangle

running <span class="token number">0</span> tests

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s
</code></pre></div><p>ä¸¤ä¸ªæµ‹è¯•éƒ½é€šè¿‡äº†ï¼ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å½“æˆ‘ä»¬åœ¨ä»£ç ä¸­å¼•å…¥ä¸€ä¸ª bug æ—¶ï¼Œæˆ‘ä»¬çš„æµ‹è¯•ç»“æœä¼šå‘ç”Ÿä»€ä¹ˆã€‚æˆ‘ä»¬å°†é€šè¿‡åœ¨æ¯”è¾ƒå®½åº¦æ—¶å°†å¤§äºå·æ›¿æ¢ä¸ºå°äºå·æ¥æ›´æ”¹ can_hold æ–¹æ³•çš„å®ç°ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Rectangle</span> <span class="token punctuation">{</span>
    width<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// --snip--</span>
<span class="token keyword">impl</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> other<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Rectangle</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>width <span class="token operator">&lt;</span> other<span class="token punctuation">.</span>width <span class="token operator">&amp;&amp;</span> <span class="token keyword">self</span><span class="token punctuation">.</span>height <span class="token operator">&gt;</span> other<span class="token punctuation">.</span>height
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">larger_can_hold_smaller</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> larger <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> smaller <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token macro property">assert!</span><span class="token punctuation">(</span>larger<span class="token punctuation">.</span><span class="token function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>smaller<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">smaller_cannot_hold_larger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> larger <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> smaller <span class="token operator">=</span> <span class="token class-name">Rectangle</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token macro property">assert!</span><span class="token punctuation">(</span><span class="token operator">!</span>smaller<span class="token punctuation">.</span><span class="token function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>larger<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨è¿è¡Œæµ‹è¯•ä¼šäº§ç”Ÿä»¥ä¸‹ç»“æœï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> rectangle v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/rectangle)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>66s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>rectangle<span class="token operator">-</span>6584c4561e48942e<span class="token punctuation">)</span>

running <span class="token number">2</span> tests
test <span class="token namespace">tests<span class="token punctuation">::</span></span>larger_can_hold_smaller <span class="token punctuation">...</span> <span class="token constant">FAILED</span>
test <span class="token namespace">tests<span class="token punctuation">::</span></span>smaller_cannot_hold_larger <span class="token punctuation">...</span> ok

failures<span class="token punctuation">:</span>

<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token namespace">tests<span class="token punctuation">::</span></span>larger_can_hold_smaller stdout <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
thread <span class="token lifetime-annotation symbol">'tests</span><span class="token punctuation">::</span>larger_can_hold_smaller' panicked at src<span class="token operator">/</span>lib<span class="token punctuation">.</span>rs<span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span>
assertion failed<span class="token punctuation">:</span> larger<span class="token punctuation">.</span><span class="token function">can_hold</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>smaller<span class="token punctuation">)</span>
note<span class="token punctuation">:</span> run with `<span class="token constant">RUST_BACKTRACE</span><span class="token operator">=</span><span class="token number">1</span>` environment variable to display a backtrace


failures<span class="token punctuation">:</span>
    <span class="token namespace">tests<span class="token punctuation">::</span></span>larger_can_hold_smaller

test result<span class="token punctuation">:</span> <span class="token constant">FAILED</span><span class="token punctuation">.</span> <span class="token number">1</span> passed<span class="token punctuation">;</span> <span class="token number">1</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

error<span class="token punctuation">:</span> test failed<span class="token punctuation">,</span> to rerun pass `<span class="token operator">-</span><span class="token operator">-</span>lib`
</code></pre></div><p>æˆ‘ä»¬çš„æµ‹è¯•æ•è·äº† bugï¼å› ä¸º larger.width æ˜¯ 8ï¼Œsmaller.width æ˜¯ 5ï¼Œcan_hold ä¸­å®½åº¦çš„æ¯”è¾ƒç°åœ¨è¿”å› falseï¼š8 ä¸å°äº 5ã€‚</p> <h3 id="ä½¿ç”¨-assert-eq-å’Œ-assert-ne-å®æµ‹è¯•ç›¸ç­‰æ€§"><a href="#ä½¿ç”¨-assert-eq-å’Œ-assert-ne-å®æµ‹è¯•ç›¸ç­‰æ€§" class="header-anchor">#</a> ä½¿ç”¨ assert_eq! å’Œ assert_ne! å®æµ‹è¯•ç›¸ç­‰æ€§</h3> <p>éªŒè¯åŠŸèƒ½çš„ä¸€ç§å¸¸è§æ–¹æ³•æ˜¯æµ‹è¯•ä»£ç æ‰§è¡Œç»“æœä¸é¢„æœŸè¿”å›å€¼ä¹‹é—´çš„ç›¸ç­‰æ€§ã€‚ä½ å¯ä»¥ä½¿ç”¨ assert! å®å¹¶ä¼ å…¥ä¸€ä¸ªä½¿ç”¨ == è¿ç®—ç¬¦çš„è¡¨è¾¾å¼æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ç„¶è€Œï¼Œè¿™ç§æµ‹è¯•éå¸¸å¸¸è§ï¼Œä»¥è‡³äºæ ‡å‡†åº“æä¾›äº†ä¸€å¯¹å®â€”â€” assert_eq! å’Œ assert_ne! â€”â€”æ¥æ›´æ–¹ä¾¿åœ°æ‰§è¡Œæ­¤æµ‹è¯•ã€‚è¿™äº›å®åˆ†åˆ«æ¯”è¾ƒä¸¤ä¸ªå‚æ•°çš„ç›¸ç­‰æ€§æˆ–ä¸ç›¸ç­‰æ€§ã€‚å¦‚æœæ–­è¨€å¤±è´¥ï¼Œå®ƒä»¬è¿˜ä¼šæ‰“å°å‡ºä¸¤ä¸ªå€¼ï¼Œè¿™ä½¿å¾—æ›´å®¹æ˜“çœ‹å‡ºæµ‹è¯•å¤±è´¥çš„åŸå› ï¼›ç›¸åï¼Œassert! å®åªè¡¨æ˜å®ƒå¾—åˆ°äº† == è¡¨è¾¾å¼çš„ false å€¼ï¼Œè€Œä¸æ‰“å°å¯¼è‡´ false å€¼çš„å€¼ã€‚</p> <p>åœ¨ç¤ºä¾‹ 11-7 ä¸­ï¼Œæˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªåä¸º add_two çš„å‡½æ•°ï¼Œå®ƒå°† 2 æ·»åŠ åˆ°å…¶å‚æ•°ä¸­ï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨ assert_eq! å®æµ‹è¯•è¿™ä¸ªå‡½æ•°ã€‚</p> <p>Filename: src/lib.rs:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">add_two</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">usize</span> <span class="token punctuation">{</span>
    a <span class="token operator">+</span> <span class="token number">2</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">it_adds_two</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">add_two</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç¤ºä¾‹ 11-7ï¼šä½¿ç”¨ assert_eq! å®æµ‹è¯•å‡½æ•° add_two</p> <p>è®©æˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯å¦é€šè¿‡ï¼</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> adder v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/adder)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>58s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>adder<span class="token operator">-</span>92948b65e88960b4<span class="token punctuation">)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>it_adds_two <span class="token punctuation">...</span> ok

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">1</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

   <span class="token class-name">Doc</span><span class="token operator">-</span>tests adder

running <span class="token number">0</span> tests

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s
</code></pre></div><p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º result çš„å˜é‡ï¼Œå®ƒä¿å­˜è°ƒç”¨ add_two(2) çš„ç»“æœã€‚ç„¶åæˆ‘ä»¬å°† result å’Œ 4 ä½œä¸ºå‚æ•°ä¼ é€’ç»™ assert_eq!ã€‚è¿™ä¸ªæµ‹è¯•çš„è¾“å‡ºè¡Œæ˜¯ test tests::it_adds_two ... okï¼Œok æ–‡æœ¬è¡¨ç¤ºæˆ‘ä»¬çš„æµ‹è¯•é€šè¿‡äº†ï¼</p> <p>è®©æˆ‘ä»¬åœ¨ä»£ç ä¸­å¼•å…¥ä¸€ä¸ªé”™è¯¯ï¼Œçœ‹çœ‹ assert_eq! åœ¨å¤±è´¥æ—¶æ˜¯ä»€ä¹ˆæ ·å­ã€‚å°† add_two å‡½æ•°çš„å®ç°æ”¹ä¸ºæ·»åŠ  3ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">add_two</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">usize</span> <span class="token punctuation">{</span>
    a <span class="token operator">+</span> <span class="token number">3</span>
<span class="token punctuation">}</span>

<span class="token comment">// #[cfg(test)]</span>
<span class="token comment">// mod tests {</span>
<span class="token comment">//     use super::*;</span>

<span class="token comment">//     #[test]</span>
<span class="token comment">//     fn it_adds_two() {</span>
<span class="token comment">//         let result = add_two(2);</span>
<span class="token comment">//         assert_eq!(result, 4);</span>
<span class="token comment">//     }</span>
<span class="token comment">// }</span>
</code></pre></div><p>å†æ¬¡è¿è¡Œæµ‹è¯•ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> adder v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/adder)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>61s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>adder<span class="token operator">-</span>92948b65e88960b4<span class="token punctuation">)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>it_adds_two <span class="token punctuation">...</span> <span class="token constant">FAILED</span>

failures<span class="token punctuation">:</span>

<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token namespace">tests<span class="token punctuation">::</span></span>it_adds_two stdout <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
thread <span class="token lifetime-annotation symbol">'tests</span><span class="token punctuation">::</span>it_adds_two' panicked at src<span class="token operator">/</span>lib<span class="token punctuation">.</span>rs<span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span>
assertion `left <span class="token operator">==</span> right` failed
  left<span class="token punctuation">:</span> <span class="token number">5</span>
 right<span class="token punctuation">:</span> <span class="token number">4</span>
note<span class="token punctuation">:</span> run with `<span class="token constant">RUST_BACKTRACE</span><span class="token operator">=</span><span class="token number">1</span>` environment variable to display a backtrace


failures<span class="token punctuation">:</span>
    <span class="token namespace">tests<span class="token punctuation">::</span></span>it_adds_two

test result<span class="token punctuation">:</span> <span class="token constant">FAILED</span><span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">1</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

error<span class="token punctuation">:</span> test failed<span class="token punctuation">,</span> to rerun pass `<span class="token operator">-</span><span class="token operator">-</span>lib`
</code></pre></div><p>æˆ‘ä»¬çš„æµ‹è¯•æ•è·äº†è¿™ä¸ªé”™è¯¯ï¼it_adds_two æµ‹è¯•å¤±è´¥äº†ï¼Œæ¶ˆæ¯å‘Šè¯‰æˆ‘ä»¬æ–­è¨€ <code>left == right</code> å¤±è´¥ï¼Œå¹¶æ˜¾ç¤ºäº†å·¦å€¼å’Œå³å€¼æ˜¯ä»€ä¹ˆã€‚è¿™ä¸ªæ¶ˆæ¯å¸®åŠ©æˆ‘ä»¬å¼€å§‹è°ƒè¯•ï¼šå·¦å‚æ•°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è°ƒç”¨ add_two(2) çš„ç»“æœï¼Œæ˜¯ 5ï¼Œä½†å³å‚æ•°æ˜¯ 4ã€‚å½“æˆ‘ä»¬æœ‰å¾ˆå¤šæµ‹è¯•åœ¨è¿›è¡Œæ—¶ï¼Œä½ å¯ä»¥æƒ³è±¡è¿™ä¼šç‰¹åˆ«æœ‰å¸®åŠ©ã€‚</p> <p>è¯·æ³¨æ„ï¼Œåœ¨æŸäº›è¯­è¨€å’Œæµ‹è¯•æ¡†æ¶ä¸­ï¼Œç›¸ç­‰æ€§æ–­è¨€å‡½æ•°çš„å‚æ•°è¢«ç§°ä¸º expected å’Œ actualï¼Œå‚æ•°çš„æŒ‡å®šé¡ºåºå¾ˆé‡è¦ã€‚ç„¶è€Œï¼Œåœ¨ Rust ä¸­ï¼Œå®ƒä»¬è¢«ç§°ä¸º left å’Œ rightï¼Œæˆ‘ä»¬æŒ‡å®šé¢„æœŸå€¼å’Œä»£ç äº§ç”Ÿçš„å€¼çš„é¡ºåºå¹¶ä¸é‡è¦ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæµ‹è¯•ä¸­å°†æ–­è¨€å†™ä¸º assert_eq!(4, result)ï¼Œè¿™å°†äº§ç”Ÿç›¸åŒçš„å¤±è´¥æ¶ˆæ¯ï¼Œæ˜¾ç¤ºæ–­è¨€å¤±è´¥ï¼š<code>(left == right)</code>ã€‚</p> <p>å¦‚æœæˆ‘ä»¬ç»™ assert_ne! å®çš„ä¸¤ä¸ªå€¼ä¸ç›¸ç­‰ï¼Œå®ƒå°±ä¼šé€šè¿‡ï¼›å¦‚æœå®ƒä»¬ç›¸ç­‰ï¼Œå®ƒå°±ä¼šå¤±è´¥ã€‚å½“æˆ‘ä»¬ä¸ç¡®å®šä¸€ä¸ªå€¼ä¼šæ˜¯ä»€ä¹ˆï¼Œä½†çŸ¥é“å®ƒç»å¯¹ä¸åº”è¯¥æ˜¯ä»€ä¹ˆæ—¶ï¼Œè¿™ä¸ªå®æœ€æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æµ‹è¯•ä¸€ä¸ªä¿è¯ä»¥æŸç§æ–¹å¼æ”¹å˜å…¶è¾“å…¥çš„å‡½æ•°ï¼Œä½†è¾“å…¥æ”¹å˜çš„æ–¹å¼å–å†³äºæˆ‘ä»¬è¿è¡Œæµ‹è¯•çš„æ˜ŸæœŸå‡ ï¼Œé‚£ä¹ˆæœ€å¥½çš„æ–­è¨€å¯èƒ½æ˜¯å‡½æ•°çš„è¾“å‡ºä¸ç­‰äºè¾“å…¥ã€‚</p> <p>åœ¨åº•å±‚ï¼Œassert_eq! å’Œ assert_ne! å®åˆ†åˆ«ä½¿ç”¨ == å’Œ != è¿ç®—ç¬¦ã€‚å½“æ–­è¨€å¤±è´¥æ—¶ï¼Œè¿™äº›å®ä½¿ç”¨è°ƒè¯•æ ¼å¼æ‰“å°å®ƒä»¬çš„å‚æ•°ï¼Œè¿™æ„å‘³ç€è¢«æ¯”è¾ƒçš„å€¼å¿…é¡»å®ç° PartialEq å’Œ Debug ç‰¹æ€§ã€‚æ‰€æœ‰åŸºæœ¬ç±»å‹å’Œå¤§å¤šæ•°æ ‡å‡†åº“ç±»å‹éƒ½å®ç°äº†è¿™äº›ç‰¹æ€§ã€‚å¯¹äºä½ è‡ªå·±å®šä¹‰çš„ç»“æ„ä½“å’Œæšä¸¾ï¼Œä½ éœ€è¦å®ç° PartialEq æ¥æ–­è¨€è¿™äº›ç±»å‹çš„ç›¸ç­‰æ€§ã€‚ä½ è¿˜éœ€è¦å®ç° Debug ä»¥ä¾¿åœ¨æ–­è¨€å¤±è´¥æ—¶æ‰“å°å€¼ã€‚å› ä¸ºè¿™ä¸¤ä¸ªç‰¹æ€§éƒ½æ˜¯å¯æ´¾ç”Ÿçš„ç‰¹æ€§ï¼Œå¦‚ç¬¬ 5 ç« çš„ç¤ºä¾‹ 5-12 ä¸­æ‰€è¿°ï¼Œè¿™é€šå¸¸åªéœ€è¦åœ¨ç»“æ„ä½“æˆ–æšä¸¾å®šä¹‰ä¸Šæ·»åŠ  #[derive(PartialEq, Debug)] æ³¨è§£å°±å¯ä»¥äº†ã€‚æœ‰å…³è¿™äº›å’Œå…¶ä»–å¯æ´¾ç”Ÿç‰¹æ€§çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§é™„å½• Cï¼Œ&quot;<a href="../appendix/appendix-c">å¯æ´¾ç”Ÿç‰¹æ€§</a>&quot;ã€‚</p> <h3 id="æ·»åŠ è‡ªå®šä¹‰å¤±è´¥æ¶ˆæ¯"><a href="#æ·»åŠ è‡ªå®šä¹‰å¤±è´¥æ¶ˆæ¯" class="header-anchor">#</a> æ·»åŠ è‡ªå®šä¹‰å¤±è´¥æ¶ˆæ¯</h3> <p>ä½ è¿˜å¯ä»¥å‘ assert!ã€assert_eq! å’Œ assert_ne! å®æ·»åŠ è‡ªå®šä¹‰æ¶ˆæ¯ï¼Œä½œä¸ºå¯é€‰å‚æ•°ä¸å¤±è´¥æ¶ˆæ¯ä¸€èµ·æ‰“å°ã€‚åœ¨å¿…éœ€å‚æ•°ä¹‹åæŒ‡å®šçš„ä»»ä½•å‚æ•°éƒ½ä¼šä¼ é€’ç»™ format! å®ï¼ˆåœ¨ç¬¬ 8 ç« çš„&quot;ä½¿ç”¨ + è¿ç®—ç¬¦æˆ– format! å®è¿›è¡Œè¿æ¥&quot;éƒ¨åˆ†ä¸­è®¨è®ºè¿‡ï¼‰ï¼Œå› æ­¤ä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªåŒ…å« {} å ä½ç¬¦çš„æ ¼å¼å­—ç¬¦ä¸²å’Œè¦æ”¾å…¥è¿™äº›å ä½ç¬¦çš„å€¼ã€‚è‡ªå®šä¹‰æ¶ˆæ¯å¯¹äºè®°å½•æ–­è¨€çš„å«ä¹‰å¾ˆæœ‰ç”¨ï¼›å½“æµ‹è¯•å¤±è´¥æ—¶ï¼Œä½ å°†æ›´å¥½åœ°äº†è§£ä»£ç ä¸­çš„é—®é¢˜æ‰€åœ¨ã€‚</p> <p>ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒé€šè¿‡åå­—å‘äººä»¬é—®å€™ï¼Œæˆ‘ä»¬æƒ³æµ‹è¯•æˆ‘ä»¬ä¼ å…¥å‡½æ•°çš„åå­—æ˜¯å¦å‡ºç°åœ¨è¾“å‡ºä¸­ï¼š</p> <p>Filename: src/lib.rs:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">greeting</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
    <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">&quot;Hello {name}!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">greeting_contains_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">greeting</span><span class="token punctuation">(</span><span class="token string">&quot;Carol&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">assert!</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;Carol&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™ä¸ªç¨‹åºçš„éœ€æ±‚è¿˜æ²¡æœ‰è¾¾æˆä¸€è‡´ï¼Œæˆ‘ä»¬å¾ˆç¡®å®šé—®å€™è¯­å¼€å¤´çš„ Hello æ–‡æœ¬å°†ä¼šæ”¹å˜ã€‚æˆ‘ä»¬å†³å®šä¸å¸Œæœ›åœ¨éœ€æ±‚å˜æ›´æ—¶å¿…é¡»æ›´æ–°æµ‹è¯•ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸æ£€æŸ¥ä» greeting å‡½æ•°è¿”å›çš„å€¼æ˜¯å¦å®Œå…¨ç›¸ç­‰ï¼Œè€Œåªæ˜¯æ–­è¨€è¾“å‡ºåŒ…å«è¾“å…¥å‚æ•°çš„æ–‡æœ¬ã€‚</p> <p>ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡æ›´æ”¹ greeting å‡½æ•°æ¥æ’é™¤åå­—ï¼Œçœ‹çœ‹é»˜è®¤çš„æµ‹è¯•å¤±è´¥æ˜¯ä»€ä¹ˆæ ·å­ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">greeting</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Hello!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// #[cfg(test)]</span>
<span class="token comment">// mod tests {</span>
<span class="token comment">//     use super::*;</span>

<span class="token comment">//     #[test]</span>
<span class="token comment">//     fn greeting_contains_name() {</span>
<span class="token comment">//         let result = greeting(&quot;Carol&quot;);</span>
<span class="token comment">//         assert!(result.contains(&quot;Carol&quot;));</span>
<span class="token comment">//     }</span>
<span class="token comment">// }</span>
</code></pre></div><p>è¿è¡Œè¿™ä¸ªæµ‹è¯•ä¼šäº§ç”Ÿä»¥ä¸‹ç»“æœï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> greeter v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/greeter)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>91s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>greeter<span class="token operator">-</span>170b942eb5bf5e3a<span class="token punctuation">)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>greeting_contains_name <span class="token punctuation">...</span> <span class="token constant">FAILED</span>

failures<span class="token punctuation">:</span>

<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token namespace">tests<span class="token punctuation">::</span></span>greeting_contains_name stdout <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
thread <span class="token lifetime-annotation symbol">'tests</span><span class="token punctuation">::</span>greeting_contains_name' panicked at src<span class="token operator">/</span>lib<span class="token punctuation">.</span>rs<span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span>
assertion failed<span class="token punctuation">:</span> result<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;Carol&quot;</span><span class="token punctuation">)</span>
note<span class="token punctuation">:</span> run with `<span class="token constant">RUST_BACKTRACE</span><span class="token operator">=</span><span class="token number">1</span>` environment variable to display a backtrace


failures<span class="token punctuation">:</span>
    <span class="token namespace">tests<span class="token punctuation">::</span></span>greeting_contains_name

test result<span class="token punctuation">:</span> <span class="token constant">FAILED</span><span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">1</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

error<span class="token punctuation">:</span> test failed<span class="token punctuation">,</span> to rerun pass `<span class="token operator">-</span><span class="token operator">-</span>lib`
</code></pre></div><p>è¿™ä¸ªç»“æœåªè¡¨æ˜æ–­è¨€å¤±è´¥äº†ï¼Œä»¥åŠæ–­è¨€åœ¨å“ªä¸€è¡Œã€‚æ›´æœ‰ç”¨çš„å¤±è´¥æ¶ˆæ¯ä¼šæ‰“å°å‡º greeting å‡½æ•°çš„å€¼ã€‚è®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰å¤±è´¥æ¶ˆæ¯ï¼Œç”±ä¸€ä¸ªæ ¼å¼å­—ç¬¦ä¸²ç»„æˆï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå ä½ç¬¦ï¼Œå¡«å…¥æˆ‘ä»¬ä» greeting å‡½æ•°å¾—åˆ°çš„å®é™…å€¼ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">greeting</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">String</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Hello!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">greeting_contains_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">greeting</span><span class="token punctuation">(</span><span class="token string">&quot;Carol&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token macro property">assert!</span><span class="token punctuation">(</span>
            result<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;Carol&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token string">&quot;Greeting did not contain name, value was `{result}`&quot;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨å½“æˆ‘ä»¬è¿è¡Œæµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªæ›´æœ‰ä¿¡æ¯é‡çš„é”™è¯¯æ¶ˆæ¯ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> greeter v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/greeter)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>93s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>greeter<span class="token operator">-</span>170b942eb5bf5e3a<span class="token punctuation">)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>greeting_contains_name <span class="token punctuation">...</span> <span class="token constant">FAILED</span>

failures<span class="token punctuation">:</span>

<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token namespace">tests<span class="token punctuation">::</span></span>greeting_contains_name stdout <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
thread <span class="token lifetime-annotation symbol">'tests</span><span class="token punctuation">::</span>greeting_contains_name' panicked at src<span class="token operator">/</span>lib<span class="token punctuation">.</span>rs<span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span>
<span class="token class-name">Greeting</span> did not contain name<span class="token punctuation">,</span> value was `<span class="token macro property">Hello!</span>`
note<span class="token punctuation">:</span> run with `<span class="token constant">RUST_BACKTRACE</span><span class="token operator">=</span><span class="token number">1</span>` environment variable to display a backtrace


failures<span class="token punctuation">:</span>
    <span class="token namespace">tests<span class="token punctuation">::</span></span>greeting_contains_name

test result<span class="token punctuation">:</span> <span class="token constant">FAILED</span><span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">1</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

error<span class="token punctuation">:</span> test failed<span class="token punctuation">,</span> to rerun pass `<span class="token operator">-</span><span class="token operator">-</span>lib`
</code></pre></div><p>æˆ‘ä»¬å¯ä»¥åœ¨æµ‹è¯•è¾“å‡ºä¸­çœ‹åˆ°æˆ‘ä»¬å®é™…å¾—åˆ°çš„å€¼ï¼Œè¿™å°†å¸®åŠ©æˆ‘ä»¬è°ƒè¯•å‘ç”Ÿäº†ä»€ä¹ˆï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æœŸæœ›å‘ç”Ÿçš„äº‹æƒ…ã€‚</p> <h3 id="ä½¿ç”¨-should-panic-æ£€æŸ¥-panic"><a href="#ä½¿ç”¨-should-panic-æ£€æŸ¥-panic" class="header-anchor">#</a> ä½¿ç”¨ should_panic æ£€æŸ¥ panic</h3> <p>é™¤äº†æ£€æŸ¥è¿”å›å€¼å¤–ï¼Œç¡®ä¿æˆ‘ä»¬çš„ä»£ç æŒ‰é¢„æœŸå¤„ç†é”™è¯¯æ¡ä»¶ä¹Ÿå¾ˆé‡è¦ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘æˆ‘ä»¬åœ¨ç¬¬ 9 ç« çš„ä»£ç ç¤ºä¾‹ 9-13 ä¸­åˆ›å»ºçš„ Guess ç±»å‹ã€‚ä½¿ç”¨ Guess çš„å…¶ä»–ä»£ç ä¾èµ–äº Guess å®ä¾‹åªåŒ…å« 1 åˆ° 100 ä¹‹é—´çš„å€¼çš„ä¿è¯ã€‚æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªæµ‹è¯•ï¼Œç¡®ä¿å°è¯•åˆ›å»ºä¸€ä¸ªå€¼è¶…å‡ºè¯¥èŒƒå›´çš„ Guess å®ä¾‹ä¼šå¯¼è‡´ panicã€‚</p> <p>æˆ‘ä»¬é€šè¿‡åœ¨æµ‹è¯•å‡½æ•°ä¸Šæ·»åŠ  should_panic å±æ€§æ¥å®ç°è¿™ä¸€ç‚¹ã€‚å¦‚æœå‡½æ•°å†…çš„ä»£ç å‘ç”Ÿ panicï¼Œæµ‹è¯•å°±é€šè¿‡ï¼›å¦‚æœå‡½æ•°å†…çš„ä»£ç æ²¡æœ‰ panicï¼Œæµ‹è¯•å°±å¤±è´¥ã€‚</p> <p>ä»£ç ç¤ºä¾‹ 11-8 å±•ç¤ºäº†ä¸€ä¸ªæµ‹è¯•ï¼Œç”¨äºæ£€æŸ¥ Guess::new çš„é”™è¯¯æ¡ä»¶æ˜¯å¦åœ¨æˆ‘ä»¬é¢„æœŸçš„æƒ…å†µä¸‹å‘ç”Ÿã€‚</p> <p>Filename: src/lib.rs:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Guess</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> value <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> value <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token punctuation">{</span>
            <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Guess value must be between 1 and 100, got {value}.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Guess</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token attribute attr-name">#[should_panic]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">greater_than_100</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Guess</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä»£ç ç¤ºä¾‹ 11-8ï¼šæµ‹è¯•æŸä¸ªæ¡ä»¶ä¼šå¯¼è‡´ panic!</p> <p>æˆ‘ä»¬å°† <code>#[should_panic]</code> å±æ€§æ”¾åœ¨ <code>#[test]</code> å±æ€§ä¹‹åï¼Œå¹¶åœ¨å®ƒæ‰€é€‚ç”¨çš„æµ‹è¯•å‡½æ•°ä¹‹å‰ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªæµ‹è¯•é€šè¿‡æ—¶çš„ç»“æœï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> guessing_game v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/guessing_game)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>58s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>guessing_game<span class="token operator">-</span>57d70c3acb738f4d<span class="token punctuation">)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>greater_than_100 <span class="token operator">-</span> should panic <span class="token punctuation">...</span> ok

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">1</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

   <span class="token class-name">Doc</span><span class="token operator">-</span>tests guessing_game

running <span class="token number">0</span> tests

test result<span class="token punctuation">:</span> ok<span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">0</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s
</code></pre></div><p>çœ‹èµ·æ¥ä¸é”™ï¼ç°åœ¨è®©æˆ‘ä»¬åœ¨ä»£ç ä¸­å¼•å…¥ä¸€ä¸ª bugï¼Œç§»é™¤ new å‡½æ•°åœ¨å€¼å¤§äº 100 æ—¶ä¼š panic çš„æ¡ä»¶ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Guess</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// --snip--</span>
<span class="token keyword">impl</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> value <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token punctuation">{</span>
            <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Guess value must be between 1 and 100, got {value}.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Guess</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// #[cfg(test)]</span>
<span class="token comment">// mod tests {</span>
<span class="token comment">//     use super::*;</span>

<span class="token comment">//     #[test]</span>
<span class="token comment">//     #[should_panic]</span>
<span class="token comment">//     fn greater_than_100() {</span>
<span class="token comment">//         Guess::new(200);</span>
<span class="token comment">//     }</span>
<span class="token comment">// }</span>
</code></pre></div><p>å½“æˆ‘ä»¬è¿è¡Œä»£ç ç¤ºä¾‹ 11-8 ä¸­çš„æµ‹è¯•æ—¶ï¼Œå®ƒä¼šå¤±è´¥ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> guessing_game v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/guessing_game)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>62s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>guessing_game<span class="token operator">-</span>57d70c3acb738f4d<span class="token punctuation">)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>greater_than_100 <span class="token operator">-</span> should panic <span class="token punctuation">...</span> <span class="token constant">FAILED</span>

failures<span class="token punctuation">:</span>

<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token namespace">tests<span class="token punctuation">::</span></span>greater_than_100 stdout <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
note<span class="token punctuation">:</span> test did not panic <span class="token keyword">as</span> expected

failures<span class="token punctuation">:</span>
    <span class="token namespace">tests<span class="token punctuation">::</span></span>greater_than_100

test result<span class="token punctuation">:</span> <span class="token constant">FAILED</span><span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">1</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

error<span class="token punctuation">:</span> test failed<span class="token punctuation">,</span> to rerun pass `<span class="token operator">-</span><span class="token operator">-</span>lib`
</code></pre></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ²¡æœ‰å¾—åˆ°éå¸¸æœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯å½“æˆ‘ä»¬æŸ¥çœ‹æµ‹è¯•å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°å®ƒè¢«æ ‡æ³¨ä¸º <code>#[should_panic]</code>ã€‚æˆ‘ä»¬å¾—åˆ°çš„å¤±è´¥æ„å‘³ç€æµ‹è¯•å‡½æ•°ä¸­çš„ä»£ç æ²¡æœ‰å¼•èµ· panicã€‚</p> <p>ä½¿ç”¨ should_panic çš„æµ‹è¯•å¯èƒ½ä¸å¤Ÿç²¾ç¡®ã€‚å³ä½¿æµ‹è¯•å› ä¸ºæˆ‘ä»¬é¢„æœŸä¹‹å¤–çš„åŸå› è€Œ panicï¼Œshould_panic æµ‹è¯•ä¹Ÿä¼šé€šè¿‡ã€‚ä¸ºäº†ä½¿ should_panic æµ‹è¯•æ›´ç²¾ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ should_panic å±æ€§ä¸­æ·»åŠ ä¸€ä¸ªå¯é€‰çš„ expected å‚æ•°ã€‚æµ‹è¯•å·¥å…·å°†ç¡®ä¿å¤±è´¥æ¶ˆæ¯åŒ…å«æ‰€æä¾›çš„æ–‡æœ¬ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä»£ç ç¤ºä¾‹ 11-9 ä¸­ Guess çš„ä¿®æ”¹ä»£ç ï¼Œå…¶ä¸­ new å‡½æ•°æ ¹æ®å€¼æ˜¯å¤ªå°è¿˜æ˜¯å¤ªå¤§è€Œä½¿ç”¨ä¸åŒçš„æ¶ˆæ¯è¿›è¡Œ panicã€‚</p> <p>Filename: src/lib.rs:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Guess</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// --snip--</span>

<span class="token keyword">impl</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> value <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token punctuation">{</span>
            <span class="token macro property">panic!</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Guess value must be greater than or equal to 1, got {value}.&quot;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> value <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token punctuation">{</span>
            <span class="token macro property">panic!</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Guess value must be less than or equal to 100, got {value}.&quot;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Guess</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token attribute attr-name">#[should_panic(expected = <span class="token string">&quot;less than or equal to 100&quot;</span>)]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">greater_than_100</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Guess</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä»£ç ç¤ºä¾‹ 11-9ï¼šä½¿ç”¨åŒ…å«æŒ‡å®šå­å­—ç¬¦ä¸²çš„ panic! æ¶ˆæ¯è¿›è¡Œæµ‹è¯•</p> <p>è¿™ä¸ªæµ‹è¯•å°†é€šè¿‡ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ should_panic å±æ€§çš„ expected å‚æ•°ä¸­æ”¾ç½®çš„å€¼æ˜¯ Guess::new å‡½æ•° panic æ¶ˆæ¯çš„å­å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å¯ä»¥æŒ‡å®šæˆ‘ä»¬æœŸæœ›çš„æ•´ä¸ª panic æ¶ˆæ¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å°†æ˜¯ Guess value must be less than or equal to 100, got 200ã€‚ä½ é€‰æ‹©æŒ‡å®šçš„å†…å®¹å–å†³äº panic æ¶ˆæ¯ä¸­æœ‰å¤šå°‘æ˜¯å”¯ä¸€çš„æˆ–åŠ¨æ€çš„ï¼Œä»¥åŠä½ å¸Œæœ›æµ‹è¯•æœ‰å¤šç²¾ç¡®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œpanic æ¶ˆæ¯çš„å­å­—ç¬¦ä¸²è¶³ä»¥ç¡®ä¿æµ‹è¯•å‡½æ•°ä¸­çš„ä»£ç æ‰§è¡Œ else if value &gt; 100 åˆ†æ”¯ã€‚</p> <p>ä¸ºäº†çœ‹çœ‹å½“å¸¦æœ‰é¢„æœŸæ¶ˆæ¯çš„ should_panic æµ‹è¯•å¤±è´¥æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œè®©æˆ‘ä»¬å†æ¬¡é€šè¿‡äº¤æ¢ if value &lt; 1 å’Œ else if value &gt; 100 å—çš„ä¸»ä½“åœ¨ä»£ç ä¸­å¼•å…¥ä¸€ä¸ª bugï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Guess</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> value <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token punctuation">{</span>
            <span class="token macro property">panic!</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Guess value must be less than or equal to 100, got {value}.&quot;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> value <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token punctuation">{</span>
            <span class="token macro property">panic!</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Guess value must be greater than or equal to 1, got {value}.&quot;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Guess</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token attribute attr-name">#[should_panic(expected = <span class="token string">&quot;less than or equal to 100&quot;</span>)]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">greater_than_100</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Guess</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™æ¬¡å½“æˆ‘ä»¬è¿è¡Œ should_panic æµ‹è¯•æ—¶ï¼Œå®ƒå°†å¤±è´¥ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>$ cargo test
   <span class="token class-name">Compiling</span> guessing_game v0<span class="token number">.1</span><span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span><span class="token operator">/</span><span class="token comment">//projects/guessing_game)</span>
    <span class="token class-name">Finished</span> `test` profile <span class="token punctuation">[</span>unoptimized <span class="token operator">+</span> debuginfo<span class="token punctuation">]</span> <span class="token function">target</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>66s
     <span class="token class-name">Running</span> unittests src<span class="token operator">/</span>lib<span class="token punctuation">.</span><span class="token function">rs</span> <span class="token punctuation">(</span>target<span class="token operator">/</span>debug<span class="token operator">/</span>deps<span class="token operator">/</span>guessing_game<span class="token operator">-</span>57d70c3acb738f4d<span class="token punctuation">)</span>

running <span class="token number">1</span> test
test <span class="token namespace">tests<span class="token punctuation">::</span></span>greater_than_100 <span class="token operator">-</span> should panic <span class="token punctuation">...</span> <span class="token constant">FAILED</span>

failures<span class="token punctuation">:</span>

<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token namespace">tests<span class="token punctuation">::</span></span>greater_than_100 stdout <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
thread <span class="token lifetime-annotation symbol">'tests</span><span class="token punctuation">::</span>greater_than_100' panicked at src<span class="token operator">/</span>lib<span class="token punctuation">.</span>rs<span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">:</span>
<span class="token class-name">Guess</span> value must be greater than or equal to <span class="token number">1</span><span class="token punctuation">,</span> got <span class="token number">200</span><span class="token punctuation">.</span>
note<span class="token punctuation">:</span> run with `<span class="token constant">RUST_BACKTRACE</span><span class="token operator">=</span><span class="token number">1</span>` environment variable to display a backtrace
note<span class="token punctuation">:</span> panic did not contain expected string
      panic message<span class="token punctuation">:</span> `<span class="token string">&quot;Guess value must be greater than or equal to 1, got 200.&quot;</span>`<span class="token punctuation">,</span>
 expected substring<span class="token punctuation">:</span> `<span class="token string">&quot;less than or equal to 100&quot;</span>`

failures<span class="token punctuation">:</span>
    <span class="token namespace">tests<span class="token punctuation">::</span></span>greater_than_100

test result<span class="token punctuation">:</span> <span class="token constant">FAILED</span><span class="token punctuation">.</span> <span class="token number">0</span> passed<span class="token punctuation">;</span> <span class="token number">1</span> failed<span class="token punctuation">;</span> <span class="token number">0</span> ignored<span class="token punctuation">;</span> <span class="token number">0</span> measured<span class="token punctuation">;</span> <span class="token number">0</span> filtered out<span class="token punctuation">;</span> finished <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">.</span>00s

error<span class="token punctuation">:</span> test failed<span class="token punctuation">,</span> to rerun pass `<span class="token operator">-</span><span class="token operator">-</span>lib`
</code></pre></div><h3 id="åœ¨æµ‹è¯•ä¸­ä½¿ç”¨-result-t-e"><a href="#åœ¨æµ‹è¯•ä¸­ä½¿ç”¨-result-t-e" class="header-anchor">#</a> åœ¨æµ‹è¯•ä¸­ä½¿ç”¨ <code>Result&lt;T, E&gt;</code></h3> <p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„æµ‹è¯•åœ¨å¤±è´¥æ—¶éƒ½ä¼š panicã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>Result&lt;T, E&gt;</code> ç¼–å†™æµ‹è¯•ï¼è¿™é‡Œæ˜¯ä»£ç ç¤ºä¾‹ 11-1 ä¸­çš„æµ‹è¯•ï¼Œé‡å†™ä¸ºä½¿ç”¨ <code>Result&lt;T, E&gt;</code> å¹¶åœ¨ panic æ—¶è¿”å› Errï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">add</span><span class="token punctuation">(</span>left<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">,</span> right<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">u64</span> <span class="token punctuation">{</span>
    left <span class="token operator">+</span> right
<span class="token punctuation">}</span>

<span class="token attribute attr-name">#[cfg(test)]</span>
<span class="token keyword">mod</span> <span class="token module-declaration namespace">tests</span> <span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token keyword">super</span><span class="token punctuation">::</span><span class="token operator">*</span><span class="token punctuation">;</span>

    <span class="token attribute attr-name">#[test]</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">it_works</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> result <span class="token operator">==</span> <span class="token number">4</span> <span class="token punctuation">{</span>
            <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;two plus two does not equal four&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>it_works å‡½æ•°ç°åœ¨æœ‰ <code>Result&lt;(), String&gt;</code> è¿”å›ç±»å‹ã€‚åœ¨å‡½æ•°ä½“ä¸­ï¼Œæˆ‘ä»¬ä¸å†è°ƒç”¨ assert_eq! å®ï¼Œè€Œæ˜¯åœ¨æµ‹è¯•é€šè¿‡æ—¶è¿”å› <code>Ok(())</code>ï¼Œåœ¨æµ‹è¯•å¤±è´¥æ—¶è¿”å›å¸¦æœ‰ <code>String</code> çš„ Errã€‚</p> <p>ç¼–å†™è¿”å› <code>Result&lt;T, E&gt;</code> çš„æµ‹è¯•ä½¿ä½ èƒ½å¤Ÿåœ¨æµ‹è¯•ä½“ä¸­ä½¿ç”¨é—®å·è¿ç®—ç¬¦ï¼Œè¿™å¯ä»¥æ˜¯ç¼–å†™åº”è¯¥åœ¨å…¶ä¸­çš„ä»»ä½•æ“ä½œè¿”å› <code>Err</code> å˜ä½“æ—¶å¤±è´¥çš„æµ‹è¯•çš„ä¾¿æ·æ–¹å¼ã€‚</p> <p>ä½ ä¸èƒ½åœ¨ä½¿ç”¨ <code>Result&lt;T, E&gt;</code> çš„æµ‹è¯•ä¸Šä½¿ç”¨ <code>#[should_panic]</code> æ³¨è§£ã€‚è¦æ–­è¨€ä¸€ä¸ªæ“ä½œè¿”å› <code>Err</code> å˜ä½“ï¼Œä¸è¦åœ¨ <code>Result&lt;T, E&gt;</code> å€¼ä¸Šä½¿ç”¨é—®å·è¿ç®—ç¬¦ã€‚ç›¸åï¼Œä½¿ç”¨ <code>assert!(value.is_err())</code>ã€‚</p> <p>ç°åœ¨ä½ çŸ¥é“äº†å‡ ç§ç¼–å†™æµ‹è¯•çš„æ–¹æ³•ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿è¡Œæµ‹è¯•æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¹¶æ¢ç´¢æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>cargo test</code> çš„ä¸åŒé€‰é¡¹ã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/rust-doc/doc/generics/lifetime-syntax.html" class="prev">
        ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸéªŒè¯å¼•ç”¨
      </a></span> <span class="next"><a href="/rust-doc/doc/testing/running-tests.html">
        è¿è¡Œæµ‹è¯•
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/rust-doc/assets/js/app.858f10df.js" defer></script><script src="/rust-doc/assets/js/2.d1f3a877.js" defer></script><script src="/rust-doc/assets/js/1.169debde.js" defer></script><script src="/rust-doc/assets/js/107.b904cd96.js" defer></script>
  </body>
</html>
