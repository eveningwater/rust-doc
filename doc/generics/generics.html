<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>泛型类型、特性和生命周期 | rust语言中文文档</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/rust-doc/logo.svg">
    <script type="text/javascript" src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
    <meta name="description" content="一门赋予每个人构建可靠且高效软件能力的语言。">
    
    <link rel="preload" href="/rust-doc/assets/css/0.styles.b04b0b2c.css" as="style"><link rel="preload" href="/rust-doc/assets/js/app.9135f27f.js" as="script"><link rel="preload" href="/rust-doc/assets/js/2.7165f438.js" as="script"><link rel="preload" href="/rust-doc/assets/js/1.8bad1a83.js" as="script"><link rel="preload" href="/rust-doc/assets/js/70.85b1bf80.js" as="script"><link rel="prefetch" href="/rust-doc/assets/js/10.c8f5cd28.js"><link rel="prefetch" href="/rust-doc/assets/js/11.8ce27df2.js"><link rel="prefetch" href="/rust-doc/assets/js/12.96898821.js"><link rel="prefetch" href="/rust-doc/assets/js/13.39e41d2a.js"><link rel="prefetch" href="/rust-doc/assets/js/14.8725e389.js"><link rel="prefetch" href="/rust-doc/assets/js/15.de59edd3.js"><link rel="prefetch" href="/rust-doc/assets/js/16.10bba030.js"><link rel="prefetch" href="/rust-doc/assets/js/17.c5b77720.js"><link rel="prefetch" href="/rust-doc/assets/js/18.967f6c8c.js"><link rel="prefetch" href="/rust-doc/assets/js/19.a7cf824e.js"><link rel="prefetch" href="/rust-doc/assets/js/20.6d69020f.js"><link rel="prefetch" href="/rust-doc/assets/js/21.3a09bd63.js"><link rel="prefetch" href="/rust-doc/assets/js/22.91c743ce.js"><link rel="prefetch" href="/rust-doc/assets/js/23.f22b7556.js"><link rel="prefetch" href="/rust-doc/assets/js/24.73f13312.js"><link rel="prefetch" href="/rust-doc/assets/js/25.80eff17a.js"><link rel="prefetch" href="/rust-doc/assets/js/26.b0c77d43.js"><link rel="prefetch" href="/rust-doc/assets/js/27.616cb46d.js"><link rel="prefetch" href="/rust-doc/assets/js/28.1d0fcbc9.js"><link rel="prefetch" href="/rust-doc/assets/js/29.f2656be5.js"><link rel="prefetch" href="/rust-doc/assets/js/3.164521c5.js"><link rel="prefetch" href="/rust-doc/assets/js/30.567af70a.js"><link rel="prefetch" href="/rust-doc/assets/js/31.16dedfcd.js"><link rel="prefetch" href="/rust-doc/assets/js/32.524b959f.js"><link rel="prefetch" href="/rust-doc/assets/js/33.0663618d.js"><link rel="prefetch" href="/rust-doc/assets/js/34.d078caff.js"><link rel="prefetch" href="/rust-doc/assets/js/35.3d10faaf.js"><link rel="prefetch" href="/rust-doc/assets/js/36.a5fcbb3c.js"><link rel="prefetch" href="/rust-doc/assets/js/37.3002fd60.js"><link rel="prefetch" href="/rust-doc/assets/js/38.aec91a5e.js"><link rel="prefetch" href="/rust-doc/assets/js/39.752d916e.js"><link rel="prefetch" href="/rust-doc/assets/js/4.6585d887.js"><link rel="prefetch" href="/rust-doc/assets/js/40.8e6bfec6.js"><link rel="prefetch" href="/rust-doc/assets/js/41.f8ac98d6.js"><link rel="prefetch" href="/rust-doc/assets/js/42.ff911013.js"><link rel="prefetch" href="/rust-doc/assets/js/43.263332dc.js"><link rel="prefetch" href="/rust-doc/assets/js/44.9715d8c3.js"><link rel="prefetch" href="/rust-doc/assets/js/45.88df62b9.js"><link rel="prefetch" href="/rust-doc/assets/js/46.6923c115.js"><link rel="prefetch" href="/rust-doc/assets/js/47.2d9ccfcb.js"><link rel="prefetch" href="/rust-doc/assets/js/48.4aafe2b4.js"><link rel="prefetch" href="/rust-doc/assets/js/49.a781ca58.js"><link rel="prefetch" href="/rust-doc/assets/js/5.d4de79ae.js"><link rel="prefetch" href="/rust-doc/assets/js/50.b0e670cf.js"><link rel="prefetch" href="/rust-doc/assets/js/51.0a3dab95.js"><link rel="prefetch" href="/rust-doc/assets/js/52.3d0da43f.js"><link rel="prefetch" href="/rust-doc/assets/js/53.cdab1013.js"><link rel="prefetch" href="/rust-doc/assets/js/54.b06afc44.js"><link rel="prefetch" href="/rust-doc/assets/js/55.492f05fb.js"><link rel="prefetch" href="/rust-doc/assets/js/56.dd1321b8.js"><link rel="prefetch" href="/rust-doc/assets/js/57.376c404d.js"><link rel="prefetch" href="/rust-doc/assets/js/58.e298072c.js"><link rel="prefetch" href="/rust-doc/assets/js/59.b9e5e8ab.js"><link rel="prefetch" href="/rust-doc/assets/js/6.d46d4bde.js"><link rel="prefetch" href="/rust-doc/assets/js/60.10295088.js"><link rel="prefetch" href="/rust-doc/assets/js/61.cbcafd3b.js"><link rel="prefetch" href="/rust-doc/assets/js/62.d4416d5c.js"><link rel="prefetch" href="/rust-doc/assets/js/63.1e7f096a.js"><link rel="prefetch" href="/rust-doc/assets/js/64.f80785bd.js"><link rel="prefetch" href="/rust-doc/assets/js/65.80f9ffdd.js"><link rel="prefetch" href="/rust-doc/assets/js/66.fb7183f9.js"><link rel="prefetch" href="/rust-doc/assets/js/67.b18b0978.js"><link rel="prefetch" href="/rust-doc/assets/js/68.d1537054.js"><link rel="prefetch" href="/rust-doc/assets/js/69.75b1323b.js"><link rel="prefetch" href="/rust-doc/assets/js/7.b1a040fe.js"><link rel="prefetch" href="/rust-doc/assets/js/71.f4b55946.js"><link rel="prefetch" href="/rust-doc/assets/js/72.7a07f580.js"><link rel="prefetch" href="/rust-doc/assets/js/73.1acb9757.js"><link rel="prefetch" href="/rust-doc/assets/js/74.4b85e688.js"><link rel="prefetch" href="/rust-doc/assets/js/75.85de7e98.js"><link rel="prefetch" href="/rust-doc/assets/js/76.361e96b7.js"><link rel="prefetch" href="/rust-doc/assets/js/77.e7702f81.js"><link rel="prefetch" href="/rust-doc/assets/js/78.c641d16e.js"><link rel="prefetch" href="/rust-doc/assets/js/79.e0d19d50.js"><link rel="prefetch" href="/rust-doc/assets/js/80.1736b699.js"><link rel="prefetch" href="/rust-doc/assets/js/81.6e2f0d1d.js"><link rel="prefetch" href="/rust-doc/assets/js/82.f2e5b403.js"><link rel="prefetch" href="/rust-doc/assets/js/83.bebaa7a4.js"><link rel="prefetch" href="/rust-doc/assets/js/84.81f39f75.js"><link rel="prefetch" href="/rust-doc/assets/js/85.8728f2a2.js"><link rel="prefetch" href="/rust-doc/assets/js/86.3681ed19.js"><link rel="prefetch" href="/rust-doc/assets/js/87.bae48dd4.js"><link rel="prefetch" href="/rust-doc/assets/js/88.77f88b84.js"><link rel="prefetch" href="/rust-doc/assets/js/89.64aaf90d.js"><link rel="prefetch" href="/rust-doc/assets/js/90.683e19a1.js"><link rel="prefetch" href="/rust-doc/assets/js/91.5f319121.js"><link rel="prefetch" href="/rust-doc/assets/js/92.28fa92cc.js"><link rel="prefetch" href="/rust-doc/assets/js/93.9433c644.js"><link rel="prefetch" href="/rust-doc/assets/js/94.f5dd2ea5.js"><link rel="prefetch" href="/rust-doc/assets/js/95.f6fee665.js"><link rel="prefetch" href="/rust-doc/assets/js/96.effb5fff.js"><link rel="prefetch" href="/rust-doc/assets/js/97.afa2243f.js"><link rel="prefetch" href="/rust-doc/assets/js/vendors~docsearch.f02eae5a.js">
    <link rel="stylesheet" href="/rust-doc/assets/css/0.styles.b04b0b2c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/rust-doc/" class="home-link router-link-active"><!----> <span class="site-name">rust语言中文文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/rust-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/eveningwater/rust-doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/eveningwater" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/rust-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/eveningwater/rust-doc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/eveningwater" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/rust-doc/doc/introduce/introduce.html" class="sidebar-link">Rust介绍</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/getting-started/getting-started" class="sidebar-heading clickable"><span>入门</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/rust-doc/doc/guess-game/guess-game.html" class="sidebar-link">猜一猜游戏</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/common-concept/common-concept" class="sidebar-heading clickable"><span>常用的编程概念</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/understand-ownership/understand-ownership" class="sidebar-heading clickable"><span>认识所有权</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/structs/structs" class="sidebar-heading clickable"><span>使用结构体来构造相关数据</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/enums/enums" class="sidebar-heading clickable"><span>枚举</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/packages-crates-and-modules/packages-crates-and-modules" class="sidebar-heading clickable"><span>使用包、依赖箱和模块管理不断增长的项目</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/common-collections/common-collections" class="sidebar-heading clickable"><span>常用集合</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/error-handling/error-handling" class="sidebar-heading clickable"><span>错误处理</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/generics/generics" class="sidebar-heading clickable open active"><span>泛型类型、特性和生命周期</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/rust-doc/doc/generics/generic-syntax.html" class="sidebar-link">泛型数据类型</a></li><li><a href="/rust-doc/doc/generics/traits.html" class="sidebar-link">特性（Traits）：定义共享行为</a></li><li><a href="/rust-doc/doc/generics/lifetime-syntax.html" class="sidebar-link">使用生命周期验证引用</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/testing/testing" class="sidebar-heading clickable"><span>测试</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/an-io-project/an-io-project" class="sidebar-heading clickable"><span>I/O 项目：构建命令行程序</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/functional-features/functional-features" class="sidebar-heading clickable"><span>函数式语言特性：迭代器与闭包</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/more-about-cargo/more-about-cargo" class="sidebar-heading clickable"><span>关于 Cargo 和 Crates.io 的更多信息</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/rust-doc/doc/smart-pointers/smart-pointers" class="sidebar-heading clickable"><span>智能指针</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>附录</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="泛型类型、特性和生命周期"><a href="#泛型类型、特性和生命周期" class="header-anchor">#</a> 泛型类型、特性和生命周期</h2> <p>每种编程语言都有工具来有效处理概念的重复。在Rust中，其中一种工具是泛型：具体类型或其他属性的抽象替代品。我们可以表达泛型的行为或它们如何相互关联，而无需知道在编译和运行代码时它们将被什么替代。</p> <p>函数可以接受某种泛型类型的参数，而不是像i32或String这样的具体类型，就像它们接受未知值的参数来对多个具体值运行相同的代码一样。事实上，我们已经在第6章中使用了<code>Option&lt;T&gt;</code>，在第8章中使用了<code>Vec&lt;T&gt;</code>和<code>HashMap&lt;K, V&gt;</code>，以及在第9章中使用了<code>Result&lt;T, E&gt;</code>。在本章中，你将探索如何定义自己的类型、函数和方法与泛型！</p> <p>首先，我们将回顾如何提取函数以减少代码重复。然后，我们将使用相同的技术从两个仅在参数类型上不同的函数中创建一个泛型函数。我们还将解释如何在结构体和枚举定义中使用泛型类型。</p> <p>然后，你将学习如何以泛型方式使用特性来定义行为。你可以将特性与泛型类型结合起来，限制泛型类型只接受具有特定行为的类型，而不是任何类型。</p> <p>最后，我们将讨论生命周期：一种泛型，它为编译器提供关于引用如何相互关联的信息。生命周期允许我们给编译器提供足够的关于借用值的信息，以便它可以确保引用在更多情况下有效，而不是没有我们的帮助。</p> <h3 id="通过提取函数消除重复"><a href="#通过提取函数消除重复" class="header-anchor">#</a> 通过提取函数消除重复</h3> <p>泛型允许我们用代表多种类型的占位符替换特定类型，以消除代码重复。在深入研究泛型语法之前，让我们首先看看如何通过提取函数来消除重复，这种方式不涉及泛型类型，而是用代表多个值的占位符替换特定值。然后，我们将应用相同的技术来提取泛型函数！通过了解如何识别可以提取到函数中的重复代码，你将开始识别可以使用泛型的重复代码。</p> <p>我们将从示例10-1中的短程序开始，该程序查找列表中的最大数字。</p> <p>文件名：src/main.rs：</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> <span class="token operator">&amp;</span>number_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> <span class="token operator">&amp;</span>number_list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> number <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> number<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {largest}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>largest<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>示例10-1：查找列表中的最大数字</p> <p>我们在变量number_list中存储一个整数列表，并在名为largest的变量中放置对列表中第一个数字的引用。然后，我们遍历列表中的所有数字，如果当前数字大于存储在largest中的数字，我们就替换该变量中的引用。但是，如果当前数字小于或等于目前为止看到的最大数字，变量不会改变，代码继续处理列表中的下一个数字。在考虑列表中的所有数字后，largest应该引用最大的数字，在这种情况下是100。</p> <p>现在，我们的任务是在两个不同的数字列表中找到最大的数字。为此，我们可以选择复制示例10-1中的代码，并在程序的两个不同位置使用相同的逻辑，如示例10-2所示。</p> <p>文件名：src/main.rs：</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> <span class="token operator">&amp;</span>number_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> <span class="token operator">&amp;</span>number_list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> number <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> number<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {largest}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> <span class="token operator">&amp;</span>number_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> number <span class="token keyword">in</span> <span class="token operator">&amp;</span>number_list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> number <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> number<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {largest}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>示例10-2：查找两个数字列表中的最大数字的代码</p> <p>虽然这段代码有效，但复制代码既繁琐又容易出错。我们还必须记住在想要更改代码时在多个地方更新代码。</p> <p>为了消除这种重复，我们将创建一个抽象，定义一个函数，该函数对作为参数传入的任何整数列表进行操作。这个解决方案使我们的代码更清晰，并让我们抽象地表达在列表中查找最大数字的概念。</p> <p>在示例10-3中，我们将查找最大数字的代码提取到一个名为largest的函数中。然后，我们调用该函数来查找示例10-2中两个列表的最大数字。我们还可以在将来对任何其他i32值列表使用该函数。</p> <p>文件名：src/main.rs：</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">largest</span><span class="token punctuation">(</span>list<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">i32</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token keyword">i32</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> largest <span class="token operator">=</span> <span class="token operator">&amp;</span>list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> item <span class="token keyword">in</span> list <span class="token punctuation">{</span>
        <span class="token keyword">if</span> item <span class="token operator">&gt;</span> largest <span class="token punctuation">{</span>
            largest <span class="token operator">=</span> item<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    largest
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {result}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>result<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> number_list <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">largest</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>number_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;The largest number is {result}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>result<span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>示例10-3：抽象代码以查找两个列表中的最大数字</p> <p>largest函数有一个名为list的参数，它代表我们可能传递给函数的任何具体的i32值切片。因此，当我们调用函数时，代码在我们传入的特定值上运行。</p> <p>总结一下，以下是我们从示例10-2更改为示例10-3所采取的步骤：</p> <ol><li>识别重复代码。</li> <li>将重复代码提取到函数体中，并在函数签名中指定该代码的输入和返回值。</li> <li>更新重复代码的两个实例以调用函数。</li></ol> <p>接下来，我们将使用泛型采用相同的步骤来减少代码重复。就像函数体可以对抽象列表而不是特定值进行操作一样，泛型允许代码对抽象类型进行操作。</p> <p>例如，假设我们有两个函数：一个在i32值切片中查找最大项，另一个在char值切片中查找最大项。我们如何消除这种重复呢？让我们来看看！</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/rust-doc/assets/js/app.9135f27f.js" defer></script><script src="/rust-doc/assets/js/2.7165f438.js" defer></script><script src="/rust-doc/assets/js/1.8bad1a83.js" defer></script><script src="/rust-doc/assets/js/70.85b1bf80.js" defer></script>
  </body>
</html>
