<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rust 编程语言</title>
    <meta name="description" content="Rust 编程语言中文文档">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/rust-doc/assets/style.YGbMbk08.css" as="style">
    <link rel="preload stylesheet" href="/rust-doc/vp-icons.css" as="style">
    
    <script type="module" src="/rust-doc/assets/app.CS1ze4r1.js"></script>
    <link rel="preload" href="/rust-doc/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/rust-doc/assets/chunks/theme.B5MLMDo2.js">
    <link rel="modulepreload" href="/rust-doc/assets/chunks/framework.CO45oJKY.js">
    <link rel="modulepreload" href="/rust-doc/assets/docs_an-io-project_testing-the-librarys-functionality.md.DTNxTguM.lean.js">
    <link rel="icon" href="/rust-doc/rust-logo.svg">
    <meta name="theme-color" content="#f97316">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d7634c53><!--[--><!--]--><!--[--><span tabindex="-1" data-v-f3bc9b3a></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-f3bc9b3a>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d7634c53 data-v-b78b353d><div class="VPNavBar" data-v-b78b353d data-v-96c0dff9><div class="wrapper" data-v-96c0dff9><div class="container" data-v-96c0dff9><div class="title" data-v-96c0dff9><div class="VPNavBarTitle has-sidebar" data-v-96c0dff9 data-v-1a5fb46d><a class="title" href="/rust-doc/" data-v-1a5fb46d><!--[--><!--]--><!--[--><img class="VPImage logo" src="/rust-doc/rust-logo.svg" alt data-v-607cbd3d><!--]--><span data-v-1a5fb46d>Rust 编程语言</span><!--[--><!--]--></a></div></div><div class="content" data-v-96c0dff9><div class="content-body" data-v-96c0dff9><!--[--><!--]--><div class="VPNavBarSearch search" data-v-96c0dff9><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-96c0dff9 data-v-5f042eac><span id="main-nav-aria-label" class="visually-hidden" data-v-5f042eac> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/rust-doc/" tabindex="0" data-v-5f042eac data-v-ffbdff80><!--[--><span data-v-ffbdff80>首页</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://www.eveningwater.com/docs/index.html?type=rust-course" target="_blank" rel="noreferrer" tabindex="0" data-v-5f042eac data-v-ffbdff80><!--[--><span data-v-ffbdff80>Rust入门教程</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://doc.rust-lang.org/book/title-page.html" target="_blank" rel="noreferrer" tabindex="0" data-v-5f042eac data-v-ffbdff80><!--[--><span data-v-ffbdff80>英文原版</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-96c0dff9 data-v-e6e8ae3e><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-e6e8ae3e data-v-97c9474d data-v-abf7271b><span class="check" data-v-abf7271b><span class="icon" data-v-abf7271b><!--[--><span class="vpi-sun sun" data-v-97c9474d></span><span class="vpi-moon moon" data-v-97c9474d></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-96c0dff9 data-v-39cce436 data-v-0ee7334f><!--[--><a class="VPSocialLink no-icon" href="https://github.com/eveningwater/rust-doc" aria-label="github" target="_blank" rel="noopener" data-v-0ee7334f data-v-c0f4066f><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-96c0dff9 data-v-eb39208e data-v-8f6a011c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-8f6a011c><span class="vpi-more-horizontal icon" data-v-8f6a011c></span></button><div class="menu" data-v-8f6a011c><div class="VPMenu" data-v-8f6a011c data-v-bf9432e6><!----><!--[--><!--[--><!----><div class="group" data-v-eb39208e><div class="item appearance" data-v-eb39208e><p class="label" data-v-eb39208e>Appearance</p><div class="appearance-action" data-v-eb39208e><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-eb39208e data-v-97c9474d data-v-abf7271b><span class="check" data-v-abf7271b><span class="icon" data-v-abf7271b><!--[--><span class="vpi-sun sun" data-v-97c9474d></span><span class="vpi-moon moon" data-v-97c9474d></span><!--]--></span></span></button></div></div></div><div class="group" data-v-eb39208e><div class="item social-links" data-v-eb39208e><div class="VPSocialLinks social-links-list" data-v-eb39208e data-v-0ee7334f><!--[--><a class="VPSocialLink no-icon" href="https://github.com/eveningwater/rust-doc" aria-label="github" target="_blank" rel="noopener" data-v-0ee7334f data-v-c0f4066f><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-96c0dff9 data-v-2699385c><span class="container" data-v-2699385c><span class="top" data-v-2699385c></span><span class="middle" data-v-2699385c></span><span class="bottom" data-v-2699385c></span></span></button></div></div></div></div><div class="divider" data-v-96c0dff9><div class="divider-line" data-v-96c0dff9></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d7634c53 data-v-379c2920><div class="container" data-v-379c2920><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-379c2920><span class="vpi-align-left menu-icon" data-v-379c2920></span><span class="menu-text" data-v-379c2920>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-379c2920 data-v-3bac1d70><button data-v-3bac1d70>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d7634c53 data-v-ce55e00f><div class="curtain" data-v-ce55e00f></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ce55e00f><span class="visually-hidden" id="sidebar-aria-label" data-v-ce55e00f> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0" data-v-7fae23ac data-v-11b2f44a><!----><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/introduce/introduce.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>Rust介绍</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/getting-started/getting-started.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>入门</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/getting-started/install.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>安装</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/getting-started/hello-world.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>hello,world</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/getting-started/hello-cargo.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>hello,cargo</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0" data-v-7fae23ac data-v-11b2f44a><!----><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/guess-game/guess-game.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>猜一猜游戏</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-concept/common-concept.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>常用的编程概念</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-concept/variable-and-mutability.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>变量与可变性</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-concept/data-type.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>数据类型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-concept/functions.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>函数</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-concept/comments.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>注释</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-concept/control-flow.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>控制流</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/understand-ownership/understand-ownership.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>认识所有权</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/understand-ownership/what-ownership.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>什么是所有权</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/understand-ownership/references-and-borrow.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>引用与借用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/understand-ownership/slice-type.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>切片类型</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/structs/structs.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>使用结构体来构造相关数据</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/structs/defining-structs.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>定义和实例化结构体</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/structs/example-structs.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用结构体的示例程序</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/structs/method-syntax.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>方法语法</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/enums/enums.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>枚举</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/enums/defining-an-enum.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>定义一个枚举</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/enums/match.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>match控制流</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/enums/if-let.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用if let语法简化控制流</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/packages-crates-and-modules/packages-crates-and-modules.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>使用包、依赖箱和模块管理不断增长的项目</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/packages-crates-and-modules/packages-and-crates.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>包与依赖箱</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/packages-crates-and-modules/defining-modules.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>定义模块以控制上下文和私有作用域</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/packages-crates-and-modules/links-for-referring-to.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>引用模块树中项目的路径</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/packages-crates-and-modules/bringing-links.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用 use 关键字将路径纳入上下文</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/packages-crates-and-modules/separating.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>将模块分成不同的文件</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-collections/common-collections.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>常用集合</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-collections/vectors.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用向量存储值列表</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-collections/strings.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用字符串存储 UTF-8 编码的文本</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/common-collections/hash-maps.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>在哈希映射中存储键值对</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/error-handling/error-handling.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>错误处理</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/error-handling/unrecoverable-errors-with-panic.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用 panic! 处理不可恢复的错误</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/error-handling/recoverable-errors-with-result.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>可恢复错误及结果</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/error-handling/to-panic-or-not-to-panic.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>要 panic! 还是不要 panic!</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/generics/generics.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>泛型类型、特性和生命周期</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/generics/generic-syntax.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>泛型数据类型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/generics/traits.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>特性（Traits）：定义共享行为</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/generics/lifetime-syntax.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用生命周期验证引用</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/testing/testing.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>测试</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/testing/writing-tests.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>编写测试</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/testing/running-tests.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>运行测试</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/testing/test-organization.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>测试的组织结构</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link has-active" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/an-io-project/an-io-project.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>I/O 项目：构建命令行程序</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/an-io-project/accepting-command-line-arguments.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>接受命令行参数</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/an-io-project/reading-a-file.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>读取文件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/an-io-project/improving-error-handling-and-modularity.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>重构以提高模块化和错误处理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/an-io-project/testing-the-librarys-functionality.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用测试驱动开发来开发库的功能</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/an-io-project/working-with-environment-variables.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用环境变量</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/an-io-project/writing-to-stderr-instead-of-stdout.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用外部命令</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/functional-features/functional-features.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>函数式语言特性：迭代器与闭包</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/functional-features/closures.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>闭包：捕获其环境的匿名函数</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/functional-features/iterators.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用迭代器处理一系列项</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/functional-features/improving-our-io-project.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>改进我们的 I/O 项目</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/functional-features/performance.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>比较性能：循环 vs. 迭代器</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/more-about-cargo/more-about-cargo.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>关于 Cargo 和 Crates.io 的更多信息</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/more-about-cargo/release-profiles.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用发布配置文件自定义构建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/more-about-cargo/publishing-to-crates-io.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>将 Crate 发布到 Crates.io</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/more-about-cargo/cargo-workspaces.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用 Cargo 构建工作空间</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/more-about-cargo/installing-binaries.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用 `cargo install` 安装二进制文件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/more-about-cargo/extending-cargo.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用自定义命令扩展 Cargo</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/smart-pointers/smart-pointers.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>智能指针</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/smart-pointers/box.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用 Box<T> 指向堆上的数据</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/smart-pointers/deref.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>通过`Deref`特性将智能指针视为常规引用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/smart-pointers/drop.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用`Drop`特性在清理时运行代码</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/smart-pointers/rc.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>`Rc<T>`，引用计数智能指针</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/smart-pointers/interior-mutability.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>`RefCell<T>`和内部可变性模式</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/smart-pointers/reference-cycles.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>引用循环可能导致内存泄漏</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/concurrency/concurrency.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>无畏并发</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/concurrency/threads.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用线程同时运行代码</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/concurrency/message-passing.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用消息传递在线程间传递数据</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/concurrency/shared-state.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>共享状态并发</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/concurrency/extensible-concurrency-sync-and-send.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用`Send`和`Sync`特性的可扩展并发</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/async-await/async-await.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>异步编程基础：Async、Await、Futures 和 Streams</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/async-await/futures-and-syntax.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>Future 与异步语法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/async-await/concurrency-with-async.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>应用异步并发</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/async-await/more-futures.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>处理任意数量的 Future</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/async-await/streams.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>流：按顺序排列的 Future</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/async-await/traits-for-async.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>深入了解异步特性</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/async-await/futures-tasks-threads.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>整合：Future、任务和线程</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/oop/oop.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>面向对象编程特性</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/oop/what-is-oo.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>什么是面向对象</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/oop/trait-objects.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>使用特征对象来允许不同类型的值</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/oop/oo-design-patterns.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>实现面向对象的设计模式</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/patterns/patterns.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>模式与匹配</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/patterns/all-the-places-for-patterns.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>模式可以使用的所有位置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/patterns/refutability.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>可驳性：模式是否可能匹配失败</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/patterns/pattern-syntax.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>模式语法</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/advanced-features/advanced-features.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>高级特性</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/advanced-features/unsafe-rust.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>不安全的rust</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/advanced-features/advanced-traits.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>高级特征</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/advanced-features/advanced-types.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>高级类型</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/advanced-features/advanced-functions-and-closures.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>高级函数和闭包</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/advanced-features/macros.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>宏</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/final-project/final-project.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>最终项目：构建多线程Web服务器</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/final-project/single-threaded.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>构建单线程Web服务器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/final-project/multithreaded.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>将单线程服务器转换为多线程服务器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/final-project/graceful-shutdown-and-cleanup.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>优雅关闭和清理</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-7fae23ac><section class="VPSidebarItem level-0 is-link" data-v-7fae23ac data-v-11b2f44a><div class="item" tabindex="0" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/appendix/appendix-a.html" data-v-11b2f44a><!--[--><h2 class="text" data-v-11b2f44a>附录</h2><!--]--></a><!----></div><div class="items" data-v-11b2f44a><!--[--><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/appendix/appendix-a.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>附录A: 关键字</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/appendix/appendix-b.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>附录B: 运算符和符号</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/appendix/appendix-c.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>附录C: 可衍生的特征</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/appendix/appendix-d.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>附录D: 实用开发工具</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/appendix/appendix-e.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>附录E: 版本</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/appendix/appendix-f.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>附录F: 本书的翻译</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-11b2f44a data-v-11b2f44a><div class="item" data-v-11b2f44a><div class="indicator" data-v-11b2f44a></div><a class="VPLink link link" href="/rust-doc/docs/appendix/appendix-g.html" data-v-11b2f44a><!--[--><p class="text" data-v-11b2f44a>附录G: Rust 是如何开发的以及 Nightly Rust</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d7634c53 data-v-5fea6e4d><div class="VPDoc has-sidebar has-aside" data-v-5fea6e4d data-v-30f0886d><!--[--><!--]--><div class="container" data-v-30f0886d><div class="aside" data-v-30f0886d><div class="aside-curtain" data-v-30f0886d></div><div class="aside-container" data-v-30f0886d><div class="aside-content" data-v-30f0886d><div class="VPDocAside" data-v-30f0886d data-v-e232168f><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-e232168f data-v-445bfcb4><div class="content" data-v-445bfcb4><div class="outline-marker" data-v-445bfcb4></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-445bfcb4>目录</div><ul class="VPDocOutlineItem root" data-v-445bfcb4 data-v-cb6a4240><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-e232168f></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-30f0886d><div class="content-container" data-v-30f0886d><!--[--><!--]--><main class="main" data-v-30f0886d><div style="position:relative;" class="vp-doc _rust-doc_docs_an-io-project_testing-the-librarys-functionality" data-v-30f0886d><div><h2 id="使用测试驱动开发来开发库的功能" tabindex="-1">使用测试驱动开发来开发库的功能 <a class="header-anchor" href="#使用测试驱动开发来开发库的功能" aria-label="Permalink to &quot;使用测试驱动开发来开发库的功能&quot;">​</a></h2><p>现在我们已经将逻辑提取到 src/lib.rs 中，并将参数收集和错误处理留在 src/main.rs 中，为代码的核心功能编写测试变得容易多了。我们可以直接使用各种参数调用函数并检查返回值，而无需从命令行调用我们的二进制文件。</p><p>在本节中，我们将使用测试驱动开发（TDD）过程向 <code>minigrep</code> 程序添加搜索逻辑，步骤如下：</p><ol><li>编写一个会失败的测试，并运行它以确保它因你期望的原因而失败。</li><li>编写或修改足够的代码以使新测试通过。</li><li>重构你刚刚添加或更改的代码，并确保测试继续通过。</li><li>从步骤 1 重复！</li></ol><p>尽管 TDD 是编写软件的众多方法之一，但它可以帮助推动代码设计。在编写使测试通过的代码之前编写测试有助于在整个过程中保持较高的测试覆盖率。</p><p>我们将测试驱动实现实际执行在文件内容中搜索查询字符串并生成匹配查询的行列表的功能。我们将在一个名为 <code>search</code> 的函数中添加此功能。</p><h2 id="编写一个失败的测试" tabindex="-1">编写一个失败的测试 <a class="header-anchor" href="#编写一个失败的测试" aria-label="Permalink to &quot;编写一个失败的测试&quot;">​</a></h2><p>因为我们不再需要它们，所以让我们从 src/lib.rs 和 src/main.rs 中删除用于检查程序行为的 <code>println!</code> 语句。然后，在 src/lib.rs 中，我们将添加一个带有测试函数的 <code>tests</code> 模块，就像我们在第 11 章中所做的那样。测试函数指定了我们希望 <code>search</code> 函数具有的行为：它将接受一个查询和要搜索的文本，并且只返回文本中包含查询的行。示例 12-15 显示了这个测试，它还不能编译。</p><p>文件名: src/lib.rs:</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">impl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">static</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() &lt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;not enough arguments&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { query, file_path })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;(), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Box</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">dyn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">read_to_string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file_path)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#[cfg(test)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mod</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tests</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> super</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    #[test]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> one_result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;duct&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Rust:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">safe, fast, productive.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Pick three.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        assert_eq!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;safe, fast, productive.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query, contents));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>示例 12-15: 为我们希望拥有的 <code>search</code> 函数创建一个失败的测试</p><p>这个测试搜索字符串 <code>&quot;duct&quot;</code>。我们搜索的文本有三行，其中只有一行包含 <code>&quot;duct&quot;</code>（注意，开头的双引号后面的反斜杠告诉 Rust 不要在字符串字面量的开头放置换行符）。我们断言从 <code>search</code> 函数返回的值只包含我们期望的那一行。</p><p>我们还不能运行这个测试并观察它失败，因为测试甚至无法编译：<code>search</code> 函数还不存在！根据 TDD 原则，我们将添加足够的代码来使测试编译并运行，方法是添加一个 <code>search</code> 函数的定义，该函数始终返回一个空向量，如示例 12-16 所示。然后测试应该编译并失败，因为空向量与包含行 <code>&quot;safe, fast, productive.&quot;</code> 的向量不匹配。</p><p>文件名: src/lib.rs:</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">impl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">static</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() &lt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;not enough arguments&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { query, file_path })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;(), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Box</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">dyn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">read_to_string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file_path)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    vec!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#[cfg(test)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mod</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tests</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> super</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    #[test]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> one_result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;duct&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Rust:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">safe, fast, productive.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Pick three.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        assert_eq!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;safe, fast, productive.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query, contents));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>示例 12-16: 定义足够的 search 函数，以便我们的测试能够编译</p><p>请注意，我们需要在 <code>search</code> 的签名中定义一个显式的生命周期 <code>&#39;a</code>，并将该生命周期与 <code>contents</code> 参数和返回值一起使用。回想一下第 10 章，生命周期参数指定了哪个参数的生命周期与返回值的生命周期相关联。在这种情况下，我们表示返回的向量应该包含引用 <code>contents</code> 参数（而不是 <code>query</code> 参数）切片的字符串切片。</p><p>换句话说，我们告诉 Rust，<code>search</code> 函数返回的数据将与传递给 <code>search</code> 函数的 <code>contents</code> 参数中的数据一样长寿。这很重要！切片引用的数据需要有效，引用才能有效；如果编译器假设我们正在创建 <code>query</code> 而不是 <code>contents</code> 的字符串切片，它将错误地进行安全检查。</p><p>如果我们忘记了生命周期注解并尝试编译此函数，我们将收到此错误：</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cargo build</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Compiling</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minigrep v0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">///projects/minigrep)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">error[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">E0106</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> missing lifetime specifier</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  --&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> src</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lib</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">51</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   |</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   |</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                      ----</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            ----</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         ^</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> expected named lifetime parameter</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   |</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> help</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> this function&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contains a borrowed value, but the signature does not say whether it is borrowed from `query` or `contents`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">help</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> consider introducing a named lifetime parameter</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   |</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">28</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   |</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">              ++++</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         ++</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                 ++</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">              ++</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">For</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> more information about this error, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `rustc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">explain </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">E0106</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> could not compile `minigrep` (lib) due to </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> previous error</span></span></code></pre></div><p>Rust 不可能知道我们需要哪个参数，所以我们需要明确地告诉它。因为 <code>contents</code> 是包含我们所有文本的参数，并且我们想要返回匹配的文本部分，所以我们知道 <code>contents</code> 是应该使用生命周期语法连接到返回值的参数。</p><p>其他编程语言不需要你在签名中将参数连接到返回值，但随着时间的推移，这种做法会变得更容易。你可能想将此示例与第 10 章“使用生命周期验证引用”部分中的示例进行比较。</p><p>现在让我们运行测试：</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cargo test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Compiling</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minigrep v0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">///projects/minigrep)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Finished</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `test` profile [unoptimized </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> debuginfo] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">97s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Running</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> unittests src</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lib</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs (target</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">debug</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">minigrep</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">9cd200e5fac0fc94)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">running </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> test</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tests</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">one_result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> FAILED</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">failures</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">----</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tests</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">one_result stdout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">----</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">thread &#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tests</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">one_result</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39; panicked at src/lib.rs:44:9:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">assertion `left == right` failed</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  left: [&quot;safe, fast, productive.&quot;]</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> right: []</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">failures:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    tests::one_result</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">error: test failed, to rerun pass `--lib`</span></span></code></pre></div><p>太好了，测试失败了，正如我们预期的那样。让我们让测试通过！</p><h2 id="编写代码以通过测试" tabindex="-1">编写代码以通过测试 <a class="header-anchor" href="#编写代码以通过测试" aria-label="Permalink to &quot;编写代码以通过测试&quot;">​</a></h2><p>目前，我们的测试失败是因为我们总是返回一个空向量。为了解决这个问题并实现 <code>search</code>，我们的程序需要遵循以下步骤：</p><ol><li>遍历内容的每一行。</li><li>检查该行是否包含我们的查询字符串。</li><li>如果包含，将其添加到我们要返回的值列表中。</li><li>如果不包含，则不执行任何操作。</li><li>返回匹配的结果列表。</li></ol><p>让我们逐一完成每个步骤，从遍历行开始。</p><h3 id="使用-lines-方法遍历行" tabindex="-1">使用 <code>lines</code> 方法遍历行 <a class="header-anchor" href="#使用-lines-方法遍历行" aria-label="Permalink to &quot;使用 `lines` 方法遍历行&quot;">​</a></h3><p>Rust 有一个有用的方法来处理字符串的逐行迭代，方便地命名为 <code>lines</code>，其工作方式如示例 12-17 所示。请注意，这还不能编译。</p><p>文件名: src/lib.rs:</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">impl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">static</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() &lt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;not enough arguments&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { query, file_path })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;(), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Box</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">dyn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">read_to_string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file_path)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> line </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lines</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // do something with line</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#[cfg(test)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mod</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tests</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> super</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    #[test]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> one_result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;duct&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Rust:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">safe, fast, productive.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Pick three.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        assert_eq!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;safe, fast, productive.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query, contents));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>示例 12-17: 遍历 <code>contents</code> 中的每一行</p><p><code>lines</code> 方法返回一个迭代器。我们将在第 13 章深入讨论迭代器，但回想一下，你在示例 3-5 中看到了这种使用迭代器的方式，我们在其中使用 <code>for</code> 循环和迭代器对集合中的每个项运行一些代码。</p><h3 id="搜索每行中的查询" tabindex="-1">搜索每行中的查询 <a class="header-anchor" href="#搜索每行中的查询" aria-label="Permalink to &quot;搜索每行中的查询&quot;">​</a></h3><p>接下来，我们将检查当前行是否包含我们的查询字符串。幸运的是，字符串有一个有用的方法 <code>contains</code> 可以为我们完成这项工作！在 <code>search</code> 函数中添加对 <code>contains</code> 方法的调用，如示例 12-18 所示。请注意，这仍然不能编译。</p><p>文件名: src/lib.rs:</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">impl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">static</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() &lt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;not enough arguments&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { query, file_path })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;(), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Box</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">dyn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">read_to_string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file_path)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> line </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lines</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> line</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">contains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // do something with line</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#[cfg(test)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mod</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tests</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> super</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    #[test]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> one_result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;duct&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Rust:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">safe, fast, productive.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Pick three.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        assert_eq!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;safe, fast, productive.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query, contents));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>示例 12-18: 添加功能以查看行是否包含 <code>query</code> 中的字符串</p><p>目前，我们正在构建功能。为了使代码编译，我们需要从函数体中返回一个值，正如我们在函数签名中指出的那样。</p><h3 id="存储匹配的行" tabindex="-1">存储匹配的行 <a class="header-anchor" href="#存储匹配的行" aria-label="Permalink to &quot;存储匹配的行&quot;">​</a></h3><p>为了完成这个函数，我们需要一种方法来存储我们想要返回的匹配行。为此，我们可以在 <code>for</code> 循环之前创建一个可变向量，并调用 <code>push</code> 方法将 <code>line</code> 存储在向量中。在 <code>for</code> 循环之后，我们返回向量，如示例 12-19 所示。</p><p>文件名: src/lib.rs:</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">impl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">static</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() &lt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;not enough arguments&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { query, file_path })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;(), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Box</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">dyn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">read_to_string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file_path)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> mut</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vec</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> line </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lines</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> line</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">contains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(line);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    results</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#[cfg(test)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mod</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tests</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> super</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    #[test]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> one_result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;duct&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Rust:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">safe, fast, productive.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Pick three.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        assert_eq!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;safe, fast, productive.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query, contents));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>示例 12-19: 存储匹配的行以便我们可以返回它们</p><p>现在 <code>search</code> 函数应该只返回包含 <code>query</code> 的行，并且我们的测试应该通过。让我们运行测试：</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cargo test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Compiling</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minigrep v0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">///projects/minigrep)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Finished</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `test` profile [unoptimized </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> debuginfo] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">22s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Running</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> unittests src</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">lib</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs (target</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">debug</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">minigrep</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">9cd200e5fac0fc94)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">running </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> test</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tests</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">one_result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ok</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ok</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> passed; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> failed; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ignored; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> measured; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filtered out; finished </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">00s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Running</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> unittests src</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">main</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rs (target</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">debug</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">deps</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">minigrep</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">9cd200e5fac0fc94)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">running </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tests</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ok</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> passed; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> failed; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ignored; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> measured; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filtered out; finished </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">00s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Doc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tests minigrep</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">running </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tests</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ok</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> passed; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> failed; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ignored; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> measured; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filtered out; finished </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">00s</span></span></code></pre></div><p>我们的测试通过了，所以我们知道它有效！</p><p>此时，我们可以考虑重构 search 函数的实现，同时保持测试通过以维持相同的功能。search 函数中的代码还不错，但它没有利用迭代器的一些有用特性。我们将在第 13 章回到这个例子，在那里我们将详细探讨迭代器，并研究如何改进它。</p><h3 id="在-run-函数中使用-search-函数" tabindex="-1">在 <code>run</code> 函数中使用 <code>search</code> 函数 <a class="header-anchor" href="#在-run-函数中使用-search-函数" aria-label="Permalink to &quot;在 `run` 函数中使用 `search` 函数&quot;">​</a></h3><p>现在 <code>search</code> 函数已经工作并经过测试，我们需要从 <code>run</code> 函数中调用 <code>search</code>。我们需要将 <code>config.query</code> 值和 <code>run</code> 从文件中读取的 <code>contents</code> 传递给 <code>search</code> 函数。然后 <code>run</code> 将打印从 <code>search</code> 返回的每一行：</p><p>文件名: src/lib.rs:</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">use</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> std</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fs;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">impl</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">static</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() &lt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;not enough arguments&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> file_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { query, file_path })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;(), </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Box</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">dyn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">read_to_string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file_path)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> line </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">query, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">contents) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        println!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{line}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Ok</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(query</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    let</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> mut</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Vec</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> line </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lines</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> line</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">contains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            results</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(line);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    results</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">#[cfg(test)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mod</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tests</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> super</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    #[test]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fn</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> one_result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;duct&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> contents </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Rust:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">safe, fast, productive.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Pick three.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        assert_eq!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vec!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;safe, fast, productive.&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">search</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(query, contents));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>我们仍然使用 <code>for</code> 循环来返回 <code>search</code> 中的每一行并打印它。</p><p>现在整个程序应该可以工作了！让我们试一试，首先使用一个应该从 Emily Dickinson 的诗中返回一行单词：<code>frog</code>。</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cargo run </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> frog poem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Compiling</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minigrep v0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">///projects/minigrep)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Finished</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `dev` profile [unoptimized </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> debuginfo] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">38s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Running</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `target</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">debug</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">minigrep frog poem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">txt`</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">How</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> public, like a frog</span></span></code></pre></div><p>太酷了！现在让我们尝试一个会匹配多行的单词，比如 body：</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cargo run </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body poem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Compiling</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minigrep v0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">///projects/minigrep)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Finished</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `dev` profile [unoptimized </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> debuginfo] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">0s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Running</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `target</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">debug</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">minigrep body poem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">txt`</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">I</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">m</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nobody!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Who</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> are you</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Are</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> you nobody, too</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">How</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dreary to be </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">somebody!</span></span></code></pre></div><p>最后，让我们确保当我们搜索诗中不存在的单词（例如 monomorphization）时，不会得到任何行：</p><div class="language-rust vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">rust</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cargo run </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> monomorphization poem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   Compiling</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> minigrep v0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">///projects/minigrep)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Finished</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `dev` profile [unoptimized </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> debuginfo] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(s) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">0s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">     Running</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> `target</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">debug</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">minigrep monomorphization poem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">txt`</span></span></code></pre></div><p>太棒了！我们构建了自己的经典工具的迷你版本，并学到了很多关于如何构建应用程序的知识。我们还学习了一些关于文件输入和输出、生命周期、测试和命令行解析的知识。</p><p>为了完成这个项目，我们将简要演示如何使用环境变量以及如何打印到标准错误，这两者在编写命令行程序时都非常有用。</p></div></div></main><footer class="VPDocFooter" data-v-30f0886d data-v-da5a16f3><!--[--><!--]--><div class="edit-info" data-v-da5a16f3><div class="edit-link" data-v-da5a16f3><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/eveningwater/rust-doc/edit/main/docs/docs/an-io-project/testing-the-librarys-functionality.md" target="_blank" rel="noreferrer" data-v-da5a16f3><!--[--><span class="vpi-square-pen edit-link-icon" data-v-da5a16f3></span> 在 GitHub 上编辑此页<!--]--></a></div><div class="last-updated" data-v-da5a16f3><p class="VPLastUpdated" data-v-da5a16f3 data-v-1c097950>最后更新: <time datetime="2025-08-07T14:06:21.000Z" data-v-1c097950></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-da5a16f3><span class="visually-hidden" id="doc-footer-aria-label" data-v-da5a16f3>Pager</span><div class="pager" data-v-da5a16f3><a class="VPLink link pager-link prev" href="/rust-doc/docs/an-io-project/improving-error-handling-and-modularity.html" data-v-da5a16f3><!--[--><span class="desc" data-v-da5a16f3>上一篇</span><span class="title" data-v-da5a16f3>重构以提高模块化和错误处理</span><!--]--></a></div><div class="pager" data-v-da5a16f3><a class="VPLink link pager-link next" href="/rust-doc/docs/an-io-project/working-with-environment-variables.html" data-v-da5a16f3><!--[--><span class="desc" data-v-da5a16f3>下一篇</span><span class="title" data-v-da5a16f3>使用环境变量</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d7634c53 data-v-fb5402f2><div class="container" data-v-fb5402f2><p class="message" data-v-fb5402f2>MIT Licensed | Copyright © 2020-present eveningwater</p><!----></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"docs_advanced-features_advanced-features.md\":\"DwRGqzf5\",\"docs_advanced-features_advanced-functions-and-closures.md\":\"CGf6tlC2\",\"docs_advanced-features_advanced-traits.md\":\"Gc1xPPke\",\"docs_advanced-features_advanced-types.md\":\"CB8BPVik\",\"docs_advanced-features_macros.md\":\"BCYi2dMY\",\"docs_advanced-features_unsafe-rust.md\":\"CXGxTJXP\",\"docs_an-io-project_accepting-command-line-arguments.md\":\"DbKC22li\",\"docs_an-io-project_an-io-project.md\":\"CCv-MhLc\",\"docs_an-io-project_improving-error-handling-and-modularity.md\":\"BAS8PCVP\",\"docs_an-io-project_reading-a-file.md\":\"Cah-xLau\",\"docs_an-io-project_testing-the-librarys-functionality.md\":\"DTNxTguM\",\"docs_an-io-project_working-with-environment-variables.md\":\"DeoBChTs\",\"docs_an-io-project_writing-to-stderr-instead-of-stdout.md\":\"D9__gOxg\",\"docs_appendix_appendix-a.md\":\"TBsdr_2Y\",\"docs_appendix_appendix-b.md\":\"DbW_1Q3G\",\"docs_appendix_appendix-c.md\":\"DZy11R4O\",\"docs_appendix_appendix-d.md\":\"BCqgGfeq\",\"docs_appendix_appendix-e.md\":\"C0HLtr-K\",\"docs_appendix_appendix-f.md\":\"C9cLM6HH\",\"docs_appendix_appendix-g.md\":\"BUV-eL5S\",\"docs_async-await_async-await.md\":\"Da57jncr\",\"docs_async-await_concurrency-with-async.md\":\"B3LyI4H5\",\"docs_async-await_futures-and-syntax.md\":\"hLzmYMMY\",\"docs_async-await_futures-tasks-threads.md\":\"DYxmrYmG\",\"docs_async-await_more-futures.md\":\"BAx2ZIpo\",\"docs_async-await_streams.md\":\"fwHF49HY\",\"docs_async-await_traits-for-async.md\":\"hyC-XcJ7\",\"docs_common-collections_common-collections.md\":\"Bx2cEf3m\",\"docs_common-collections_hash-maps.md\":\"ByZY8tIf\",\"docs_common-collections_strings.md\":\"tmWAq0fA\",\"docs_common-collections_vectors.md\":\"Bpx2yr0w\",\"docs_common-concept_comments.md\":\"Bmmm6l0h\",\"docs_common-concept_common-concept.md\":\"C-dr9ye1\",\"docs_common-concept_control-flow.md\":\"QgPoWTxe\",\"docs_common-concept_data-type.md\":\"BUh3D0HU\",\"docs_common-concept_functions.md\":\"CgFkY3sa\",\"docs_common-concept_variable-and-mutability.md\":\"BoTWnQ_g\",\"docs_concurrency_concurrency.md\":\"C8xhK43w\",\"docs_concurrency_extensible-concurrency-sync-and-send.md\":\"C8ChUuhL\",\"docs_concurrency_message-passing.md\":\"BB2C-dKA\",\"docs_concurrency_shared-state.md\":\"DkMJ5d3B\",\"docs_concurrency_threads.md\":\"LdvfPvCp\",\"docs_enums_defining-an-enum.md\":\"BjZXP7nw\",\"docs_enums_enums.md\":\"DYeVOhhF\",\"docs_enums_if-let.md\":\"KQW4IUWn\",\"docs_enums_match.md\":\"DSmsEMVD\",\"docs_error-handling_error-handling.md\":\"Bk6IlDoW\",\"docs_error-handling_recoverable-errors-with-result.md\":\"IHkqsnJ4\",\"docs_error-handling_to-panic-or-not-to-panic.md\":\"DaP9VcXT\",\"docs_error-handling_unrecoverable-errors-with-panic.md\":\"W4U1l5IJ\",\"docs_final-project_final-project.md\":\"DPkFnGd3\",\"docs_final-project_graceful-shutdown-and-cleanup.md\":\"CmXWmWXQ\",\"docs_final-project_multithreaded.md\":\"Bg6aD-5n\",\"docs_final-project_single-threaded.md\":\"BDU89qhY\",\"docs_functional-features_closures.md\":\"RDgtp4w_\",\"docs_functional-features_functional-features.md\":\"cPNcsbnZ\",\"docs_functional-features_improving-our-io-project.md\":\"CJZg7RDo\",\"docs_functional-features_iterators.md\":\"Egkckw0j\",\"docs_functional-features_performance.md\":\"CENZc1uE\",\"docs_generics_generic-syntax.md\":\"DrF_FSkt\",\"docs_generics_generics.md\":\"CD0GZVK1\",\"docs_generics_lifetime-syntax.md\":\"Czge270K\",\"docs_generics_traits.md\":\"fTce1Aw7\",\"docs_getting-started_getting-started.md\":\"Cqi9GU1t\",\"docs_getting-started_hello-cargo.md\":\"DHdZVfvM\",\"docs_getting-started_hello-world.md\":\"MQSdzFb9\",\"docs_getting-started_install.md\":\"kMdy18IB\",\"docs_guess-game_guess-game.md\":\"DP9lsXzZ\",\"docs_introduce_introduce.md\":\"CO203oh4\",\"docs_more-about-cargo_cargo-workspaces.md\":\"ClXtWsdi\",\"docs_more-about-cargo_extending-cargo.md\":\"BZ0miG-f\",\"docs_more-about-cargo_installing-binaries.md\":\"v4P81OOM\",\"docs_more-about-cargo_more-about-cargo.md\":\"D_EPjgTR\",\"docs_more-about-cargo_publishing-to-crates-io.md\":\"DNWwF9Fa\",\"docs_more-about-cargo_release-profiles.md\":\"CjewqjBF\",\"docs_oop_oo-design-patterns.md\":\"CNMocTCQ\",\"docs_oop_oop.md\":\"C1RbfkSc\",\"docs_oop_trait-objects.md\":\"B9bE3NU9\",\"docs_oop_what-is-oo.md\":\"e3-kR2Q2\",\"docs_other_other.md\":\"xN5V-Wgt\",\"docs_packages-crates-and-modules_bringing-paths.md\":\"B33HPIHS\",\"docs_packages-crates-and-modules_defining-modules.md\":\"CXefG5gZ\",\"docs_packages-crates-and-modules_packages-and-crates.md\":\"DSWQBcVG\",\"docs_packages-crates-and-modules_packages-crates-and-modules.md\":\"0ijywx5a\",\"docs_packages-crates-and-modules_paths-for-referring-to.md\":\"wQFENTt9\",\"docs_packages-crates-and-modules_separating.md\":\"wkRtSzig\",\"docs_patterns_all-the-places-for-patterns.md\":\"BwZiNXMw\",\"docs_patterns_pattern-syntax.md\":\"HboIzvPj\",\"docs_patterns_patterns.md\":\"DOLKjL8s\",\"docs_patterns_refutability.md\":\"DjtNR-cT\",\"docs_smart-pointers_box.md\":\"BxEVXzKA\",\"docs_smart-pointers_deref.md\":\"CVQvCuk7\",\"docs_smart-pointers_drop.md\":\"CCP4GGM8\",\"docs_smart-pointers_interior-mutability.md\":\"vAOgmmn9\",\"docs_smart-pointers_rc.md\":\"BZKDJCAG\",\"docs_smart-pointers_reference-cycles.md\":\"BoaFkHTD\",\"docs_smart-pointers_smart-pointers.md\":\"jR5cmgyw\",\"docs_structs_defining-structs.md\":\"B9DwE0pN\",\"docs_structs_example-structs.md\":\"BXuOQSsY\",\"docs_structs_method-syntax.md\":\"Bpmd_FZl\",\"docs_structs_structs.md\":\"BirtIB9f\",\"docs_testing_running-tests.md\":\"DswMhtHY\",\"docs_testing_test-organization.md\":\"BUHYiho5\",\"docs_testing_testing.md\":\"COYepXy3\",\"docs_testing_writing-tests.md\":\"BMxEeLaK\",\"docs_understand-ownership_references-and-borrow.md\":\"rhCslNYs\",\"docs_understand-ownership_slice-type.md\":\"BMw-2Fh2\",\"docs_understand-ownership_understand-ownership.md\":\"eB_Ji0aR\",\"docs_understand-ownership_what-ownership.md\":\"DoM26Kse\",\"index.md\":\"B40TPVeS\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"Rust 编程语言\",\"description\":\"Rust 编程语言中文文档\",\"base\":\"/rust-doc/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/rust-logo.svg\",\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"Rust入门教程\",\"link\":\"https://www.eveningwater.com/docs/index.html?type=rust-course\"},{\"text\":\"英文原版\",\"link\":\"https://doc.rust-lang.org/book/title-page.html\"}],\"sidebar\":[{\"text\":\"Rust介绍\",\"link\":\"/docs/introduce/introduce\"},{\"text\":\"入门\",\"link\":\"/docs/getting-started/getting-started\",\"items\":[{\"text\":\"安装\",\"link\":\"/docs/getting-started/install\"},{\"text\":\"hello,world\",\"link\":\"/docs/getting-started/hello-world\"},{\"text\":\"hello,cargo\",\"link\":\"/docs/getting-started/hello-cargo\"}]},{\"text\":\"猜一猜游戏\",\"link\":\"/docs/guess-game/guess-game\"},{\"text\":\"常用的编程概念\",\"link\":\"/docs/common-concept/common-concept\",\"items\":[{\"text\":\"变量与可变性\",\"link\":\"/docs/common-concept/variable-and-mutability\"},{\"text\":\"数据类型\",\"link\":\"/docs/common-concept/data-type\"},{\"text\":\"函数\",\"link\":\"/docs/common-concept/functions\"},{\"text\":\"注释\",\"link\":\"/docs/common-concept/comments\"},{\"text\":\"控制流\",\"link\":\"/docs/common-concept/control-flow\"}]},{\"text\":\"认识所有权\",\"link\":\"/docs/understand-ownership/understand-ownership\",\"items\":[{\"text\":\"什么是所有权\",\"link\":\"/docs/understand-ownership/what-ownership\"},{\"text\":\"引用与借用\",\"link\":\"/docs/understand-ownership/references-and-borrow\"},{\"text\":\"切片类型\",\"link\":\"/docs/understand-ownership/slice-type\"}]},{\"text\":\"使用结构体来构造相关数据\",\"link\":\"/docs/structs/structs\",\"items\":[{\"text\":\"定义和实例化结构体\",\"link\":\"/docs/structs/defining-structs\"},{\"text\":\"使用结构体的示例程序\",\"link\":\"/docs/structs/example-structs\"},{\"text\":\"方法语法\",\"link\":\"/docs/structs/method-syntax\"}]},{\"text\":\"枚举\",\"link\":\"/docs/enums/enums\",\"items\":[{\"text\":\"定义一个枚举\",\"link\":\"/docs/enums/defining-an-enum\"},{\"text\":\"match控制流\",\"link\":\"/docs/enums/match\"},{\"text\":\"使用if let语法简化控制流\",\"link\":\"/docs/enums/if-let\"}]},{\"text\":\"使用包、依赖箱和模块管理不断增长的项目\",\"link\":\"/docs/packages-crates-and-modules/packages-crates-and-modules\",\"items\":[{\"text\":\"包与依赖箱\",\"link\":\"/docs/packages-crates-and-modules/packages-and-crates\"},{\"text\":\"定义模块以控制上下文和私有作用域\",\"link\":\"/docs/packages-crates-and-modules/defining-modules\"},{\"text\":\"引用模块树中项目的路径\",\"link\":\"/docs/packages-crates-and-modules/links-for-referring-to\"},{\"text\":\"使用 use 关键字将路径纳入上下文\",\"link\":\"/docs/packages-crates-and-modules/bringing-links\"},{\"text\":\"将模块分成不同的文件\",\"link\":\"/docs/packages-crates-and-modules/separating\"}]},{\"text\":\"常用集合\",\"link\":\"/docs/common-collections/common-collections\",\"items\":[{\"text\":\"使用向量存储值列表\",\"link\":\"/docs/common-collections/vectors\"},{\"text\":\"使用字符串存储 UTF-8 编码的文本\",\"link\":\"/docs/common-collections/strings\"},{\"text\":\"在哈希映射中存储键值对\",\"link\":\"/docs/common-collections/hash-maps\"}]},{\"text\":\"错误处理\",\"link\":\"/docs/error-handling/error-handling\",\"items\":[{\"text\":\"使用 panic! 处理不可恢复的错误\",\"link\":\"/docs/error-handling/unrecoverable-errors-with-panic\"},{\"text\":\"可恢复错误及结果\",\"link\":\"/docs/error-handling/recoverable-errors-with-result\"},{\"text\":\"要 panic! 还是不要 panic!\",\"link\":\"/docs/error-handling/to-panic-or-not-to-panic\"}]},{\"text\":\"泛型类型、特性和生命周期\",\"link\":\"/docs/generics/generics\",\"items\":[{\"text\":\"泛型数据类型\",\"link\":\"/docs/generics/generic-syntax\"},{\"text\":\"特性（Traits）：定义共享行为\",\"link\":\"/docs/generics/traits\"},{\"text\":\"使用生命周期验证引用\",\"link\":\"/docs/generics/lifetime-syntax\"}]},{\"text\":\"测试\",\"link\":\"/docs/testing/testing\",\"items\":[{\"text\":\"编写测试\",\"link\":\"/docs/testing/writing-tests\"},{\"text\":\"运行测试\",\"link\":\"/docs/testing/running-tests\"},{\"text\":\"测试的组织结构\",\"link\":\"/docs/testing/test-organization\"}]},{\"text\":\"I/O 项目：构建命令行程序\",\"link\":\"/docs/an-io-project/an-io-project\",\"items\":[{\"text\":\"接受命令行参数\",\"link\":\"/docs/an-io-project/accepting-command-line-arguments\"},{\"text\":\"读取文件\",\"link\":\"/docs/an-io-project/reading-a-file\"},{\"text\":\"重构以提高模块化和错误处理\",\"link\":\"/docs/an-io-project/improving-error-handling-and-modularity\"},{\"text\":\"使用测试驱动开发来开发库的功能\",\"link\":\"/docs/an-io-project/testing-the-librarys-functionality\"},{\"text\":\"使用环境变量\",\"link\":\"/docs/an-io-project/working-with-environment-variables\"},{\"text\":\"使用外部命令\",\"link\":\"/docs/an-io-project/writing-to-stderr-instead-of-stdout\"}]},{\"text\":\"函数式语言特性：迭代器与闭包\",\"link\":\"/docs/functional-features/functional-features\",\"items\":[{\"text\":\"闭包：捕获其环境的匿名函数\",\"link\":\"/docs/functional-features/closures\"},{\"text\":\"使用迭代器处理一系列项\",\"link\":\"/docs/functional-features/iterators\"},{\"text\":\"改进我们的 I/O 项目\",\"link\":\"/docs/functional-features/improving-our-io-project\"},{\"text\":\"比较性能：循环 vs. 迭代器\",\"link\":\"/docs/functional-features/performance\"}]},{\"text\":\"关于 Cargo 和 Crates.io 的更多信息\",\"link\":\"/docs/more-about-cargo/more-about-cargo\",\"items\":[{\"text\":\"使用发布配置文件自定义构建\",\"link\":\"/docs/more-about-cargo/release-profiles\"},{\"text\":\"将 Crate 发布到 Crates.io\",\"link\":\"/docs/more-about-cargo/publishing-to-crates-io\"},{\"text\":\"使用 Cargo 构建工作空间\",\"link\":\"/docs/more-about-cargo/cargo-workspaces\"},{\"text\":\"使用 `cargo install` 安装二进制文件\",\"link\":\"/docs/more-about-cargo/installing-binaries\"},{\"text\":\"使用自定义命令扩展 Cargo\",\"link\":\"/docs/more-about-cargo/extending-cargo\"}]},{\"text\":\"智能指针\",\"link\":\"/docs/smart-pointers/smart-pointers\",\"items\":[{\"text\":\"使用 Box<T> 指向堆上的数据\",\"link\":\"/docs/smart-pointers/box\"},{\"text\":\"通过`Deref`特性将智能指针视为常规引用\",\"link\":\"/docs/smart-pointers/deref\"},{\"text\":\"使用`Drop`特性在清理时运行代码\",\"link\":\"/docs/smart-pointers/drop\"},{\"text\":\"`Rc<T>`，引用计数智能指针\",\"link\":\"/docs/smart-pointers/rc\"},{\"text\":\"`RefCell<T>`和内部可变性模式\",\"link\":\"/docs/smart-pointers/interior-mutability\"},{\"text\":\"引用循环可能导致内存泄漏\",\"link\":\"/docs/smart-pointers/reference-cycles\"}]},{\"text\":\"无畏并发\",\"link\":\"/docs/concurrency/concurrency\",\"items\":[{\"text\":\"使用线程同时运行代码\",\"link\":\"/docs/concurrency/threads\"},{\"text\":\"使用消息传递在线程间传递数据\",\"link\":\"/docs/concurrency/message-passing\"},{\"text\":\"共享状态并发\",\"link\":\"/docs/concurrency/shared-state\"},{\"text\":\"使用`Send`和`Sync`特性的可扩展并发\",\"link\":\"/docs/concurrency/extensible-concurrency-sync-and-send\"}]},{\"text\":\"异步编程基础：Async、Await、Futures 和 Streams\",\"link\":\"/docs/async-await/async-await\",\"items\":[{\"text\":\"Future 与异步语法\",\"link\":\"/docs/async-await/futures-and-syntax\"},{\"text\":\"应用异步并发\",\"link\":\"/docs/async-await/concurrency-with-async\"},{\"text\":\"处理任意数量的 Future\",\"link\":\"/docs/async-await/more-futures\"},{\"text\":\"流：按顺序排列的 Future\",\"link\":\"/docs/async-await/streams\"},{\"text\":\"深入了解异步特性\",\"link\":\"/docs/async-await/traits-for-async\"},{\"text\":\"整合：Future、任务和线程\",\"link\":\"/docs/async-await/futures-tasks-threads\"}]},{\"text\":\"面向对象编程特性\",\"link\":\"/docs/oop/oop\",\"items\":[{\"text\":\"什么是面向对象\",\"link\":\"/docs/oop/what-is-oo\"},{\"text\":\"使用特征对象来允许不同类型的值\",\"link\":\"/docs/oop/trait-objects\"},{\"text\":\"实现面向对象的设计模式\",\"link\":\"/docs/oop/oo-design-patterns\"}]},{\"text\":\"模式与匹配\",\"link\":\"/docs/patterns/patterns\",\"items\":[{\"text\":\"模式可以使用的所有位置\",\"link\":\"/docs/patterns/all-the-places-for-patterns\"},{\"text\":\"可驳性：模式是否可能匹配失败\",\"link\":\"/docs/patterns/refutability\"},{\"text\":\"模式语法\",\"link\":\"/docs/patterns/pattern-syntax\"}]},{\"text\":\"高级特性\",\"link\":\"/docs/advanced-features/advanced-features\",\"items\":[{\"text\":\"不安全的rust\",\"link\":\"/docs/advanced-features/unsafe-rust\"},{\"text\":\"高级特征\",\"link\":\"/docs/advanced-features/advanced-traits\"},{\"text\":\"高级类型\",\"link\":\"/docs/advanced-features/advanced-types\"},{\"text\":\"高级函数和闭包\",\"link\":\"/docs/advanced-features/advanced-functions-and-closures\"},{\"text\":\"宏\",\"link\":\"/docs/advanced-features/macros\"}]},{\"text\":\"最终项目：构建多线程Web服务器\",\"link\":\"/docs/final-project/final-project\",\"items\":[{\"text\":\"构建单线程Web服务器\",\"link\":\"/docs/final-project/single-threaded\"},{\"text\":\"将单线程服务器转换为多线程服务器\",\"link\":\"/docs/final-project/multithreaded\"},{\"text\":\"优雅关闭和清理\",\"link\":\"/docs/final-project/graceful-shutdown-and-cleanup\"}]},{\"text\":\"附录\",\"link\":\"/docs/appendix/appendix-a\",\"items\":[{\"text\":\"附录A: 关键字\",\"link\":\"/docs/appendix/appendix-a\"},{\"text\":\"附录B: 运算符和符号\",\"link\":\"/docs/appendix/appendix-b\"},{\"text\":\"附录C: 可衍生的特征\",\"link\":\"/docs/appendix/appendix-c\"},{\"text\":\"附录D: 实用开发工具\",\"link\":\"/docs/appendix/appendix-d\"},{\"text\":\"附录E: 版本\",\"link\":\"/docs/appendix/appendix-e\"},{\"text\":\"附录F: 本书的翻译\",\"link\":\"/docs/appendix/appendix-f\"},{\"text\":\"附录G: Rust 是如何开发的以及 Nightly Rust\",\"link\":\"/docs/appendix/appendix-g\"}]}],\"docFooter\":{\"prev\":\"上一篇\",\"next\":\"下一篇\"},\"search\":{\"provider\":\"local\",\"options\":{\"locales\":{\"zh\":{\"translations\":{\"button\":{\"buttonText\":\"搜索文档\",\"buttonAriaLabel\":\"搜索文档\"},\"modal\":{\"noResultsText\":\"无法找到相关结果\",\"resetButtonTitle\":\"清除查询条件\",\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\"}}}}}}},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/eveningwater/rust-doc\"}],\"footer\":{\"message\":\"MIT Licensed | Copyright © 2020-present eveningwater\"},\"outline\":{\"level\":[2,3],\"label\":\"目录\"},\"lastUpdated\":{\"text\":\"最后更新\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}},\"editLink\":{\"pattern\":\"https://github.com/eveningwater/rust-doc/edit/main/docs/:path\",\"text\":\"在 GitHub 上编辑此页\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>