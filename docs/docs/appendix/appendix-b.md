## 附录 B：运算符和符号

本附录包含 Rust 语法的词汇表，包括运算符和其他符号，这些符号可以单独出现或在路径、泛型、trait 约束、宏、属性、注释、元组和括号的上下文中出现。

### 运算符

表 B-1 包含 Rust 中的运算符，每个运算符在上下文中的使用示例，简短解释，以及该运算符是否可重载。如果运算符可重载，会列出用于重载该运算符的相关 trait。

<span class="caption">表 B-1：运算符</span>

| 运算符                    | 示例                                                   | 解释                                                                 | 是否可重载？   |
| ------------------------- | ------------------------------------------------------- | -------------------------------------------------------------------- | -------------- |
| `!`                       | `ident!(...)`, `ident!{...}`, `ident![...]`             | 宏展开                                                               |                |
| `!`                       | `!expr`                                                 | 按位或逻辑补码                                                       | `Not`          |
| `!=`                      | `expr != expr`                                          | 不等比较                                                             | `PartialEq`    |
| `%`                       | `expr % expr`                                           | 算术取余                                                             | `Rem`          |
| `%=`                      | `var %= expr`                                           | 算术取余并赋值                                                       | `RemAssign`    |
| `&`                       | `&expr`, `&mut expr`                                    | 借用                                                                 |                |
| `&`                       | `&type`, `&mut type`, `&'a type`, `&'a mut type`        | 借用指针类型                                                         |                |
| `&`                       | `expr & expr`                                           | 按位与                                                               | `BitAnd`       |
| `&=`                      | `var &= expr`                                           | 按位与并赋值                                                         | `BitAndAssign` |
| `&&`                      | `expr && expr`                                          | 短路逻辑与                                                           |                |
| `*`                       | `expr * expr`                                           | 算术乘法                                                             | `Mul`          |
| `*=`                      | `var *= expr`                                           | 算术乘法并赋值                                                       | `MulAssign`    |
| `*`                       | `*expr`                                                 | 解引用                                                               | `Deref`        |
| `*`                       | `*const type`, `*mut type`                              | 裸指针                                                               |                |
| `+`                       | `trait + trait`, `'a + trait`                           | 复合类型约束                                                         |                |
| `+`                       | `expr + expr`                                           | 算术加法                                                             | `Add`          |
| `+=`                      | `var += expr`                                           | 算术加法并赋值                                                       | `AddAssign`    |
| `,`                       | `expr, expr`                                            | 参数和元素分隔符                                                     |                |
| `-`                       | `- expr`                                                | 算术取负                                                             | `Neg`          |
| `-`                       | `expr - expr`                                           | 算术减法                                                             | `Sub`          |
| `-=`                      | `var -= expr`                                           | 算术减法并赋值                                                       | `SubAssign`    |
| `->`                      | `fn(...) -> type`, <code>&vert;...&vert; -> type</code> | 函数和闭包返回类型                                                   |                |
| `.`                       | `expr.ident`                                            | 字段访问                                                             |                |
| `.`                       | `expr.ident(expr, ...)`                                 | 方法调用                                                             |                |
| `.`                       | `expr.0`, `expr.1`, 等等                                | 元组索引                                                             |                |
| `..`                      | `..`, `expr..`, `..expr`, `expr..expr`                  | 右开区间字面量                                                       | `PartialOrd`   |
| `..=`                     | `..=expr`, `expr..=expr`                                | 右闭区间字面量                                                       | `PartialOrd`   |
| `..`                      | `..expr`                                                | 结构体字面量更新语法                                                 |                |
| `..`                      | `variant(x, ..)`, `struct_type { x, .. }`               | "以及其余"模式绑定                                                   |                |
| `...`                     | `expr...expr`                                           | (已弃用，请使用 `..=` 代替) 在模式中：闭区间模式                     |                |
| `/`                       | `expr / expr`                                           | 算术除法                                                             | `Div`          |
| `/=`                      | `var /= expr`                                           | 算术除法并赋值                                                       | `DivAssign`    |
| `:`                       | `pat: type`, `ident: type`                              | 约束                                                                 |                |
| `:`                       | `ident: expr`                                           | 结构体字段初始化器                                                   |                |
| `:`                       | `'a: loop {...}`                                        | 循环标签                                                             |                |
| `;`                       | `expr;`                                                 | 语句和项终止符                                                       |                |
| `;`                       | `[...; len]`                                            | 固定大小数组语法的一部分                                             |                |
| `<<`                      | `expr << expr`                                          | 左移                                                                 | `Shl`          |
| `<<=`                     | `var <<= expr`                                          | 左移并赋值                                                           | `ShlAssign`    |
| `<`                       | `expr < expr`                                           | 小于比较                                                             | `PartialOrd`   |
| `<=`                      | `expr <= expr`                                          | 小于等于比较                                                         | `PartialOrd`   |
| `=`                       | `var = expr`, `ident = type`                            | 赋值/等价                                                            |                |
| `==`                      | `expr == expr`                                          | 相等比较                                                             | `PartialEq`    |
| `=>`                      | `pat => expr`                                           | match 分支语法的一部分                                               |                |
| `>`                       | `expr > expr`                                           | 大于比较                                                             | `PartialOrd`   |
| `>=`                      | `expr >= expr`                                          | 大于等于比较                                                         | `PartialOrd`   |
| `>>`                      | `expr >> expr`                                          | 右移                                                                 | `Shr`          |
| `>>=`                     | `var >>= expr`                                          | 右移并赋值                                                           | `ShrAssign`    |
| `@`                       | `ident @ pat`                                           | 模式绑定                                                             |                |
| `^`                       | `expr ^ expr`                                           | 按位异或                                                             | `BitXor`       |
| `^=`                      | `var ^= expr`                                           | 按位异或并赋值                                                       | `BitXorAssign` |
| <code>&vert;</code>       | <code>pat &vert; pat</code>                             | 模式替代                                                             |                |
| <code>&vert;</code>       | <code>expr &vert; expr</code>                           | 按位或                                                               | `BitOr`        |
| <code>&vert;=</code>      | <code>var &vert;= expr</code>                           | 按位或并赋值                                                         | `BitOrAssign`  |
| <code>&vert;&vert;</code> | <code>expr &vert;&vert; expr</code>                     | 短路逻辑或                                                           |                |
| `?`                       | `expr?`                                                 | 错误传播                                                             |                |

### 非运算符符号

以下列表包含所有不作为运算符功能的符号；也就是说，它们不像函数或方法调用那样行为。

表 B-2 显示了单独出现并在各种位置有效的符号。

<span class="caption">表 B-2：独立语法</span>

| 符号                                                                 | 解释                                                                 |
| -------------------------------------------------------------------- | -------------------------------------------------------------------- |
| `'ident`                                                             | 命名生命周期或循环标签                                               |
| 紧跟在 `u8`、`i32`、`f64`、`usize` 等后面的数字                     | 特定类型的数字字面量                                                 |
| `"..."`                                                              | 字符串字面量                                                         |
| `r"..."`, `r#"..."#`, `r##"..."##`, 等等                            | 原始字符串字面量，不处理转义字符                                     |
| `b"..."`                                                             | 字节字符串字面量；构造字节数组而不是字符串                           |
| `br"..."`, `br#"..."#`, `br##"..."##`, 等等                         | 原始字节字符串字面量，原始和字节字符串字面量的组合                   |
| `'...'`                                                              | 字符字面量                                                           |
| `b'...'`                                                             | ASCII 字节字面量                                                     |
| <code>&vert;...&vert; expr</code>                                    | 闭包                                                                 |
| `!`                                                                  | 总是空的底部类型，用于发散函数                                       |
| `_`                                                                  | "忽略"模式绑定；也用于使整数字面量可读                               |

表 B-3 显示了在通过模块层次结构到项的路径上下文中出现的符号。

<span class="caption">表 B-3：路径相关语法</span>

| 符号                                  | 解释                                                                                                                     |
| ------------------------------------- | ------------------------------------------------------------------------------------------------------------------------ |
| `ident::ident`                        | 命名空间路径                                                                                                             |
| `::path`                              | 相对于外部预导入的路径，所有其他 crate 都在此根植（即，包含 crate 名称的显式绝对路径）                                     |
| `self::path`                          | 相对于当前模块的路径（即，显式相对路径）                                                                                 |
| `super::path`                         | 相对于当前模块父级的路径                                                                                                 |
| `type::ident`, `<type as trait>::ident` | 关联常量、函数和类型                                                                                                     |
| `<type>::...`                         | 无法直接命名的类型的关联项（例如，`<&T>::...`、`<[T]>::...` 等）                                                         |
| `trait::method(...)`                  | 通过命名定义它的 trait 来消除方法调用的歧义                                                                             |
| `type::method(...)`                   | 通过命名为其定义方法的类型来消除方法调用的歧义                                                                           |
| `<type as trait>::method(...)`        | 通过命名 trait 和类型来消除方法调用的歧义                                                                               |

表 B-4 显示了在使用泛型类型参数的上下文中出现的符号。

<span class="caption">表 B-4：泛型</span>

| 符号                         | 解释                                                                                                                              |
| ---------------------------- | -------------------------------------------------------------------------------------------------------------------------------- |
| `path<...>`                  | 在类型中指定泛型类型的参数（例如，`Vec<u8>`）                                                                                     |
| `path::<...>`, `method::<...>` | 在表达式中指定泛型类型、函数或方法的参数；通常称为涡轮鱼（例如，`"42".parse::<i32>()`）                                           |
| `fn ident<...> ...`          | 定义泛型函数                                                                                                                      |
| `struct ident<...> ...`      | 定义泛型结构体                                                                                                                    |
| `enum ident<...> ...`        | 定义泛型枚举                                                                                                                      |
| `impl<...> ...`              | 定义泛型实现                                                                                                                      |
| `for<...> type`              | 高阶生命周期约束                                                                                                                  |
| `type<ident=type>`           | 一个或多个关联类型具有特定赋值的泛型类型（例如，`Iterator<Item=T>`）                                                               |

表 B-5 显示了在约束泛型类型参数与 trait 约束的上下文中出现的符号。

<span class="caption">表 B-5：Trait 约束约束</span>

| 符号                        | 解释                                                                                                                                |
| --------------------------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| `T: U`                      | 泛型参数 `T` 约束为实现 `U` 的类型                                                                                                  |
| `T: 'a`                     | 泛型类型 `T` 必须比生命周期 `'a` 活得更久（意味着该类型不能传递性地包含任何生命周期短于 `'a` 的引用）                               |
| `T: 'static`                | 泛型类型 `T` 不包含除 `'static` 之外的借用引用                                                                                     |
| `'b: 'a`                    | 泛型生命周期 `'b` 必须比生命周期 `'a` 活得更久                                                                                     |
| `T: ?Sized`                 | 允许泛型类型参数是动态大小类型                                                                                                      |
| `'a + trait`, `trait + trait` | 复合类型约束                                                                                                                       |

表 B-6 显示了在调用或定义宏以及在项上指定属性的上下文中出现的符号。

<span class="caption">表 B-6：宏和属性</span>

| 符号                                      | 解释         |
| ----------------------------------------- | ------------ |
| `#[meta]`                                 | 外部属性     |
| `#![meta]`                                | 内部属性     |
| `$ident`                                  | 宏替换       |
| `$ident:kind`                             | 宏元变量     |
| `$(...)...`                               | 宏重复       |
| `ident!(...)`, `ident!{...}`, `ident![...]` | 宏调用       |

表 B-7 显示了创建注释的符号。

<span class="caption">表 B-7：注释</span>

| 符号     | 解释                 |
| -------- | -------------------- |
| `//`     | 行注释               |
| `//!`    | 内部行文档注释       |
| `///`    | 外部行文档注释       |
| `/*...*/` | 块注释               |
| `/*!...*/` | 内部块文档注释       |
| `/**...*/` | 外部块文档注释       |

表 B-8 显示了使用括号的上下文。

<span class="caption">表 B-8：括号</span>

| 符号                   | 解释                                                                                 |
| ---------------------- | ----------------------------------------------------------------------------------- |
| `()`                   | 空元组（又名单元），既是字面量又是类型                                               |
| `(expr)`               | 括号表达式                                                                          |
| `(expr,)`              | 单元素元组表达式                                                                     |
| `(type,)`              | 单元素元组类型                                                                       |
| `(expr, ...)`          | 元组表达式                                                                          |
| `(type, ...)`          | 元组类型                                                                             |
| `expr(expr, ...)`      | 函数调用表达式；也用于初始化元组 `struct` 和元组 `enum` 变体                         |

表 B-9 显示了使用花括号的上下文。

<span class="caption">表 B-9：花括号</span>

| 上下文      | 解释           |
| ----------- | -------------- |
| `{...}`     | 块表达式       |
| `Type {...}` | 结构体字面量   |

表 B-10 显示了使用方括号的上下文。

<span class="caption">表 B-10：方括号</span>

| 上下文                                            | 解释                                                                                                                   |
| ------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- |
| `[...]`                                           | 数组字面量                                                                                                             |
| `[expr; len]`                                     | 包含 `len` 个 `expr` 副本的数组字面量                                                                                 |
| `[type; len]`                                     | 包含 `len` 个 `type` 实例的数组类型                                                                                   |
| `expr[expr]`                                      | 集合索引。可重载（`Index`、`IndexMut`）                                                                               |
| `expr[..]`, `expr[a..]`, `expr[..b]`, `expr[a..b]` | 假装是集合切片的集合索引，使用 `Range`、`RangeFrom`、`RangeTo` 或 `RangeFull` 作为"索引"                               |